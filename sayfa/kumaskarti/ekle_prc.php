<style>
.elyafarttir{
    border: 1px solid #8c8989;
    background: white;
    padding: 4px;
    display: block;
    color: black;
    font-weight: bold;
    margin-bottom: 5px;
    width: 98%;
    text-align: center;
    position: relative;
    left: 1%;
    border-radius: 20px;
}
.elyafsil{
    border: 1px solid #8c8989;
    background: white;
    padding: 4px;
    display: inline-block;
    color: black;
    font-weight: bold;
    border-radius: 26%; 
    cursor:pointer;
}
.elyaflartr div{
    margin-bottom:5px;
}
.elyafdiv{
    display:table;
}

.kumasterbiyeblok{
    background:white;
}

.kumasterbiyealtblok{
    border: solid 4px #95989e;
    padding: 6px;
}

.kumasarabosluk{
    border: 10px solid white !important;
    height: 20px;
    background: white !important;
    color: white !important;
}

.mamulboyamaliyeti{
    border-top: 4px solid #95989e;
}

.pusvefayntbody{
    border: 2px solid #95989e;
}

.kurmdegisim{
    text-align: left !important;
    padding-left: 0;
}

.kurmdegisim2{
    text-align: left !important;
    padding-left: 0;
    width: 400px !important;
}

.mnkureurusd{
    border: 1px solid #ddd;
    padding-bottom: 10px;
    padding-top: 10px;
    padding-right: 78px;
    padding-left: 6px;
}
.mnkurusd{
    border: 1px solid #ddd;
    padding-bottom: 10px;
    padding-top: 10px;
    padding-right: 72px;
    padding-left: 6px;
}
.mnkureur{
    border: 1px solid #ddd;
    padding-bottom: 10px;
    padding-top: 10px;
    padding-right: 75%;
    padding-left: 6px;
}

.boyamaliyetiinput1 input{
    width:98%;
}

.tableboyatable{
    border-top: none;
    margin-top: -16px;
}

.boyamaliyethesapla{
    padding:0;
    margin-left: 6px;
}

.icerik{
    background:#e0e0e0;
}

.ilktablo{
    background:#e0e0e0;
}

form{
    background:#e0e0e0;
}

.table{
    background:#e0e0e0;
}

.resimtablo{
    border: 2px solid #95989e !important;
}

.hamtablo{
    border: 2px solid #95989e;
}

.tabloyetki{
    border: 2px solid #95989e;
}

.tabloboyaterbiye{
    border: solid 4px #95989e;
    background:#ffffff !important;
}

.tabloterbiyebaskiarasi{
    height:16px;
    width:100%;
    border-left: solid 4px #95989e;
    border-right: solid 4px #95989e;
}

.tabloboyabaski{
    border: solid 4px #95989e;
    background:#ffffff !important;
}

.tabloboyabaski table{
    background:white !important;
}

.btn-success{
    padding:4px !important;
}

.btn-danger{
    padding:4px !important;
}

.boyamaliyetiinput1 input{
    width:18%;
    float:left;
}

.silinecekhamterbiye{

}

.silinecekboyaterbiye{

}

.silineceksonterbiye{
    
}


.tabloilavegider{
    border: 2px solid #95989e;
}

.boyabaskitr{
    /*border-style: dotted;*/
}

.ekhizmetler{
    /*border-bottom: 4px solid #95989e;*/
}

.tablekar{
    /*border: 2px solid #95989e;*/
}

.tablekar2{
    border: 2px solid #95989e;
}

.tablokayit{
    border: 2px solid #95989e;
}

.fasorgumaliyet{
    width: 12%;
}

.fasonorgumaliyetii2 input{
    width: 45%;
}

.fasonorgumaliyetii2 select{
    width: 45%;
}

.fasondoviz{
    font-size:20px;
}

.select2-container--bootstrap .select2-selection{
  border-radius: 0px;
}

.pusvefayntr td{
    padding: 5px 10px !important;
}

.select2-selection{
    border-top-left-radius: 0px !important;
    border-top-right-radius: 0px !important;
    border-bottom-left-radius: 0px !important;
    border-bottom-right-radius: 0px !important;
}
.select2-container--default .select2-selection--single{
    border-radius: 0px !important;
}

.kompozisyontd span{
    border: 1px solid #333435;
    padding: 5px;
}

.cardborder{
    border:none;
    background: #e0e0e0;
}

.hamcogalt{
    background: #2a3140;
    color: white;
    padding: 4px;
    border-radius: 6px;
    -webkit-box-shadow: 8px 8px 29px 0px rgba(158,155,158,1);
    -moz-box-shadow: 8px 8px 29px 0px rgba(158,155,158,1);
    box-shadow: 8px 8px 29px 0px rgba(158,155,158,1);
    margin-left: 6px;
}

.fotoyutopla{
}

.iplikkartlari{
    background:#eeeeee;
}
.iplikkartsil{
    border: 1px solid #ddd;
    background: white;
    border-radius: 10px;
    cursor: pointer;
    text-align:center;
}
.ustboyamaliyetiartir{
    /*border: 1px solid #ddd;
    padding: 5px;
    margin-left: 5px;
    background: white;
    padding-bottom: 14px;
    display: -webkit-inline-box;*/
}

.bilgikutucugu{
    border:1px solid #ddd;
    padding: 10px;
}

.hamkutu{
    border:1px solid #ddd;
    padding: 10px;
    float:left;
    width: 30%;
    margin: 5px 5px;
    border-radius: 20px;
    text-align: center;
}

.iplikkarti1 .iplikkartsil{
    display:none;
}
.selectsecim{
    width:-webkit-fill-available;
}
.pusvefayn{
    /*display:none !important;*/
}
<?php if(z(8,'a')=='duzenle'||z(8,'a')=='farkli'){  ?>
.pusvefayn{
    display:table-row;
}
<?php } ?>

.boyamaliyetiartir{
    color:black;
    text-decoration: none;
}
.boyabaskimaliyet{
    float:left;
}
.boyabaskimaliyet .ustmaliyetsilme{
    display:block;
    border: 1px solid #ddd;
    background: white;
    border-radius: 10px;
    cursor: pointer;
    text-align: center;
}
.boyabaskimaliyet:nth-child(1) .ustmaliyetsilme{
    display:none;
}
.fasonorgumaliyetii2 span{
    width:auto !important;
}
.fasonorgumaliyetii2 span b{
    margin-left: -14px !important;
}

.boyamaliyetlerimiz a{
    color: black;
    display: none;
    border: 1px solid #ddd;
    background: white;
    border-radius: 10px;
    cursor: pointer;
}

.boyamaliyetiinputt1 a{
    display:none;
}

.ekhizmetartir{
    //display:none;
}

.ekhizmetartir:nth-child(1){
    display:inline;
}

.ekhizmetartir b{
    color:white !important;
}

.altboyamaliyetiartir b{
    color:white !important;
}

.ekhizmetsil{
    display: none;
    border: 1px solid #ddd;
    background: white;
    border-radius: 10px;
    cursor: pointer;
    color: black;
    font-size:14px;
}

.ekhizmetkumas span{
    display:none;
}

.ekhizmetkumas:nth-child(1) span{
    display:block;
}

.ekhizmetkumas .ekth{
    display:none;
}

.ekhizmetkumas:nth-child(1) .ekth{
    display:table-cell;
}

.ekhizmetkumas:nth-child(1) .ekhizmetsil{
    display:none;
}

.karoransil{
    color: black;
    display: none;
    border: 1px solid #ddd;
    background: white;
    border-radius: 10px;
    cursor: pointer;
    float: left;
    width: 8%;
    height: 36px;
    position: relative;
    text-align: center;
    left: 1%;
    padding-top: 10px;
}

.karoranlari{
    width:90%;
    float:left;
}

.boyamaliyetkarlari1 a{
    display:none;
}

.labelimiz{
    background: white;
    border: 1px solid #cac;
    padding: 4px 4px;
}

.karinputlari input{
    width: 18%;
    margin-left:1%;
    float: left;
}

.resimsil{
    color: black;
    display: block;
    border: 1px solid #ddd;
    background: white;
    border-radius: 10px;
    cursor: pointer;
}

.yuklemebaslat{
    color: black;
    display: none;
    border: 1px solid #96f196;
    background: white;
    border-radius: 10px;
    cursor: pointer;
    padding:2px;
}

.yenikaydet{
    border: 1px solid #ddd;
    border-radius: 30px;
    background-color: #fff;
    outline: none;
    color: black;
    text-decoration: none;
    font-size: 16px;
    padding: 0.4em 1em;
    display: inline-block;
}

.selectmaliyet select{
    border: 1px solid #ddd;
    padding: 10px;
    width: 80%;
    float:left;
}

.yetkikontrol2{
    border: 1px solid #ddd;
    float: left;
    background: white;
    padding: 10px;
}

.yetkikontrolfire{
    border: 1px solid #ddd;
    float: left;
    background: white;
    padding: 10px;
}

.sonterbiyesil{
    color: black;
    display: none;
    border: 1px solid #ddd;
    background: white;
    border-radius: 10px;
    cursor: pointer;
    float: left;
    width: 100%;
    text-align: center;
}

.selectboyabaskisi select{
    border: 1px solid #ddd;
    padding: 10px;
    width: 100%;
}

.spanisim{
    color: black;
    display: block;
    border: 1px solid #ddd;
    border-radius: 10px;
    padding:4px;
}
.boyamaliyethesapla{
    width: auto;
    float: left;
}
<?php
$ytkFyt=ytk($tbl,'ozel2');
if(empty($ytkFyt)&&empty($admn)){?>
.yetkikontrol{
    display:none !important;
}
.boyamaliyethesapla{
    display:none !important;
}
.thiplikbirimfiyat,
.thiplikfiyat,
.thiplikfire,
.thfirelifiyat{
    display:none !important;
}

.iplikbirimfiyat,
.iplikfiyat,
.iplikfire,
.iplikfirelifiyat{
    display:none !important;
}

.iplikkartitoplamc{
    display:none !important;
}
<?php } ?>

.fiyatguncelle{
    position: absolute;
    right: 0;
    background: red;
    width: 160px;
    height: 40px;
    color: white;
    text-align: center;
    z-index: 1;
    padding-top: 10px;
    font-weight: bold;
    display:none;
    cursor:pointer;
}

.kurmdegisim{
    width: 120px !important;
    text-align: center;
}

.toplamfiyatcek,
.iplikfiyat,
.thiplikfiyat{
    display:none !important;
}

.bilgikumas tr{

}

.bilgikumas th{
    width:120px;
}

.bilgikumas td{

}

.kumaseni input{
    float: left;
    padding: 0;
    margin: 0;
    height: 20px;
    width: 40px;
    margin-top: 10px;
}

.kumaseni span{
    float: left;
    padding: 10px 5px;
}

.pusvefayntr tr{
    padding: 2px;
}

.kumasacikeni input{
    width:60px;
}

.hizayagetir{
    display: block;
    width: 100%;
    overflow: hidden;
}

.ilktablo th{
    text-align:left;
}

.fotoyutopla{
    overflow: scroll;
    width: 100%;
    height: 160px;
}

.fotoyutopla div{
    border: 1px solid #fff;
}

.endenyansit{
    cursor: pointer;
    border: 1px solid #ddd;
    float: right;
    margin-right: 20px;
    background: #226643;
    color: white;
    padding: 3px;
    display:none;
}








@media screen and (max-width: 1024px) {
    .pusvefayntr td {
        padding: 5px 2px !important;
    }
    .kumaseni input {
        margin-top: 7px;
    }
}

@media screen and (max-width: 912px) {
    .tablopusvefayn{
        width: 100%;
        margin-right: 0;
        margin-bottom: 20px;
    }
    .resimtablo{
        width:100%;
    }
}


</style>
<div class="fiyatguncelle" onclick="fiyatguncelle(this);">
    <div>Güncel Fiyatları Çek</div>
</div>
<?php 
$sayi2=0;
$idmiz=z(8,'id');
$farkli=z(8,'farkli');
if(!empty($farkli)){
    $_X=z(1,$farkli,'',$tbl);
}
if(!empty($_X)){
    $iplikkartlaricek=$_X['iplikkartlari'];
    $iplikkartlariarray=(!empty($_X['iplikkartlari'])?json_decode($_X['iplikkartlari'],1):'');
    if(!empty($iplikkartlariarray)){
        $iplikkartlariarray=str_replace('puan','',$iplikkartlariarray);
    }
    if(!empty($iplikkartlariarray)){ foreach($iplikkartlariarray as $i => $iplkkrtlari){ $sayi2++;} }
}
?>
<script type="text/javascript">
setInterval(function() {
        $.ajax({
            type:"POST",
            url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu5",
            success:function(gelensorgu){
                console.log("İçerdeyiz");
                var boyabaskiall=gelensorgu.cevap.boyabaskiall;
                var nesnedoviz=gelensorgu.cevap.nesnedoviz;
                if(boyabaskiall!=null&&boyabaskiall!=''){
                    $(".fiyatguncelle").show();
                }
            }
        });
}, 5000); // Wait 5000ms before running again
function fiyatguncelle(ths) {
    $.ajax({
            type:"POST",
            url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu5&kapat=1",
            success:function(gelensorgu){
                var boyabaskiall=gelensorgu.cevap.boyabaskiall;
                var nesnedoviz=gelensorgu.cevap.nesnedoviz;
                if(boyabaskiall!=null&&boyabaskiall!=''){
                    window.boyabaskiall=boyabaskiall;
                    console.log("Boya baskı güncellendi");
                    $(".fiyatguncelle").hide();
                    iplikdegisimkur();
                }
                if(nesnedoviz!=null&&nesnedoviz!=''){
                    window.nesnedoviz=nesnedoviz;
                    console.log("Nesne Döviz güncellendi");
                }
            }
        });

}
    $(document).ready(function(){

        <?php if(z(8,'a')=='ekle'&&empty($farkli)){ ?>
            $(".ekhizmetkumas select").val(10).attr("selected","selected");
            $(".boyamaliyetlerimiz select").val(10).attr("selected","selected");
            $(".mkurdovizcinsi select").select2().val(74).change();
            setTimeout(function(){ siraylacalistir3(); }, 2000);
            
        <?php } ?>

        $.ajax({
            type:"POST",
            url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu2",
            success:function(gelensorgu){
                var boyabaskiall=gelensorgu.cevap.boyabaskiall;
                var nesnedoviz=gelensorgu.cevap.nesnedoviz;
                window.boyabaskiall=boyabaskiall;
                window.nesnedoviz=nesnedoviz;
            }
        });

        window.kompozisyonarray={};

        $( ".fasonorgumaliyeti2" ).keyup(function() {
            siraylacalistir3();
        });
        $( ".fasondoviz2" ).change(function() {
            siraylacalistir3();
        });

        $( ".mkurusd input" ).keyup(function() {
            siraylacalistir3();
        });
        $( ".mkureur input" ).keyup(function() {
            siraylacalistir3();
        });

        $( ".iplikoranlari" ).keyup(function() {
            siraylacalistir3();
        });
        $( ".iplikfiresi input" ).keyup(function() {
            siraylacalistir3();
        });
        $( ".kurmdegisim" ).keyup(function() {
            manuelkuroran();
        });

        function manuelkuroran(ths){
            var usdyicek = $(".mkurusd input").val();
            var euryicek = $(".mkureur input").val();
            usdyicek=usdyicek.replace(",",".");
            euryicek=euryicek.replace(",",".");
            var eurusdoran=0;
            eurusdoran=(euryicek)/usdyicek;
            eurusdoran=sy(eurusdoran,4);
            $(".mkuroran").html(eurusdoran);
        }

        $(document).ready(function(){
            $(".select2-selection").css("border-top-left-radius","0");
            $(".select2-selection").css("border-top-right-radius","0");
            $(".select2-selection").css("border-bottom-left-radius","0");
            $(".select2-selection").css("border-bottom-right-radius","0");
            setTimeout(function(){ manuelkuroran();  }, 2000);
        });
        
        function delay(callback, ms) {
        var timer = 0;
        return function() {
            var context = this, args = arguments;
            clearTimeout(timer);
            timer = setTimeout(function () {
            callback.apply(context, args);
            }, ms || 0);
        };
        }

        $('.iplikoran input').keyup(delay(function (e) {
        iplikdegisimkur2();
        }, 1600));
         
         

        $('#makinacesidi').change(function() {
            var makinacesidi_ID = makinacesidi.options[makinacesidi.selectedIndex].value;
            $.ajax({
                type:"POST",
                url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&kumas="+makinacesidi_ID,
                success:function(gelensorgu){
                    if(gelensorgu.sonuc==1){
                        var kumas=gelensorgu.cevap.kumas;
                        var pusvefaynmetni=gelensorgu.cevap.pusvefaynmetni;
                        var pusvefaynjson=gelensorgu.cevap.pusvefaynjson;
                        var kumasfasonorgu=gelensorgu.cevap.kumasfasonorgu;
                        var fasondoviz=gelensorgu.cevap.fasondoviz;
                        if(kumas!=null){
                            $('#kumasturu option').remove();
                            $('<option>').val(0).text("Seçiniz").appendTo('#kumasturu');
                            $.each(kumas, function(k, v) {
                                $('<option>').val(v.ID).text(v.sanalveri).appendTo('#kumasturu');
                            }); 
                        } else {
                            $('#kumasturu option').remove();
                        }
                        $('.pusvefaynselect option').remove();
                        $('.pusvefayntr').remove();
                        /*
                        if(pusvefaynjson!=null){
                            $('.pusvefaynselect option').remove();
                            $('.pusvefayntr td').html('');
                            $.each(pusvefaynjson, function(k, v) {
                                //$('<input>').val(k).text(v).appendTo('.pusvefayntr td');
                                var clonemuz='<tr class="pusvefayn pusvefayntr">';
                                clonemuz+='<td><label for="fname'+k+'" class="labelimiz">'+v+':</label><input type="checkbox" id="fname'+k+'" name="kumaskarti[pusvefayn]['+k+'][]"></td><td><span style="float: left;margin: 10px;"> EN: </span><input type="text" value="0" class="form-control" style="float: left;width:auto;" name="kumaskarti[pusvefayn]['+k+'][]" autocomplete="off"><span style="float: left;margin: 10px;">cm</span><br></td>';
                                clonemuz+='</tr>';
                                $(".pusvefayntbody").append(clonemuz);
                            });
                        }
                        */
                        if(pusvefaynmetni!=null){
                        $('.pusvefayn').css("display","table-row");
                        //$('.pusvefayn td').html(pusvefaynmetni);
                        //$('.fasorgumaliyet').val(kumasfasonorgu);
                        //$('.fasondoviz').html(fasondoviz);
                        siraylacalistir3();
                        hesapla();
        
                        }
                    } else {
                        alert('Makina Çeşitlerini okuma başarısız');
                    }
                }
            });
        });
        $('#kumasturu').change(function() {
            var kumasturu_ID = kumasturu.options[kumasturu.selectedIndex].value;
            $.ajax({
                type:"POST",
                url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&kumasturu="+kumasturu_ID,
                success:function(gelensorgu){
                    if(gelensorgu.sonuc==1){
                        var pusvefaynmetni2=gelensorgu.cevap.pusvefaynmetni2;
                        var pusvefaynjson=gelensorgu.cevap.pusvefaynjson;
                        var kumasfasonorgu2=gelensorgu.cevap.kumasfasonorgu2;
                        var fasondoviz2=gelensorgu.cevap.fasondoviz2;
                        if(pusvefaynmetni2!=null){
                            $('.pusvefayn').css("display","table-row");
                            //$('.pusvefayn td').html(pusvefaynmetni2);
                            $('.fasorgumaliyet').val(kumasfasonorgu2);
                            $('.fasondoviz').html(fasondoviz2);
                            siraylacalistir3();
                            hesapla();
                        }
                        var pusvefayntr='';
                        var clonemuz='';

                     

                        if(pusvefaynjson!=null){
                            $('.pusvefaynselect option').remove();
                            $('.pusvefayntr').remove();
                            $.each(pusvefaynjson, function(k, v) {
                                //$('<option>').val(k).text(v).appendTo('.pusvefaynselect');
                                //var pusfaynbilgi=v;
                                //pusfaynbilgi=pusfaynbilgi.split("Pus:").join(""); 
                                //pusfaynbilgi=pusfaynbilgi.split("Fayn:").join("/"); 
                                clonemuz='<tr class="pusvefayn pusvefayntr">';
                                clonemuz+='<td><label for="fname'+k+'" class="labelimiz">'+v+':</label><input type="checkbox" id="fname'+k+'" name="kumaskarti[pusvefayn]['+k+'][]"></td>';
                                clonemuz+='<td><span style="float: left;margin: 10px;"> EN: </span><input type="text" value="0" name="kumaskarti[pusvefayn]['+k+'][]" class="form-control" style="float: left;width:auto;" autocomplete="off"><span style="float: left;margin: 10px;">cm</span><br></td>';
                                clonemuz+='</tr>';
                                $(".pusvefayntbody").append(clonemuz);
                            });
                        }
                    } else {
                        alert('Kumaş Türünü okuma başarısız');
                    }
                }
            });
        });
    });
</script>
<script>



function hesapla(ths) {
var toplamfiyat = 0;
var toplamfirefiyat = 0;
var toplamfirelifiyat = 0;
var degeroran=0;
$('.iplikoran').each(function(ip, objoran){
    var iplikoran=$(objoran).find("input").val();
    var iplikoran = sy(iplikoran);
    degeroran=parseFloat(degeroran+iplikoran);
}); 
/*/
if(degeroran!=0){
    if(degeroran>100){
        alert("Toplam iplik oranı değeri 100'den fazla olamaz");
    }
    if(degeroran<100){
        alert("Toplam iplik oranı değeri 100'den az olamaz");
    }
}
/*/

$('.iplikkartihepsi tr').each(function(i, objemiz){
    var eachiplikoran=$(objemiz).find(".iplikoranlari").val()/100;
    var eachbirimfiyat=$(objemiz).find(".iplikbirimfiyat").html().replace(',', '.');
    var eachiplikfiresi=$(objemiz).find(".iplikfiresi input").val().replace(',', '.');
    var eachiplikfiresi2=$(objemiz).find(".iplikfiresi div").html().replace(',', '.');
    var eachbirimdoviz=$(objemiz).find(".iplikbirimdoviz div").html();
    var usdyicek = $(".mkurusd input").val();
    var euryicek = $(".mkureur input").val();
    usdyicek=usdyicek.replace(",",".");
    euryicek=euryicek.replace(",",".");
    var buna='1';
    if(eachbirimdoviz=='75'){
        buna=usdyicek;
    }
    if(eachbirimdoviz=='76'){
        buna=euryicek;
    }
    //var eachiplikfiresi=eachiplikfiresi.split(',').join('.');
    //var eachiplikfiresi2=eachiplikfiresi2.split(',').join('.');
    if(eachiplikfiresi==''){
        var eachiplikfiresi=eachiplikfiresi2;
    }
    var numiplikoran = sy(eachiplikoran);
    var numbirimfiyat = sy(eachbirimfiyat);
    var numiplikfiresi = sy(eachiplikfiresi);
    var numfiyathesapla = sy(numbirimfiyat*numiplikoran,2);
    $(objemiz).find(".iplikfiyat").html(numfiyathesapla);
    var fiyaticek = $(objemiz).find(".iplikfiyat").html();
    var fiyaticek2 = sy(fiyaticek);
    var firefiyati = sy(numiplikfiresi*fiyaticek2)/100;
    var firefiyati2 = sy(firefiyati,2);
    $(objemiz).find(".iplikfire").html(firefiyati2);
    var fireyicek = $(objemiz).find(".iplikfire").html();
    var fireyicek2 = sy(fireyicek);
    var firelifiyat= sy(fiyaticek2+fireyicek2);
    var firelifiyat2 = sy(firelifiyat,2);
    $(objemiz).find(".iplikfirelifiyat").html(firelifiyat2);
    firelifiyat2=firelifiyat2*buna;
    var firelifiyatcek = $(objemiz).find(".iplikfirelifiyat").html();
    var firelifiyatcek2 = sy(firelifiyatcek);

    toplamfiyat += parseFloat(fiyaticek2);
    toplamfirefiyat += parseFloat(fireyicek2);
    toplamfirelifiyat += parseFloat(firelifiyatcek2);
}); 
    toplamfiyat = sy(toplamfiyat,2);
    toplamfirefiyat = sy(toplamfirefiyat,2);
    toplamfirelifiyat = sy(toplamfirelifiyat,2);

    $('.toplamfiyatcek').html(toplamfiyat);
    $('.toplamfirefiyaticek').html(toplamfirefiyat);
    $('.toplamfirelifiyaticek').html(toplamfirelifiyat);
    yenidovizdegistir();
}
$( document ).ready(function() {
    var deger=1<?php echo ' + '.$sayi2; ?>;
    $(".iplikkartiarttir").click(function(){
        var iplikeski="iplikkarti"+deger;
        var selecteski="select"+deger;
        deger++;
        var iplikyeni="iplikkarti"+deger;
        var selectyeni="select"+deger;
        var cloneObj2 = $('.iplikkartihepsi tr:nth-child(3)').clone();
        var cloneObj2 =cloneObj2.removeClass(iplikeski);
        var cloneObj2 =cloneObj2.removeClass("iplikkarti1");
        var cloneObj2 =cloneObj2.addClass(iplikyeni);
        var cloneObj2 =cloneObj2.attr("id",iplikeski);
        $(".iplikkartihepsi").append(cloneObj2);
        $('.'+iplikyeni).find("select").attr("id",selectyeni);
        $('.'+iplikyeni).find(".select2-container").remove();
        $('.'+iplikyeni).find("select").removeAttr('data-select2-id');
        $('#select'+deger).select2();
        for (i = 0; i < deger; i++) {
            $('#select'+i).select2();
        }
        $('#select'+deger).select2();
        hesapla();
        siraylacalistir3();
    });
    $(".boyamaliyetiar2tir").click(function(){
        var inputeski="boyamaliyetiinput"+deger2;
        var selecteski="boyamaliyetiselect"+deger2;
        deger2++;
        var inputyeni="boyamaliyetiinput"+deger2;
        var selectyeni="boyamaliyetiselect"+deger2;

        var cloneObje1 = $('.boyamaliyetiinput1').clone();
        var cloneObje1 =cloneObje1.removeClass(inputeski);
        var cloneObje1 =cloneObje1.removeClass("boyamaliyetiinput1");
        var cloneObje1 =cloneObje1.addClass(inputyeni);
        $(".boyamaliyetiinputt1").append(cloneObje1);

        var cloneObje2 = $('.boyamaliyetiselect1').clone();
        var cloneObje2 =cloneObje2.removeClass(selecteski);
        var cloneObje2 =cloneObje2.removeClass("boyamaliyetiselect1");
        var cloneObje2 =cloneObje2.addClass(selectyeni);
        $(".boyamaliyetiselectt1").append(cloneObje2);

    });
    var deger3=1;
    $(".ustboyamaliyetiartir").click(function(){
        var inputeski="boyabaskimaliyet"+deger3;
        deger3++;
        var inputyeni="boyabaskimaliyet"+deger3;

        var clone1 = $('.boyabaskimaliyet1').clone();
        var clone1 = clone1.removeClass(inputeski);
        var clone1 = clone1.removeClass("boyabaskimaliyet1");
        var clone1 =clone1.addClass(inputyeni);
        $(".selectboyatd").append(clone1);
        $('.'+inputyeni).find("select").prop("disabled", false);
    });

    var deger4=1;
    var boyamaliyetlerimizlength=$('.tablealt .boyamaliyetlerimiz').length;
    if(boyamaliyetlerimizlength>1){
        deger4=boyamaliyetlerimizlength;
    }
    $(".altboyamaliyetiartir").click(function(){
        var classeski="boyamaliyetiinputt"+deger4;
        var classeski1="boyamaliyetiinput"+deger4;
        var degereski=deger4;
        var naber='eq';
        deger4++;
        var classyeni="boyamaliyetiinputt"+deger4;
        var classyeni1="boyamaliyetiinput"+deger4;
        var degeryeni=deger4;

        var clone2 = $('.boyamaliyetihepsi .boyamaliyetlerimiz:first').clone();
        var clone2 = clone2.removeClass(classeski);
        var clone2 = clone2.removeClass("boyamaliyetiinputt1");
        var clone2 =clone2.addClass(classyeni);
        //var klonmetin='<tr class="boyamaliyetlerimiz '+classyeni+'"><th colspan="2">'+clone2+'<a href="#altmaliyetsil" onclick="altmaliyetsilme(this)">Sil</a></th><td class="'+classyeni1+'"></td></tr>';
        $(".boyamaliyetihepsi").append(clone2);
        $('.'+classeski).find("select").attr("class",degereski);
        //$('.'+classeski).find("select").attr("class","form-control");
        $('.'+classyeni).find("select").attr("class",degeryeni);
        //$('.'+classyeni).find("select").attr("class","form-control");
        $('.'+classyeni).find("select option:eq(0)").attr("selected",true);
        $('.'+classyeni).find("div").html('&nbsp;');
        $('.'+classyeni).find("input").val('0');
    });

    var deger5=1;
    $(".ekhizmetartir").click(function(){
        var classeski="ekhizmetkumaslari"+deger5;
        var degereski=deger5;
        deger5++;
        var classyeni="ekhizmetkumaslari"+deger5;
        var degeryeni=deger5;

        var clone3 = $('.ekhizmetkumas:last').clone();
        var clone3 = clone3.removeClass(classeski);
        var clone3 = clone3.removeClass("ekhizmetkumaslari1");
        var clone3 =clone3.addClass(classyeni);
        $(".ekhizmetler").append(clone3);
        $('.'+classeski).find("select").attr("class",degereski);
        $('.'+classyeni).find("select").attr("class",degeryeni);
        $('.'+classyeni).find(".ekhizmetartir").hide();
        boyamaliyetihizmetyansityenieach2();
    });

    var deger6=1;
    $(".karoranartir").click(function(){
        var classeski="boyamaliyetkarlari"+deger6;
        var degereski=deger6;
        deger6++;
        var classyeni="boyamaliyetkarlari"+deger6;
        var degeryeni=deger6;

        var clone4 = $('.boyamaliyetkarlari tr:nth-child(2)').clone();
        var clone4 = clone4.removeClass(classeski);
        var clone4 = clone4.removeClass("boyamaliyetkarlari1");
        var clone4 =clone4.addClass(classyeni);
        $(".boyamaliyetkarlari").append(clone4);
    });

    $(".secilidurum").click(function(){
         $('.silinecekhammaliyetler').each(function(iham, objham){
             if(iham!=0){
              var silinecekhammaliyetsayi=$('.silinecekhammaliyetler').length;
               if(objham.checked&&silinecekhammaliyetsayi>1){
                    $(objham).parent().parent().remove();
                    siraylacalistir3();
                }
               if(objham.checked&&silinecekhammaliyetsayi==1){
                    alert("Son kalan veriyi silemezsiniz");
                }
             }

        });
    });

    $(".seciliboya").click(function(){
         $('.silinecekhamterbiye').each(function(iham, objham){
              var silinecekhammaliyetsayi=$('.silinecekhamterbiye').length;
               if(objham.checked&&silinecekhammaliyetsayi>1){
                    $(objham).parent().parent().remove();
                    siraylacalistir3();
                }
               if(objham.checked&&silinecekhammaliyetsayi==1){
                    alert("Son kalan veriyi silemezsiniz");
                }
                /*else{
                    alert("Seçmeden silme işlemi yapamazsınız")
                }*/
        });
    });

    $(".seciliboyabaski").click(function(){
         $('.silinecekboyaterbiye').each(function(iham, objham){
              var silinecekhammaliyetsayi=$('.silinecekboyaterbiye').length;
               if(objham.checked&&silinecekhammaliyetsayi>1){
                    $(objham).parent().parent().remove();
                    siraylacalistir3();
                }
               if(objham.checked&&silinecekhammaliyetsayi==1){
                    alert("Son kalan veriyi silemezsiniz");
                }
                /*else{
                    alert("Seçmeden silme işlemi yapamazsınız")
                }*/
        });
    });

    $(".secilisonterbiye").click(function(){
         $('.silineceksonterbiye').each(function(iham, objham){
              var silinecekhammaliyetsayi=$('.silineceksonterbiye').length;
               if(objham.checked&&silinecekhammaliyetsayi>1){
                    $(objham).parent().parent().remove();
                    bolhesapla();
                    altboyahamhizmet();
                    siraylacalistir();
                }
               if(objham.checked&&silinecekhammaliyetsayi==1){
                    alert("Son kalan veriyi silemezsiniz");
                }
                /*else{
                    alert("Seçmeden silme işlemi yapamazsınız")
                }*/
        });
    });

    $(".seciliilavegider").click(function(){
         $('.silinecekilavegider').each(function(iham, objham){
              var silinecekhammaliyetsayi=$('.silinecekilavegider').length;
               if(objham.checked&&silinecekhammaliyetsayi>1){
                    $(objham).parent().parent().remove();
                    siraylacalistir();
                }
               if(objham.checked&&silinecekhammaliyetsayi==1){
                    alert("Son kalan veriyi silemezsiniz");
                }
                /*else{
                    alert("Seçmeden silme işlemi yapamazsınız")
                }*/
        });
    });

});

function selectkontrol(){
    var selectdeger=0;
    $('.iplikkartihepsi tr').each(function(ip, objoran){
        selectdeger++;
        var degerler='denizli'; 
        var ysayi=(ip+1);
        $("#select"+ip).select2();
        //$(objoran).find(".select2-container").remove();
        //$(objoran).find("select").removeAttr('data-select2-id');
        //$(objoran).find("select").select2();
        /*
        setTimeout(function(){
        }, 1000);
        */
    }); 
    
}

function ekhizmetsilme(ths){
    $(ths).parent().parent().parent().remove();
    siraylacalistir3();
}

function resimsil(ths){
    var resimsil=$(ths).parent().find("input").val();
        $.ajax({
            type:"POST",
            url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&resimsil="+resimsil,
            success:function(gelensorgu){
                $(ths).parent().remove();
                alert("Resim kalıcı olarak silindi");
            }
        });
}

function maliyetsilme(ths){
    $(ths).parent().remove();
    var classid=$(ths).parent().find("select option:selected").val();
    if(classid!=''){
        $('.boyamaliyetiinputt'+classid).remove();
        bolhesapla();
        siraylacalistir2();
        //altboyadegistir2();
    }
}

function altmaliyetsilme(ths){
    $(ths).parent().parent().remove();
    bolhesapla();
    altboyahamhizmet();
    siraylacalistir();
    //altboyadegistir2();
}

function karoransilme(ths){
    $(ths).parent().parent().remove();
    siraylacalistir();
}





function hesapla(ths) {
var toplamfiyat = 0;
var toplamfirefiyat = 0;
var toplamfirelifiyat = 0;
var toplamfirelifiyattl = 0;

var toplamfirefiyatdovizli=0;
var toplamfirelifiyatdovizli=0;
var toplamiplikfiyatiyansit=0;

var degeroran=0;
$('.iplikoran').each(function(ip, objoran){
    var iplikoran=$(objoran).find("input").val();
    var iplikoran = sy(iplikoran);
    degeroran=parseFloat(degeroran+iplikoran);
}); 

/*/
if(degeroran!=0){
    if(degeroran>100){
        alert("Toplam iplik oranı değeri 100'den fazla olamaz");
    }
    if(degeroran<100){
        alert("Toplam iplik oranı değeri 100'den az olamaz");
    }
}
/*/
var cekilenhamfasonorgumaliyeti=$('.fasorgumaliyet').val();
if(cekilenhamfasonorgumaliyeti){
    cekilenhamfasonorgumaliyeti=cekilenhamfasonorgumaliyeti.replace(",",".");
}
var cekilenhamfasonorgudoviz=$('.fasondoviz').html();
var cekilenhamfasonorgumaliyeti = sy(cekilenhamfasonorgumaliyeti);
var manuelkurcins=$(".mkurdovizcinsi select option:selected").val();
var manuelkurcins='74';
var manuelkurusd=$(".mkurusd input").val();
var manuelkureur=$(".mkureur input").val();
manuelkurusd=manuelkurusd.replace(",",".");
manuelkureur=manuelkureur.replace(",",".");
var manuelkurtl="1";
var eurid="76";
var tryid="74";
var usdid="75";
var bunacevir=manuelkurtl;
if(cekilenhamfasonorgudoviz=='TRY'){
    var bunacevir=manuelkurtl;
}
if(cekilenhamfasonorgudoviz=='USD'){
    var bunacevir=manuelkurusd;
}
if(cekilenhamfasonorgudoviz=='EUR'){
    var bunacevir=manuelkureur;
}

if(manuelkurcins==eurid){
    var cekilenhamfasonorgumaliyeti = (cekilenhamfasonorgumaliyeti * bunacevir) / manuelkureur;
}
if(manuelkurcins==tryid){
   var cekilenhamfasonorgumaliyeti = (cekilenhamfasonorgumaliyeti * bunacevir) / manuelkurtl;
}
if(manuelkurcins==usdid){
    var cekilenhamfasonorgumaliyeti = (cekilenhamfasonorgumaliyeti * bunacevir) / manuelkurusd;
}

var cekilenhamfasonorgumaliyeti2=$('.fasonorgumaliyeti2').val();
if(cekilenhamfasonorgumaliyeti2){
    cekilenhamfasonorgumaliyeti2=cekilenhamfasonorgumaliyeti2.replace(",",".");
}

var cekilenhamfasonorgudoviz2=$('.fasondoviz2').find("option:selected").text();
if(cekilenhamfasonorgumaliyeti2!=''){
    var manuelkurcins=$(".mkurdovizcinsi select option:selected").val();
    var manuelkurcins='74';
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var manuelkurtl="1";
    var eurid="76";
    var tryid="74";
    var usdid="75";
    var bunacevir=manuelkurtl;
    if(cekilenhamfasonorgudoviz2=='TRY'){
        var bunacevir=manuelkurtl;
    }
    if(cekilenhamfasonorgudoviz2=='USD'){
        var bunacevir=manuelkurusd;
    }
    if(cekilenhamfasonorgudoviz2=='EUR'){
        var bunacevir=manuelkureur;
    }
    if(manuelkurcins==eurid){
        var cekilenhamfasonorgumaliyeti2 = (cekilenhamfasonorgumaliyeti2 * bunacevir) / manuelkureur;
    }
    if(manuelkurcins==tryid){
        var cekilenhamfasonorgumaliyeti2 = (cekilenhamfasonorgumaliyeti2 * bunacevir) / manuelkurtl;
    }
    if(manuelkurcins==usdid){
        var cekilenhamfasonorgumaliyeti2 = (cekilenhamfasonorgumaliyeti2 * bunacevir) / manuelkurusd;
    }
    var cekilenhamfasonorgumaliyeti=cekilenhamfasonorgumaliyeti2;
}


$('.iplikkartihepsi tr').each(function(i, obj2){
    var eachiplikoran=$(obj2).find(".iplikoranlari").val()/100;
    var eachbirimfiyat=$(obj2).find(".iplikbirimfiyat").html();
    var eachiplikfiresi=$(obj2).find(".iplikfiresi input").val();
    var eachiplikfiresi2=$(obj2).find(".iplikfiresi div").html();
    var eachbirimdoviz=$(obj2).find(".iplikbirimdoviz div").html();
    var usdyicek = $(".mkurusd input").val();
    var euryicek = $(".mkureur input").val();
    usdyicek=usdyicek.replace(",",".");
    euryicek=euryicek.replace(",",".");
    var buna='1';
    if(eachbirimdoviz=='USD'){
        buna=usdyicek;
    }
    if(eachbirimdoviz=='EUR'){
        buna=euryicek;
    }

    //var eachiplikfiresi=eachiplikfiresi.split(',').join('.');
    //var eachiplikfiresi2=eachiplikfiresi2.split(',').join('.');
    if(eachiplikfiresi==''){
        var eachiplikfiresi=eachiplikfiresi2;
    }
    var numiplikoran = sy(eachiplikoran);
    var numbirimfiyat = sy(eachbirimfiyat);
    var numiplikfiresi = sy(eachiplikfiresi);
    var numfiyathesapla = sy(numbirimfiyat*numiplikoran,2);
    $(obj2).find(".iplikfiyat").html(numfiyathesapla);
    var fiyaticek = $(obj2).find(".iplikfiyat").html();
    var fiyaticek2 = sy(fiyaticek);
    var firefiyati = sy(numiplikfiresi*fiyaticek2)/100;
    var firefiyati2 = sy(firefiyati,4);
    $(obj2).find(".iplikfire").html(firefiyati2);
    var fireyicek = $(obj2).find(".iplikfire").html();
    var fireyicek2 = sy(fireyicek);
    var firelifiyat= sy(fiyaticek2+fireyicek2);
    var firelifiyat2 = sy(firelifiyat,4);
    $(obj2).find(".iplikfirelifiyat").html(firelifiyat2);
    var firelifiyat2kurlu=sy(firelifiyat2)*buna;
    $(obj2).find(".iplikfirelifiyattl").html(firelifiyat2kurlu);
    var firelifiyatcek = $(obj2).find(".iplikfirelifiyat").html();
    var firelifiyatcek2 = sy(firelifiyatcek);

    toplamfiyat += parseFloat(fiyaticek2);
    toplamfirefiyat += parseFloat(fireyicek2);
    toplamfirelifiyat += parseFloat(firelifiyatcek2);
    toplamfirelifiyattl += parseFloat(firelifiyat2kurlu);
    toplamfirefiyatdovizli=toplamfiyat*buna;
    toplamfirelifiyatdovizli=toplamfirefiyat*buna;
}); 
    
    if(cekilenhamfasonorgumaliyeti){
        toplamiplikfiyatiyansit=toplamfirelifiyattl+cekilenhamfasonorgumaliyeti;
    }else {
        toplamiplikfiyatiyansit=toplamfirelifiyattl;
    }
    toplamiplikfiyatiyansit = sy(toplamiplikfiyatiyansit,4);

    
    
    toplamfiyat = sy(toplamfiyat,4);
    toplamfirefiyat = sy(toplamfirefiyat,4);
    toplamfirelifiyat = sy(toplamfirelifiyat,4);
    toplamfirelifiyattl = sy(toplamfirelifiyattl,4);
    toplamfirefiyatdovizli = sy(toplamfirefiyatdovizli,4);
    toplamfirelifiyatdovizli = sy(toplamfirelifiyatdovizli,4);
    
    $('.toplamfiyatcek').html(toplamfiyat);
    $('.toplamfirefiyaticek').html(toplamfirefiyat);
    $('.toplamfirelifiyaticek').html(toplamfirelifiyat);
    $('.toplamfirelifiyaticektl').html(toplamiplikfiyatiyansit);
    $('.toplamfirelifiyaticektl1').html(toplamfirelifiyattl);
    $('.toplamfirelifiyaticektl2').html(cekilenhamfasonorgumaliyeti);
    var toplamfirelifiyaticek = $(".toplamfirelifiyaticek").html();
    var toplamfirelifiyaticek2 = sy(toplamfirelifiyaticek);
    var toplamfirelifiyaticek3 = parseFloat(toplamfirelifiyaticek);
    var eurid="76";
    var tryid="74";
    var usdid="75";
    var manuelkurcins=$(".mkurdovizcinsi select option:selected").val();
    var manuelkurcins='74';
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var manuelkurtl="1";
    var kurumuz="TRY";
    var rmanuelkurtl = sy(manuelkurtl);
    var rmanuelkureur = sy(manuelkureur);
    var rmanuelkurusd = sy(manuelkurusd);
    var toplamfirelifiyat =toplamfirelifiyat.replace(",", ".");
    var toplamfirelifiyattl =toplamfirelifiyattl.replace(",", ".");
    var kumasturucek=$("#kumasturu option:selected").val();
    if(cekilenhamfasonorgumaliyeti!=''){
        
    }

    var toplamfirelifiyat = (parseFloat(toplamfirelifiyat) + parseFloat(cekilenhamfasonorgumaliyeti));
    var toplamfirelifiyattl = (parseFloat(toplamfirelifiyattl) + parseFloat(cekilenhamfasonorgumaliyeti));
    
    if(manuelkurcins==eurid){
        var fiyathesaplatl = (toplamfirelifiyattl * manuelkureur) / manuelkurtl;
        var fiyathesaplaeur = (toplamfirelifiyattl * manuelkureur) / manuelkureur;
        var fiyathesaplausd = (toplamfirelifiyattl * manuelkureur) / manuelkurusd;
        $('.tpfiyattl').html(fiyathesaplatl.toFixed(2));
        $('.tpfiyateur').html(fiyathesaplaeur.toFixed(2));
        $('.tpfiyatusd').html(fiyathesaplausd.toFixed(2));
    }
    if(manuelkurcins==tryid){
        var fiyathesaplatl = (toplamfirelifiyattl * manuelkurtl) / manuelkurtl;
        var fiyathesaplaeur = (toplamfirelifiyattl * manuelkurtl) / manuelkureur;
        var fiyathesaplausd = (toplamfirelifiyattl * manuelkurtl) / manuelkurusd;
        $('.tpfiyattl').html(fiyathesaplatl.toFixed(2));
        $('.tpfiyateur').html(fiyathesaplaeur.toFixed(2));
        $('.tpfiyatusd').html(fiyathesaplausd.toFixed(2));
    }
    if(manuelkurcins==usdid){
        var fiyathesaplatl = (toplamfirelifiyattl * manuelkurusd) / manuelkurtl;
        var fiyathesaplaeur = (toplamfirelifiyattl * manuelkurusd) / manuelkureur;
        var fiyathesaplausd = (toplamfirelifiyattl * manuelkurusd) / manuelkurusd;
        $('.tpfiyattl').html(fiyathesaplatl.toFixed(2));
        $('.tpfiyateur').html(fiyathesaplaeur.toFixed(2));
        $('.tpfiyatusd').html(fiyathesaplausd.toFixed(2));
    }
    dovizver();
    $('.maliyetham').val(fiyathesaplatl);
    yenidovizdegistir();
    
}
function sil(ths){
    $(ths).parent().remove();
    hesapla();
    siraylacalistir3();
}

function yenidovizdegistir(ths) {
var toplamfiyat = 0;
var toplamfirefiyat = 0;
var toplamfirelifiyat = 0;
var toplamiplikfiyat = 0;
var toplamfasonfiyat = 0;
var toplamhamkumasfiyat = 0;

toplamiplikfiyat=$('.toplamfirelifiyaticektl1').html();
toplamiplikfiyat=sy(toplamiplikfiyat);
toplamfasonfiyat=$('.toplamfirelifiyaticektl2').html();
toplamfasonfiyat=sy(toplamfasonfiyat);
toplamhamkumasfiyat=toplamiplikfiyat+toplamfasonfiyat;

var cekilenhamfasonorgumaliyeti=$('.fasorgumaliyet').val();
if(cekilenhamfasonorgumaliyeti){
    cekilenhamfasonorgumaliyeti=cekilenhamfasonorgumaliyeti.replace(",",".");
}

var cekilenhamfasonorgudoviz=$('.fasondoviz').html();
var cekilenhamfasonorgumaliyeti = sy(cekilenhamfasonorgumaliyeti);

var toplamfirelifiyaticek=$('.toplamfirelifiyaticektl').html();
var toplamfirelifiyaticek = sy(toplamfirelifiyaticek);
var manuelkurcins=$(".yenidoviz select option:selected").val();
var manuelkurusd=$(".mkurusd input").val();
var manuelkureur=$(".mkureur input").val();
manuelkurusd=manuelkurusd.replace(",",".");
manuelkureur=manuelkureur.replace(",",".");
var manuelkurtl="1";
var eurid="76";
var tryid="74";
var usdid="75";
var bunacevir=manuelkurtl;
if(cekilenhamfasonorgudoviz=='TRY'){
    var bunacevir=manuelkurtl;
}
if(cekilenhamfasonorgudoviz=='USD'){
    var bunacevir=manuelkurusd;
}
if(cekilenhamfasonorgudoviz=='EUR'){
    var bunacevir=manuelkureur;
}

if(manuelkurcins==eurid){
    var cekilenhamfasonorgumaliyeti = (cekilenhamfasonorgumaliyeti * bunacevir) / manuelkureur;
}
if(manuelkurcins==tryid){
   var cekilenhamfasonorgumaliyeti = (cekilenhamfasonorgumaliyeti * bunacevir) / manuelkurtl;
}
if(manuelkurcins==usdid){
    var cekilenhamfasonorgumaliyeti = (cekilenhamfasonorgumaliyeti * bunacevir) / manuelkurusd;
}

//toplamfirelifiyaticek=toplamhamkumasfiyat+cekilenhamfasonorgumaliyeti;
toplamfirelifiyaticek=toplamhamkumasfiyat;

if(manuelkurcins==eurid){
    var toplamfirelifiyaticek = (toplamfirelifiyaticek * bunacevir) / manuelkureur;
}
if(manuelkurcins==tryid){
   var toplamfirelifiyaticek = (toplamfirelifiyaticek * bunacevir) / manuelkurtl;
}
if(manuelkurcins==usdid){
    var toplamfirelifiyaticek = (toplamfirelifiyaticek * bunacevir) / manuelkurusd;
}
$(".tpfiyattl").html(toplamfirelifiyaticek);
setTimeout(function(){ boyamaliyetihizmetyansityenieach(); }, 1000);

}

var deger2=1;
function boyamaliyetiarttir(dgr){
    var inputeski="boyamaliyetiinput1";
    var selecteski="boyamaliyetiselect1";
    deger2++;
    var inputyeni="boyamaliyetiinput"+deger2;
    var selectyeni="boyamaliyetiselect"+deger2;

    var cloneObje1 = $('.boyamaliyetiinputt'+dgr+' .boyamaliyetiinput1').clone();
    var cloneObje1 =cloneObje1.removeClass(inputeski);
    var cloneObje1 =cloneObje1.removeClass("boyamaliyetiinput1");
    var cloneObje1 =cloneObje1.addClass(inputyeni);
    $(".boyamaliyetiinputt"+dgr).append(cloneObje1);

    var cloneObje2 = $('.boyamaliyetiselectt'+dgr+' .boyamaliyetiselect1').clone();
    var cloneObje2 =cloneObje2.removeClass(selecteski);
    var cloneObje2 =cloneObje2.removeClass("boyamaliyetiselect1");
    var cloneObje2 =cloneObje2.addClass(selectyeni);
    $(".boyamaliyetiselectt"+dgr).append(cloneObje2);
    var selectboyatdselectlength=$(".selectboyatd select").length;
    if(selectboyatdselectlength){
        var hesaplamaselect;
        hesaplamaselect=(100)/selectboyatdselectlength;
        hesaplamaselect=(hesaplamaselect)-2;
        hesaplamaselect=hesaplamaselect+"%";
        $(".boyamaliyetiinput1 input").css("width",hesaplamaselect);
        $(".karinputlari input").css("width",hesaplamaselect);
    }
}

function endenyansit(){

    $('.pusvefayntbody .pusvefayn').each(function(ipus, objpus){
        var kumaseni=$(objpus).find(".kumaseni input").val();
        if(kumaseni){
            $(objpus).find(".kumasacikeni input").val(kumaseni);
        }
    });

}


var boyamaliyetdegeri=0;
var inputlar='';
function boyamaliyetiyansit(ths){
    var boyabaski_ID = $(ths).val();
    var cekilenhamtl=$('.tpfiyattl').html();
    var cekilenhamtl2=sy(cekilenhamtl);
    var fasonorgumaliyet=cekilenhamtl;
    //$('.boyamaliyetiinputt'+boyabaski_ID).remove();
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var degertd=1;
    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();


    $.ajax({
        type:"POST",
        url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&boyabaski="+boyabaski_ID+"&fasonorgumaliyet="+fasonorgumaliyet+"&cekilenhamkumastl="+cekilensonhamkumastl+"&mkurusd="+manuelkurusd+"&mkureur="+manuelkureur,
        success:function(gelensorgu){
            var boyabaskiformul=gelensorgu.cevap.boyabaskiformul;
            //inputlar=inputlar+'<input type="text" name="kumaskarti[boyamaliyet]['+boyabaskitipi+']['+boyabaski_ID+'][]" value="" autocomplete="off">';
            
            if(boyabaskiformul!=null){

                /*/
                var option='';
                $.each(nesneboyabaski, function(k, v) {
                    option=option+'<option value="'+v.ID+'">'+v.tipi+'</option>';
                });
                /*/
                
                //var select='<select onchange="altboyadegistiryeni(this)" class="'+boyabaski_ID+'" id="'+boyabaskifiyat+'">'+'<option value="0">Seçiniz</option>'+option+'</select>';
                //var klonolustur='<tr class="boyamaliyetlerimiz boyamaliyetiinputt'+boyabaski_ID+'"><th colspan="2">'+select+'</th><td class="boyamaliyetiinput1">'+inputlar+'</td></tr>';
                //$(".boyamaliyetihepsi").append(klonolustur);
                //boyamaliyetdegeri++;
                //altboyadegistir2();

                $(ths).parent().find("div").html(boyabaskiformul);
                
            } else{
                alert('Boya Baskı hizmetleri bulunamadı veya okumada bir sorun oluştu.');
            }
        }
    });
}


var boyamaliyetdegeri=0;
var inputlar='';
window.selectboyatdanahtar=0;
function boyamaliyetiyansityeni(ths){
    
    var boyabaski_ID = $(ths).val();
    var cekilenhamtl=$('.tpfiyattl').html();
    var cekilenhamtl2=sy(cekilenhamtl);
    var fasonorgumaliyet=cekilenhamtl;
    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();
    var cekilensonhamkumastl2=sy(cekilensonhamkumastl);
    if(cekilensonhamkumastl!=''){
        cekilenhamtl2=cekilensonhamkumastl2;
    }
    //$('.boyamaliyetiinputt'+boyabaski_ID).remove();
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var degertd=1;

    
    
    boyamaliyetiyansiteach2();
    var y_ustboyabaski=window.boyabaskiall[boyabaski_ID];
    var y_ustboyabaskifire="";
    var y_ustboyabaskifirekontrol=0;
    if(y_ustboyabaski["fire"]!==null&&y_ustboyabaski["fire"]!==undefined){
        y_ustboyabaskifire=y_ustboyabaski["fire"];
        y_ustboyabaskifirekontrol=y_ustboyabaski["fire"];
        y_ustboyabaskifirekontrol=sy(y_ustboyabaskifirekontrol,2);
    }
    var y_ustboyabaskifire2=sy(y_ustboyabaskifire)+100;
    var y_ustboyabaskifire2=sy(y_ustboyabaskifire2)/100;
    var y_ustboyabaskifiyat=y_ustboyabaski["fiyat"];
    var y_ustboyabaskinesnedoviz=y_ustboyabaski["nesne_IDdoviz"];
    var y_ustfiyathesaplatl=y_ustboyabaskifiyat;

    if(y_ustboyabaskinesnedoviz=='75'){
        var y_ustfiyathesaplatl=(y_ustboyabaskifiyat)*manuelkurusd;
    }
    if(y_ustboyabaskinesnedoviz=='76'){
        var y_ustfiyathesaplatl=(y_ustboyabaskifiyat)*manuelkureur;
    }

    var usttengelenfiyat=0;
    if(cekilensonhamkumastl!=0){
        usttengelenfiyat=cekilensonhamkumastl;
    } else {
        usttengelenfiyat=fasonorgumaliyet;
    }

    var y_ustbaskitoplam=sy(usttengelenfiyat)+y_ustfiyathesaplatl;
    var y_ustbaskitoplam2=sy(y_ustbaskitoplam)*y_ustboyabaskifire2;
    var y_ustbaskitoplam2=y_ustbaskitoplam2.toFixed(2);

    if(window.selectboyatdanahtar==0){
        siradakisayac++;
        window.selectboyatdanahtar=1;
    }

    y_ustboyabaskifiyat=sy(y_ustboyabaskifiyat,4);

    $(ths).parent().find("div").html(y_ustbaskitoplam2);
    $(ths).parent().find("span").html(y_ustboyabaskifiyat);
    $(ths).parent().find("p").html(y_ustboyabaskifirekontrol);

}

function boyamaliyetiyansityeni2(ths){
    
    var boyabaski_ID = $(ths).val();
    var cekilenhamtl=$('.tpfiyattl').html();
    var cekilenhamtl2=sy(cekilenhamtl);
    var fasonorgumaliyet=cekilenhamtl;
    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();
    var cekilensonhamkumastl2=sy(cekilensonhamkumastl);
    if(cekilensonhamkumastl!=''){
        cekilenhamtl2=cekilensonhamkumastl2;
    }
    //$('.boyamaliyetiinputt'+boyabaski_ID).remove();
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var degertd=1;
    
    var y_ustboyabaski=window.boyabaskiall[boyabaski_ID];
    var y_ustboyabaskifire="";
    var y_ustboyabaskifirekontrol=0;
    if(y_ustboyabaski["fire"]!==null&&y_ustboyabaski["fire"]!==undefined){
        y_ustboyabaskifire=y_ustboyabaski["fire"];
        y_ustboyabaskifirekontrol=y_ustboyabaski["fire"];
        y_ustboyabaskifirekontrol=sy(y_ustboyabaskifirekontrol,2);
    }
    var y_ustboyabaskifire2=sy(y_ustboyabaskifire)+100;
    var y_ustboyabaskifire2=sy(y_ustboyabaskifire2)/100;
    var y_ustboyabaskifiyat=y_ustboyabaski["fiyat"];
    var y_ustboyabaskinesnedoviz=y_ustboyabaski["nesne_IDdoviz"];
    var y_ustfiyathesaplatl=y_ustboyabaskifiyat;

    if(y_ustboyabaskinesnedoviz=='75'){
        var y_ustfiyathesaplatl=(y_ustboyabaskifiyat)*manuelkurusd;
    }
    if(y_ustboyabaskinesnedoviz=='76'){
        var y_ustfiyathesaplatl=(y_ustboyabaskifiyat)*manuelkureur;
    }

    var usttengelenfiyat=0;
    if(cekilensonhamkumastl!=0){
        usttengelenfiyat=cekilensonhamkumastl;
    } else {
        usttengelenfiyat=fasonorgumaliyet;
    }

    var y_ustbaskitoplam=sy(usttengelenfiyat)+y_ustfiyathesaplatl;
    var y_ustbaskitoplam2=sy(y_ustbaskitoplam)*y_ustboyabaskifire2;
    var y_ustbaskitoplam2=y_ustbaskitoplam2.toFixed(2);

    if(window.selectboyatdanahtar==0){
        siradakisayac++;
        window.selectboyatdanahtar=1;
    }

    y_ustboyabaskifiyat=sy(y_ustboyabaskifiyat,4);

    $(ths).parent().find("div").html(y_ustbaskitoplam2);
    $(ths).parent().find("span").html(y_ustboyabaskifiyat);
    $(ths).parent().find("p").html(y_ustboyabaskifirekontrol);

}

function boyamaliyetiyansiteach(){
    var indexsayi=0;
    var selectboyatdlength=$('.selectboyatd .boyabaskimaliyet ').length;
    $('.selectboyatd .boyabaskimaliyet').each(function(i2, objeach){
        window.altsayac3++;
        var alttabloindex=$(objeach).index();
        if(indexsayi==alttabloindex){
            var obj_ID=$(".selectboyatd select:eq("+alttabloindex+")");
            window.obj_ID=obj_ID;
            boyamaliyetiyansityeni(obj_ID)
        }
        indexsayi++;
    });
}

function boyamaliyetiyansiteach2(){
    var indexsayi=0;
    var selectboyatdlength=$('.selectboyatd .boyabaskimaliyet ').length;
    $('.selectboyatd .boyabaskimaliyet').each(function(i2, objeach){
        window.altsayac3++;
        var alttabloindex=$(objeach).index();
        if(indexsayi==alttabloindex){
            var obj_ID=$(".selectboyatd select:eq("+alttabloindex+")");
            window.obj_ID=obj_ID;
            boyamaliyetiyansityeni2(obj_ID)
        }
        indexsayi++;
    });
    siraylacalistir();

}

var siraylacalistirsayac2=0;
function siraylacalistir2(){
    var selectboyatdlength=$('.selectboyatd select').length;
    $.ajax({
        type:"POST",
        url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu",
        success:function(gelensorgu){

            boyamaliyetiyansiteach();
            
            if(siraylacalistirsayac2<selectboyatdlength){
                siraylacalistirsayac2++;
                siraylacalistir2();
            } else {
                siraylacalistirsayac2=0;
                var siradakisayac=2;
                var islemdekisayac=-1;
            }

        }
    });
}

window.altsayac=0;
function bitti(sonsayac,boyabaski_ID,boyatext){
    if(sonsayac<=window.altsayac){
        $('.altboyabaski'+boyabaski_ID).remove();
        var sanalalt='<tr class="altboyabaskilar altboyabaski'+boyabaski_ID+'"><th colspan="2">'+boyatext+'</th><td class="altboyabaskitext">'+window.altbaskitext+'</td></tr>';
        $(".mamulboyamaliyeti").before(sanalalt);
    }
}

window.altsayac2=0;
function bitti2(sonsayac2,hamhizmet){
    if(sonsayac2<=window.altsayac2){
        var sanalveri='<input type="text" value="'+window.hamhizmet+'" autocomplete="off" name="ekhizmet" disabled="disabled">';
        //$('.tlekboyamaliyeti td').html(sanalveri);
    }
}

function altboyadegistir(ths){
    var boyabaski_ID = $(ths).val();
    var boyabaskiust_ID = $(ths).attr("class");
    var boyabaskiustfiyat = $('.'+boyabaskiust_ID).attr("id");
    var boyamaliyetlerimizlength=$('.tablealt .boyamaliyetlerimiz').length;
    var alttabloindex=$(ths).parent().parent().index();
    var alttabloindex2=(alttabloindex-4);

    $('.boyamaliyetfiyati .tlboyamaliyetimiz td input').remove();
    $('.boyamaliyetfiyati .usdboyamaliyetimiz td input').remove();
    $('.boyamaliyetfiyati .eurboyamaliyetimiz td input').remove();

    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var degertd=1;

    var karmiktari=0;
    var karihesapla=0;
    $('.karoranlari').each(function(kar, objkar){
        var karmiktariobj=$(objkar).val();
        karmiktari=parseFloat(karmiktariobj)+karmiktari;
    });
    if(karmiktari!=0){
        var karihesapla=(karmiktari+100)/100;
    }
    console.log("karihesapla");
    console.log(karihesapla);
    
    var option='';
    var input='';
    var ustboyabaski='';
    var hamhizmet=0;
    var cekilenhamfasonorgumaliyeti=$('.fasorgumaliyet').val();
    if(cekilenhamfasonorgumaliyeti){
        cekilenhamfasonorgumaliyeti=cekilenhamfasonorgumaliyeti.replace(",",".");
    }
    var cekilenhamtl=$('.tpfiyattl').html();
    var cekilenhamtl2=sy(cekilenhamtl);
    var fasonorgumaliyet=cekilenhamtl;
    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();
    var cekilensonhamkumastl2=sy(cekilensonhamkumastl);
    if(cekilensonhamkumastl!=''){
        cekilenhamtl2=cekilensonhamkumastl2;
    }
    var iplikclass="boyamaliyetiinputt"+boyabaskiust_ID;
    $('.'+iplikclass+' .boyamaliyetiinput1').html(input);
    //$('.boyamaliyetihepsi select').prop("disabled", true);
    var boyainput=1;
    var sayac1=0;
    window.sayacimiz=0;
    window.yinput='';
    window.yinput2='';
    window.ytoplaminput='';
    window.ytoplaminput2='';
    window.ytoplaminput3='';
    window.kartoplaminput='';
    window.kartoplaminput2='';
    window.kartoplaminput3='';
    window.selectboyatdanahtar=0;
    var selectboyatdselectlength=$(".selectboyatd select").length;
    if(selectboyatdselectlength){
        var hesaplamaselect;
        hesaplamaselect=(100)/selectboyatdselectlength;
        hesaplamaselect=(hesaplamaselect)-2;
        hesaplamaselect=hesaplamaselect+"%";
        $(".boyamaliyetiinput1 input").css("width",hesaplamaselect);
        $(".karinputlari input").css("width",hesaplamaselect);
    }
    $('.selectboyatd select').each(function(i, obj3){
        var iplik_ID = $(obj3).find("option:selected").val();
        var input='';
        $.ajax({
            type:"POST",
            url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&ustboyabaski="+iplik_ID+"&altboyabaski="+boyabaski_ID+"&fasonorgumaliyet="+fasonorgumaliyet+"&cekilenhamkumastl="+cekilensonhamkumastl+"&cekilenfasonorgu"+cekilenhamfasonorgumaliyeti+"&mkurusd="+manuelkurusd+"&mkureur="+manuelkureur,
            success:function(gelensorgu){
                if(window.selectboyatdanahtar==0){
                    siradakisayac++;
                    window.selectboyatdanahtar=1;
                }
                $('.boyamaliyetfiyati .tlboyamaliyetimiz td input').remove();
                $('.boyamaliyetfiyati .usdboyamaliyetimiz td input').remove();
                $('.boyamaliyetfiyati .eurboyamaliyetimiz td input').remove();
                var ustboyabaski=gelensorgu.cevap.ustboyabaski;
                if(ustboyabaski==0){
                    ustboyabaski=parseFloat(cekilenhamtl2);
                }
                var ustbaskitoplam=gelensorgu.cevap.ustbaskitoplam;
                var altbaskitoplam=gelensorgu.cevap.altbaskitoplam;
                if(ustboyabaski!=null){
                var input='<input type="text" name="kumaskarti[boyamaliyet]['+iplik_ID+']['+boyabaski_ID+']" value="'+ustboyabaski+'" autocomplete="off" class="boyamaliyethesapla boyainput'+boyainput+'" disabled><input type="hidden" name="kumaskarti[boyamaliyet]['+iplik_ID+']['+boyabaski_ID+']" value="'+ustboyabaski+'" autocomplete="off" class="boyamaliyethesapla">';
                window.yinput=window.yinput+input;

                var ustboyabaskikar=0;
                var toplameskiveyenifiyat1=0;
                var toplaminput='';
                var toplaminput2='';
                var toplaminput3='';
                
                if(karihesapla!=0){
                    ustboyabaskikar=sy(ustboyabaski)*karihesapla;
                    var toplaminput=ustboyabaskikar.toFixed(2);
                    var toplaminput='<input type="text" class="form-control" value="'+toplaminput+'" autocomplete="off"disabled>';
                    
                    var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
                    var toplaminput2=fiyathesaplaeur.toFixed(2);
                    var toplaminput2='<input type="text" class="form-control" value="'+toplaminput2+'" autocomplete="off"disabled>';
                    
                    var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
                    var toplaminput3=fiyathesaplausd.toFixed(2);
                    var toplaminput3='<input type="text" class="form-control" value="'+toplaminput3+'" autocomplete="off"disabled>';

                    window.ytoplaminput=window.ytoplaminput+toplaminput;
                    window.ytoplaminput2=window.ytoplaminput2+toplaminput3;
                    window.ytoplaminput3=window.ytoplaminput3+toplaminput2;
                } else {
                    console.log("ustboyabaski");
                    console.log(ustboyabaski);
                    ustboyabaskikar=ustboyabaski;
                    var toplaminput=ustboyabaskikar;
                    var toplaminput='<input type="text" class="form-control" value="'+toplaminput+'" autocomplete="off"disabled>';

                    var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
                    var toplaminput2=fiyathesaplaeur;
                    var toplaminput2='<input type="text" class="form-control" value="'+toplaminput2+'" autocomplete="off"disabled>';

                    var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
                    var toplaminput3=fiyathesaplausd;
                    var toplaminput3='<input type="text" class="form-control" value="'+toplaminput3+'" autocomplete="off"disabled>';

                    window.ytoplaminput=window.ytoplaminput+toplaminput;
                    window.ytoplaminput2=window.ytoplaminput2+toplaminput3;
                    window.ytoplaminput3=window.ytoplaminput3+toplaminput2;
                }

                if(alttabloindex==3){
                    $('.'+iplikclass+' .boyamaliyetiinput1').html(window.yinput);
                    $('.boyamaliyetfiyati .tlboyamaliyetimiz td').html(window.ytoplaminput);
                    $('.boyamaliyetfiyati .usdboyamaliyetimiz td').html(window.ytoplaminput2);
                    $('.boyamaliyetfiyati .eurboyamaliyetimiz td').html(window.ytoplaminput3);
                } else if(boyamaliyetlerimizlength>1){
                    var inputsec=$('.boyamaliyetlerimiz:eq('+alttabloindex2+') input[type=text]:eq('+sayac1+')').val();
                    var inputsec=sy(inputsec);
                    var ustboyabaski=sy(ustboyabaski);
                    var toplameskiveyenifiyat1=sy(inputsec+ustboyabaski);
                    var toplameskiveyenifiyat=toplameskiveyenifiyat1.toFixed(2);
                    var input='<input type="text" name="kumaskarti[boyamaliyet]['+iplik_ID+']['+boyabaski_ID+']" value="'+toplameskiveyenifiyat+'" autocomplete="off" class="boyamaliyethesapla boyainput'+boyainput+'" disabled><input type="hidden" name="kumaskarti[boyamaliyet]['+iplik_ID+']['+boyabaski_ID+']" value="'+toplameskiveyenifiyat+'" autocomplete="off" class="boyamaliyethesapla">';
                    window.yinput2=window.yinput2+input;
                    $('.'+iplikclass+' .boyamaliyetiinput1').html(window.yinput2);

                    var toplaminput='';
                    var toplaminput2='';
                    var toplaminput3='';
                    var ustboyabaskikar=0;
                    if(karihesapla!=0){
                        ustboyabaskikar=sy(toplameskiveyenifiyat1)*karihesapla;
                        var toplaminput=ustboyabaskikar.toFixed(2);
                        var toplaminput='<input type="text" class="form-control" value="'+toplaminput+'" autocomplete="off"disabled>';

                        var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
                        var toplaminput2=fiyathesaplaeur.toFixed(2);
                        var toplaminput2='<input type="text" class="form-control" value="'+toplaminput2+'" autocomplete="off"disabled>';

                        var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
                        var toplaminput3=fiyathesaplausd.toFixed(2);
                        var toplaminput3='<input type="text" class="form-control" value="'+toplaminput3+'" autocomplete="off"disabled>';

                        window.kartoplaminput=window.kartoplaminput+toplaminput;
                        window.kartoplaminput2=window.kartoplaminput2+toplaminput3;
                        window.kartoplaminput3=window.kartoplaminput3+toplaminput2;
                        
                        $('.boyamaliyetfiyati .tlboyamaliyetimiz td').html(window.kartoplaminput);
                        $('.boyamaliyetfiyati .usdboyamaliyetimiz td').html(window.kartoplaminput2);
                        $('.boyamaliyetfiyati .eurboyamaliyetimiz td').html(window.kartoplaminput3);
                    } else {
                        ustboyabaskikar=ustboyabaski;
                        console.log("ustboyabaski");
                        console.log(ustboyabaski);
                        var toplaminput=ustboyabaskikar.toFixed(2);
                        var toplaminput='<input type="text" class="form-control" value="'+toplaminput+'" autocomplete="off"disabled>';

                        var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
                        var toplaminput2=fiyathesaplaeur.toFixed(2);
                        var toplaminput2='<input type="text" class="form-control" value="'+toplaminput2+'" autocomplete="off"disabled>';

                        var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
                        var toplaminput3=fiyathesaplausd.toFixed(2);
                        var toplaminput3='<input type="text" class="form-control" value="'+toplaminput3+'" autocomplete="off"disabled>';

                        window.kartoplaminput=window.kartoplaminput+toplaminput;
                        window.kartoplaminput2=window.kartoplaminput2+toplaminput3;
                        window.kartoplaminput3=window.kartoplaminput3+toplaminput2;

                        $('.boyamaliyetfiyati .tlboyamaliyetimiz td').html(window.kartoplaminput);
                        $('.boyamaliyetfiyati .usdboyamaliyetimiz td').html(window.kartoplaminput2);
                        $('.boyamaliyetfiyati .eurboyamaliyetimiz td').html(window.kartoplaminput3);
                    }


                    window.sayacimiz++;
                    sayac1++;
                } else {

                }
                boyainput++;
                //altboyadegistir2();
                //altboyahamhizmet();
                $(ths).parent().find("div").html(altbaskitoplam.toFixed(2));
                } 
            }
        });
    });

    var selectboyatdselectlength=$(".selectboyatd select").length;
    if(selectboyatdselectlength){
        var hesaplamaselect;
        hesaplamaselect=(100)/selectboyatdselectlength;
        hesaplamaselect=(hesaplamaselect)-2;
        hesaplamaselect=hesaplamaselect+"%";
        $(".boyamaliyetiinput1 input").css("width",hesaplamaselect);
        $(".karinputlari input").css("width",hesaplamaselect);
    }
    

    //$('.boyamaliyetihepsi select').prop("disabled", false);
    //setTimeout(function(){ bolhesapla(); }, 4000);
}





function altboyadegistireach(){
    var indexsayi=4;
    var boyamaliyetlerimizlength=$('.tablealt .boyamaliyetlerimiz').length;
    $('.boyamaliyetlerimiz').each(function(i2, objeach){
        window.altsayac3++;
        var alttabloindex=$(objeach).index();
        
        if(indexsayi==alttabloindex){
            var obj_ID=$(".boyamaliyetihepsi tr:eq("+alttabloindex+")").find("select");
            window.obj_ID=obj_ID;
            bitti3(boyamaliyetlerimizlength,obj_ID);
        }
        
        indexsayi++;
    });
}

var siradakisayac=2;
var islemdekisayac=-1;
function altboyadegistirsiradaki(){
    var boyamaliyetlerimizlength=$('.tablealt .boyamaliyetlerimiz').length;
    if(siradakisayac!=islemdekisayac){
        islemdekisayac=siradakisayac;
        var obj_ID=$(".boyamaliyetihepsi tr:eq("+siradakisayac+")").find("select");
        window.obj_ID=obj_ID;
        bitti3(boyamaliyetlerimizlength,obj_ID);
    }
}

var siraylacalistirsayac=0;
function siraylacalistir(){
    var boyamaliyetlerimizlength=$('.tablealt .boyamaliyetlerimiz').length;
    $.ajax({
        type:"POST",
        url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu",
        success:function(gelensorgu){

            altboyadegistireach();
            
            if(siraylacalistirsayac<boyamaliyetlerimizlength-1){
                siraylacalistirsayac++;
                siraylacalistir();
            } else {
                siraylacalistirsayac=0;
                var siradakisayac=2;
                var islemdekisayac=-1;
            }

        }
    });
}

/*
SENKRON BASİT ÖRNEK
var siraylacalistirsayac=0;
function siraylacalistir(){
    var boyamaliyetlerimizlength=$('.tablealt .boyamaliyetlerimiz').length;
    $.ajax({
        type:"POST",
        url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu",
        success:function(gelensorgu){
            if(siraylacalistirsayac<boyamaliyetlerimizlength-1){
                siraylacalistirsayac++;
                siraylacalistir();
            } else {
                siraylacalistirsayac=0;
            }

        }
    });
}
*/

/*
var siradakisayac=2;
var islemdekisayac=-1;
function altboyadegistirsiradaki2(){
    var boyamaliyetlerimizlength=$('.tablealt .boyamaliyetlerimiz').length;
    setTimeout(function(){  
        var i;
        for (i = 0; i < boyamaliyetlerimizlength; i++) {
            if(siradakisayac!=islemdekisayac){
                islemdekisayac=siradakisayac;
                var obj_ID=$(".boyamaliyetihepsi tr:eq("+siradakisayac+")").find("select");
                window.obj_ID=obj_ID;
                bitti3(boyamaliyetlerimizlength,obj_ID);
            }
        }
    }, 2000);
}
*/

function dovizver(sorgu){
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var degertd=1;

    var cekilenhamfasonorgumaliyeti=$('.fasorgumaliyet').val();
    if(cekilenhamfasonorgumaliyeti){
        cekilenhamfasonorgumaliyeti=cekilenhamfasonorgumaliyeti.replace(",",".");
    }
    var cekilenhamtl=$('.tpfiyattl').html();
    var cekilenhamtl2=sy(cekilenhamtl);
    var toplaminput=cekilenhamtl2;

    var fiyathesaplaeur = (toplaminput)  / manuelkureur;
    var toplaminput2=fiyathesaplaeur;

    var fiyathesaplausd = (toplaminput) / manuelkurusd;
    var toplaminput3=fiyathesaplausd;
    /*
    var toplaminput='<input type="text" class="form-control" value="'+toplaminput+'" autocomplete="off"disabled><input type="hidden" name="kumaskarti[fiyatlar][]" value="'+toplaminput+'">';
    var toplaminput2='<input type="text" class="form-control" value="'+toplaminput2+'" autocomplete="off"disabled>';
    var toplaminput3='<input type="text"  class="form-control"value="'+toplaminput3+'" autocomplete="off"disabled>';

    $('.boyamaliyetfiyati .tlboyamaliyetimiz td').html(toplaminput);
    $('.boyamaliyetfiyati .usdboyamaliyetimiz td').html(toplaminput2);
    $('.boyamaliyetfiyati .eurboyamaliyetimiz td').html(toplaminput3);
    */
}

function altboyadegistiryenieach(){
    var indexsayialt=0;
    $('.boyamaliyetlerimiz').each(function(i2, objeach){
        var alttabloindex=$(objeach).index();
        
        if(indexsayialt==alttabloindex){
            var obj_ID=$(".boyamaliyetlerimiz:eq("+(indexsayialt)+")").find("select");
        
            setTimeout(function(){ 
                altboyadegistiryeni(obj_ID);
            }, 2000);
        }
        indexsayialt++;
    });
}

function altboyadegistiryeni(ths){
    var boyabaski_ID = $(ths).val();
    if(boyabaski_ID=='0'){
        boyabaski_ID='10';
    }
    var boyabaskiust_ID = $(ths).attr("class");
    var boyabaskiustfiyat = $('.'+boyabaskiust_ID).attr("id");
    var boyamaliyetlerimizlength=$('.tablealt .boyamaliyetlerimiz').length;
    var boyamaliyetlerimizlength2=$('.boyamaliyetihepsi tr').length;
    var boyamaliyetlerimizlengthorj=$('.boyamaliyetihepsi .boyamaliyetlerimiz').length;
    var alttabloindex=$(ths).parent().parent().index();
    var alttabloindexx=alttabloindex;
    var alttabloindex=(alttabloindex-1);
    var alttabloindex2=(alttabloindex-5);
    var alttabloindex3=(alttabloindex-4);
    var alttabloindexyeni=(alttabloindex-3);


    

    $('.boyamaliyetfiyati .tlboyamaliyetimiz td input').remove();
    $('.boyamaliyetfiyati .usdboyamaliyetimiz td input').remove();
    $('.boyamaliyetfiyati .eurboyamaliyetimiz td input').remove();

    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var degertd=1;

    var karmiktari=0;
    var karihesapla=0;
    $('.karoranlari').each(function(kar, objkar){
        var karmiktariobj=$(objkar).val();
        if(karmiktariobj!=''){
            karmiktari=parseFloat(karmiktariobj)+karmiktari;
        }
    });
    if(karmiktari!=0){
        var karihesapla=(karmiktari+100)/100;
    }
    if(karmiktari==''){
        var karihesapla=0;
    }
    // console.log("karihesapla");
    // console.log(karihesapla);

    
    var option='';
    var input='';
    var ustboyabaski='';
    var hamhizmet=0;
    var cekilenhamfasonorgumaliyeti=$('.fasorgumaliyet').val();
    if(cekilenhamfasonorgumaliyeti){
        cekilenhamfasonorgumaliyeti=cekilenhamfasonorgumaliyeti.replace(",",".");
    }
    var cekilenhamtl=$('.tpfiyattl').html();
    var cekilenhamtl2=sy(cekilenhamtl);
    var fasonorgumaliyet=cekilenhamtl;
    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();
    var cekilensonhamkumastl2=sy(cekilensonhamkumastl);
    if(cekilensonhamkumastl!=''){
        cekilenhamtl2=cekilensonhamkumastl2;
    }
    var iplikclass="boyamaliyetiinputt"+boyabaskiust_ID;
    //$('.'+iplikclass+' .boyamaliyetiinput1').html(input);
    //$('.boyamaliyetihepsi select').prop("disabled", true);
    var boyainput=1;
    var sayac1=0;
    window.sayacimiz=0;
    window.yinput='';
    window.yinput2='';
    window.ytoplaminput='';
    window.ytoplaminput2='';
    window.ytoplaminput3='';
    window.kartoplaminput='';
    window.kartoplaminput2='';
    window.kartoplaminput3='';
    window.selectboyatdanahtar=0;
    var input='';
    var verisayi=0;
    var verisayi2=0;
    var y_altbaskibirimfiyat=0;
    var boyabaskisonfiyat=$('.boyabaskimaliyet:last .yetkikontrolfiyat').html();
    var sonterbiyefiyat=$('.boyamaliyetlerimiz:last .boyainput1').html();
    var selectboyatdselectlength=$(".selectboyatd select").length;
    if(selectboyatdselectlength){
        var hesaplamaselect;
        hesaplamaselect=(100)/selectboyatdselectlength;
        hesaplamaselect=(hesaplamaselect)-2;
        hesaplamaselect=hesaplamaselect+"%";
        $(".boyamaliyetiinput1 input").css("width",hesaplamaselect);
        $(".karinputlari input").css("width",hesaplamaselect);
    }
    var denemesayi=0;
    var gondipsayi=0;
    $('.selectboyatd select').each(function(i, obj4){
        var selectvalfiyat=$('.boyabaskitr .yetkikontrolfiyat:eq('+verisayi+')').html();
        var selectvalboyamaliyeti=$(".boyamaliyetlerimiz:eq("+alttabloindex3+") .boyamaliyetiinput1 input[type=text]:eq("+verisayi+")").val();

        // console.log("selectvalboyamaliyeti");
        // console.log(selectvalboyamaliyeti);

        
        if(alttabloindex3!='-1'){
            selectvalfiyat=selectvalboyamaliyeti;
        }

        // console.log("selectvalfiyat");
        // console.log(selectvalfiyat);

        if(verisayi!=0){
            verisayi2++;
        }
        verisayi++;
        
        if(window.selectboyatdanahtar==0){
            siradakisayac++;
            window.selectboyatdanahtar=1;
        }
        var iplik_ID = $(obj4).find("option:selected").val();

        var y_ustboyabaski=window.boyabaskiall[iplik_ID];
        var y_ustboyabaskifire="";
        if(y_ustboyabaski["fire"]!==null&&y_ustboyabaski["fire"]!==undefined){
            y_ustboyabaskifire=y_ustboyabaski["fire"];
        }
        var y_ustboyabaskifire2=sy(y_ustboyabaskifire)+100;
        var y_ustboyabaskifire2=sy(y_ustboyabaskifire2)/100;
        var y_ustboyabaskifiyat=y_ustboyabaski["fiyat"];
        var y_ustboyabaskinesnedoviz=y_ustboyabaski["nesne_IDdoviz"];

        var y_altboyabaski=window.boyabaskiall[boyabaski_ID];
        var y_altboyabaskifire="";
        var y_altboyabaskifiresade="";
        if(y_altboyabaski["fire"]!==null&&y_altboyabaski["fire"]!==undefined){
            y_altboyabaskifire=y_altboyabaski["fire"];
            y_altboyabaskifiresade=y_altboyabaski["fire"];
        }
        var y_altboyabaskifire2=sy(y_altboyabaskifire)+100;
        var y_altboyabaskifire2=sy(y_altboyabaskifire2)/100;
        var y_altboyabaskifiyat=y_altboyabaski["fiyat"];
        var y_altboyabaskinesnedoviz=y_altboyabaski["nesne_IDdoviz"];

        var y_ustfiyathesaplatl=y_ustboyabaskifiyat;

        // console.log("iplik_ID");
        // console.log(iplik_ID);
        // console.log("boyabaski_ID");
        // console.log(boyabaski_ID);


        if(y_ustboyabaskinesnedoviz=='75'){
            var y_ustfiyathesaplatl=(y_ustboyabaskifiyat)*manuelkurusd;
        }
        if(y_ustboyabaskinesnedoviz=='76'){
            var y_ustfiyathesaplatl=(y_ustboyabaskifiyat)*manuelkureur;
        }


        var y_altfiyathesaplatl=y_altboyabaskifiyat;

        var altboyadovizsimgesi='₺';

        if(y_altboyabaskinesnedoviz=='75'){
            var y_altfiyathesaplatl=(y_altboyabaskifiyat)*manuelkurusd;
            altboyadovizsimgesi='$';
        }
        if(y_altboyabaskinesnedoviz=='76'){
            var y_altfiyathesaplatl=(y_altboyabaskifiyat)*manuelkureur;
            altboyadovizsimgesi='€';
        }
        

        
        var usttengelenfiyat=0;
        usttengelenfiyat=selectvalfiyat;
        if(selectvalfiyat==0){
            usttengelenfiyat=cekilensonhamkumastl;
        }
        if(cekilensonhamkumastl==0){
            usttengelenfiyat=fasonorgumaliyet;
        }
        
        

        var y_ustbaskitoplam=sy(usttengelenfiyat)+y_ustfiyathesaplatl;
        var y_ustbaskitoplam2=sy(y_ustbaskitoplam)*y_ustboyabaskifire2;
       
       
        y_altbaskibirimfiyat=sy(y_altfiyathesaplatl);
        var yenialtfiyathesaplamatl=sy(usttengelenfiyat)+y_altbaskibirimfiyat;

        

        var y_altbaskitoplam=sy(yenialtfiyathesaplamatl)*y_altboyabaskifire2;
        y_altbaskibirimfiyat=sy(y_altfiyathesaplatl);

        var baskitoplam=(y_ustbaskitoplam2)+y_altfiyathesaplatl;
        var baskitoplam2=(baskitoplam)*y_altboyabaskifire2;

        

                if(window.selectboyatdanahtar==0){
                    siradakisayac++;
                    window.selectboyatdanahtar=1;
                }
                var ustbaskitoplam=y_ustbaskitoplam2;
                var altbaskitoplam=y_altbaskitoplam;
                boyamaliyetlerimizlength2=(boyamaliyetlerimizlength2-1);
                var altbaskitoplam2=altbaskitoplam;
                
                var ustboyabaski=baskitoplam2.toFixed(4);
                var ustboyabaskii=baskitoplam2.toFixed(4);
                if(y_altfiyathesaplatl==0){
                    if(boyamaliyetlerimizlengthorj!=1){
                        var ustboyabaski=parseFloat(usttengelenfiyat);
                    }
                    else {
                        var ustboyabaski=parseFloat(ustbaskitoplam);
                    }
                }
                if(ustboyabaski==0||ustboyabaski==''||ustboyabaski==null||ustboyabaski==NaN){
                    ustboyabaski=parseFloat(usttengelenfiyat);
                }
                
                var boyainputclassi=".boyainput"+gondipsayi;
                var ustumuz=$(".boyamaliyetiinput1:last input:eq("+gondipsayi+")").val();
                var ustumuz2=$(boyainputclassi).val();
                gondipsayi++;
                gondipsayi++;

                


                // console.log("...................");
                // console.log("ustboyabaski");
                // console.log(ustboyabaski);
                // console.log("usttengelenfiyat");
                // console.log(usttengelenfiyat);
                // console.log("baskitoplam2");
                // console.log(baskitoplam2);
                // console.log("ustbaskitoplam");
                // console.log(ustbaskitoplam);
                // console.log("-------------------");

                
                
                
                var input='<input type="text" name="kumaskarti[boyamaliyet]['+iplik_ID+']['+boyabaski_ID+']" value="'+altbaskitoplam+'" autocomplete="off" class="boyamaliyethesapla form-control boyainput'+boyainput+'" disabled><input type="hidden" name="kumaskarti[boyamaliyet]['+iplik_ID+']['+boyabaski_ID+']" value="'+altbaskitoplam+'" autocomplete="off" class="boyamaliyethesapla">';
                window.yinput=window.yinput+input;

                var ustboyabaskikar=0;
                var toplameskiveyenifiyat1=0;
                var toplaminput='';
                var toplaminput2='';
                var toplaminput3='';
                if(karihesapla!=0){
                    ustboyabaskikar=sy(ustboyabaski)*karihesapla;
                    var toplaminput=ustboyabaskikar.toFixed(2);
                    var toplaminput='<input type="text" value="'+toplaminput+'" autocomplete="off" class="form-control" disabled><input type="hidden" name="kumaskarti[fiyatlar][]" value="'+toplaminput+'">';
                    
                    var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
                    var toplaminput2=fiyathesaplaeur.toFixed(2);
                    var toplaminput2='<input type="text" value="'+toplaminput2+'" autocomplete="off" class="form-control" disabled>';
                    
                    var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
                    var toplaminput3=fiyathesaplausd.toFixed(2);
                    var toplaminput3='<input type="text" value="'+toplaminput3+'" autocomplete="off" class="form-control" disabled>';

                    window.ytoplaminput=window.ytoplaminput+toplaminput;
                    window.ytoplaminput2=window.ytoplaminput2+toplaminput3;
                    window.ytoplaminput3=window.ytoplaminput3+toplaminput2;
                    console.log("burada kardeşim - 1");
                } else {
                    ustboyabaskikar=ustboyabaski;
                    var toplaminput=ustboyabaskikar;
                    var toplaminput='<input type="text" value="'+toplaminput+'" autocomplete="off" class="form-control" disabled><input type="hidden" name="kumaskarti[fiyatlar][]" value="'+toplaminput+'">';

                    var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
                    var toplaminput2=fiyathesaplaeur;
                    var toplaminput2='<input type="text" value="'+toplaminput2+'" autocomplete="off" class="form-control" disabled>';

                    var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
                    var toplaminput3=fiyathesaplausd;
                    var toplaminput3='<input type="text" value="'+toplaminput3+'" autocomplete="off" class="form-control" disabled>';

                    window.ytoplaminput=window.ytoplaminput+toplaminput;
                    window.ytoplaminput2=window.ytoplaminput2+toplaminput3;
                    window.ytoplaminput3=window.ytoplaminput3+toplaminput2;
                    console.log("burada kardeşim - 2");
                }

                // console.log(ustboyabaskikar);
                // console.log("ustboyabaskikar");
                
                if(alttabloindex==3){
                    
                    $('.'+iplikclass+' .boyamaliyetiinput1').html(window.yinput);
                        //$('.boyamaliyetfiyati .tlboyamaliyetimiz td').html(window.ytoplaminput);
                        //$('.boyamaliyetfiyati .usdboyamaliyetimiz td').html(window.ytoplaminput2);
                        //$('.boyamaliyetfiyati .eurboyamaliyetimiz td').html(window.ytoplaminput3);
                        console.log("burada kardeşim - 3");
                    
                } else if(boyamaliyetlerimizlength>1){
                    var inputsec=$('.boyamaliyetlerimiz:eq('+alttabloindex2+') input[type=text]:eq('+sayac1+')').val();
                    var inputsec=sy(inputsec);
                    var ustboyabaski=sy(ustboyabaski);
                    // console.log("inputsec");
                    // console.log(inputsec);
                    // console.log("ustboyabaski");
                    // console.log(ustboyabaski);
                    console.log("burada kardeşim - 4");
                    var toplameskiveyenifiyat1=sy(inputsec+ustboyabaski);
                    var toplameskiveyenifiyat=toplameskiveyenifiyat1.toFixed(2);
                    var input='<input type="text" name="kumaskarti[boyamaliyet]['+iplik_ID+']['+boyabaski_ID+']" value="'+altbaskitoplam2+'" autocomplete="off" class="boyamaliyethesapla form-control boyainput'+boyainput+'" disabled><input type="hidden" name="kumaskarti[boyamaliyet]['+iplik_ID+']['+boyabaski_ID+']" value="'+altbaskitoplam2+'" autocomplete="off" class="boyamaliyethesapla">';
                    window.yinput2=window.yinput2+input;
                    $('.'+iplikclass+' .boyamaliyetiinput1').html(window.yinput2);

                    var toplaminput='';
                    var toplaminput2='';
                    var toplaminput3='';
                    var ustboyabaskikar=0;
                    if(karihesapla!=0){
                        ustboyabaskikar=sy(toplameskiveyenifiyat1)*karihesapla;
                        var toplaminput=ustboyabaskikar.toFixed(2);
                        var toplaminput='<input type="text" value="'+toplaminput+'" autocomplete="off" class="form-control" disabled><input type="hidden" name="kumaskarti[fiyatlar][]" value="'+toplaminput+'">';

                        var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
                        var toplaminput2=fiyathesaplaeur.toFixed(2);
                        var toplaminput2='<input type="text" value="'+toplaminput2+'" autocomplete="off" class="form-control" disabled>';

                        var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
                        var toplaminput3=fiyathesaplausd.toFixed(2);
                        var toplaminput3='<input type="text" value="'+toplaminput3+'" autocomplete="off" class="form-control" disabled>';

                        window.kartoplaminput=window.kartoplaminput+toplaminput;
                        window.kartoplaminput2=window.kartoplaminput2+toplaminput2;
                        window.kartoplaminput3=window.kartoplaminput3+toplaminput3;

                            //$('.boyamaliyetfiyati .tlboyamaliyetimiz td').html(window.kartoplaminput);
                            //$('.boyamaliyetfiyati .usdboyamaliyetimiz td').html(window.kartoplaminput2);
                            //$('.boyamaliyetfiyati .eurboyamaliyetimiz td').html(window.kartoplaminput3);
                            console.log("burada kardeşim - 5");
                        
                        
                    } else {
                        ustboyabaskikar=ustboyabaski;
                        var toplaminput=ustboyabaskikar;
                        var toplaminput='<input type="text" value="'+toplaminput+'" autocomplete="off" class="form-control" disabled><input type="hidden" name="kumaskarti[fiyatlar][]" value="'+toplaminput+'">';

                        var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
                        var toplaminput2=fiyathesaplaeur;
                        var toplaminput2='<input type="text" value="'+toplaminput2+'" autocomplete="off" class="form-control" disabled>';

                        var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
                        var toplaminput3=fiyathesaplausd;
                        var toplaminput3='<input type="text" value="'+toplaminput3+'" autocomplete="off" class="form-control" disabled>';

                        window.kartoplaminput=window.kartoplaminput+toplaminput;
                        window.kartoplaminput2=window.kartoplaminput2+toplaminput2;
                        window.kartoplaminput3=window.kartoplaminput3+toplaminput3;

                            //$('.boyamaliyetfiyati .tlboyamaliyetimiz td').html(window.kartoplaminput);
                            //$('.boyamaliyetfiyati .usdboyamaliyetimiz td').html(window.kartoplaminput2);
                            //$('.boyamaliyetfiyati .eurboyamaliyetimiz td').html(window.kartoplaminput3);

                            console.log("burada kardeşim - 6");

                        
                    }
                    


                    window.sayacimiz++;
                    sayac1++;
                } else {

                    console.log("burada kardeşim - 7");

                }
                boyainput++;
                //altboyadegistir2();
                //altboyahamhizmet();
                y_altboyabaskifiyat=sy(y_altboyabaskifiyat,2);
                y_altboyabaskifiresade=sy(y_altboyabaskifiresade,2);
                var altbaskitoplamdovizli=y_altboyabaskifiyat+altboyadovizsimgesi;
                $(ths).parent().parent().find(".yetkikontrol2").val(altbaskitoplamdovizli);
                $(ths).parent().parent().find(".yetkikontrolfire").val(y_altboyabaskifiresade);
                $(ths).parent().parent().find(".yetkifiyattl").val(y_altbaskibirimfiyat);

           
    });

    var selectboyatdselectlength=$(".selectboyatd select").length;
    if(selectboyatdselectlength){
        var hesaplamaselect;
        hesaplamaselect=(100)/selectboyatdselectlength;
        hesaplamaselect=(hesaplamaselect)-2;
        hesaplamaselect=hesaplamaselect+"%";
        $(".boyamaliyetiinput1 input").css("width",hesaplamaselect);
        $(".karinputlari input").css("width",hesaplamaselect);
    }
    

    //$('.boyamaliyetihepsi select').prop("disabled", false);
    //setTimeout(function(){ bolhesapla(); }, 4000);

    yenidenhesaplafiyat();
}

window.altsayac3=0;
function bitti3(sonsayac3,obj_ID){
    if(sonsayac3<=window.altsayac3){
            $('.boyamaliyetfiyati .tlboyamaliyetimiz td input').remove();
            $('.boyamaliyetfiyati .usdboyamaliyetimiz td input').remove();
            $('.boyamaliyetfiyati .eurboyamaliyetimiz td input').remove();
            altboyadegistiryeni(obj_ID);
    } else {
        siraylacalistir();
    }
}

function yenidenhesaplafiyat(ths){

    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");

    var karmiktari=0;
    var karihesapla=0;
    $('.karoranlari').each(function(kar, objkar){
        var karmiktariobj=$(objkar).val();
        if(karmiktariobj!=''){
            karmiktari=parseFloat(karmiktariobj)+karmiktari;
        }
    });
    if(karmiktari!=0){
        var karihesapla=(karmiktari+100)/100;
    }
    if(karmiktari==''){
        var karihesapla=0;
    }

    window.ytoplaminputyeni='';
    window.ytoplaminputyeni2='';
    window.ytoplaminputyeni3='';

    $('.boyamaliyetiinput1:last input[type=text]').each(function(i, objinput){
        var songelenfiyat=$(objinput).val();
        songelenfiyat=parseFloat(songelenfiyat);

        var toplaminputyeni='';
        var toplaminputyeni2='';
        var toplaminputyeni3='';
        if(karihesapla!=0){
            ustboyabaskikar=sy(songelenfiyat)*karihesapla;
            var toplaminputyeni=ustboyabaskikar.toFixed(2);
            var toplaminputyeni='<input type="text" value="'+toplaminputyeni+'" autocomplete="off" class="form-control" disabled><input type="hidden" name="kumaskarti[fiyatlar][]" value="'+toplaminputyeni+'">';
            
            var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
            var toplaminputyeni2=fiyathesaplaeur.toFixed(2);
            var toplaminputyeni2='<input type="text" value="'+toplaminputyeni2+'" autocomplete="off" class="form-control" disabled>';
            
            var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
            var toplaminputyeni3=fiyathesaplausd.toFixed(2);
            var toplaminputyeni3='<input type="text" value="'+toplaminputyeni3+'" autocomplete="off" class="form-control" disabled>';

            window.ytoplaminputyeni=window.ytoplaminputyeni+toplaminputyeni;
            window.ytoplaminputyeni2=window.ytoplaminputyeni2+toplaminputyeni3;
            window.ytoplaminputyeni3=window.ytoplaminputyeni3+toplaminputyeni2;
        } else {
            ustboyabaskikar=songelenfiyat;
            var toplaminputyeni=ustboyabaskikar;
            var toplaminputyeni='<input type="text" value="'+toplaminputyeni+'" autocomplete="off" class="form-control" disabled><input type="hidden" name="kumaskarti[fiyatlar][]" value="'+toplaminputyeni+'">';

            var fiyathesaplaeur = (ustboyabaskikar)  / manuelkureur;
            var toplaminputyeni2=fiyathesaplaeur;
            var toplaminputyeni2='<input type="text" value="'+toplaminputyeni2+'" autocomplete="off" class="form-control" disabled>';

            var fiyathesaplausd = (ustboyabaskikar) / manuelkurusd;
            var toplaminputyeni3=fiyathesaplausd;
            var toplaminputyeni3='<input type="text" value="'+toplaminputyeni3+'" autocomplete="off" class="form-control" disabled>';

            window.ytoplaminputyeni=window.ytoplaminputyeni+toplaminputyeni;
            window.ytoplaminputyeni2=window.ytoplaminputyeni2+toplaminputyeni3;
            window.ytoplaminputyeni3=window.ytoplaminputyeni3+toplaminputyeni2;
        }
    });

    $('.boyamaliyetfiyati .tlboyamaliyetimiz td').html(window.ytoplaminputyeni);
    $('.boyamaliyetfiyati .usdboyamaliyetimiz td').html(window.ytoplaminputyeni2);
    $('.boyamaliyetfiyati .eurboyamaliyetimiz td').html(window.ytoplaminputyeni3);

    



}



function boyamaliyetihizmetyansiteach(){
    var indexsayi=0;
    var ekhizmetlength=$('.ekhizmetler .ekhizmetkumas').length;
    $('.ekhizmetkumas').each(function(i2, objeach){
        var alttabloindex=$(objeach).index();
        if(indexsayi==alttabloindex){
            var obj_ID=$(".ekhizmetkumas:eq("+(alttabloindex)+") tr:eq(1)").find("select");
            setTimeout(function(){ 
                boyamaliyetihizmetyansit2(obj_ID);
            }, 2000);
        }
        indexsayi++;
    });
}









function boyamaliyetihizmetyansit2(ths){
    var select_ID = $(ths).val();
    var cekilenhamtl=$('.tpfiyattl').html();
    var cekilenhamtl2=sy(cekilenhamtl);
    var fasonorgumaliyet=cekilenhamtl;
    var cekilenhamkumastl='';
    var cekilenhamkumasindex=$(ths).parent().parent().parent().index();
    var cekilenhamkumaslength=$(ths).parent().parent().parent().parent().find("tbody").length;
    if(cekilenhamkumaslength>1){
        var cekilenhamkumastl=$(ths).parent().parent().parent().parent().find("tbody:eq("+(cekilenhamkumasindex-1)+") .tlekboyamaliyeti input").val();
    }
    if(cekilenhamkumasindex==0){
        var cekilenhamkumastl=cekilenhamtl2;
    }
    if(cekilenhamkumastl==''||cekilenhamkumastl==null){
        var cekilenhamkumastl=cekilenhamtl2;
    }
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();

    $.ajax({
        type:"POST",
        url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&boyabaskialt="+select_ID+"&fasonorgumaliyet="+fasonorgumaliyet+"&cekilenhamkumastl="+cekilenhamkumastl+"&mkurusd="+manuelkurusd+"&mkureur="+manuelkureur,
        success:function(gelensorgu){

            var select_ID = $(ths).val();
            var cekilenhamtl=$('.tpfiyattl').html();
            var cekilenhamtl2=sy(cekilenhamtl);
            var fasonorgumaliyet=cekilenhamtl;
            var cekilenhamkumastl='';
            var cekilenhamkumasindex=$(ths).parent().parent().parent().index();
            var cekilenhamkumaslength=$(ths).parent().parent().parent().parent().find("tbody").length;
            if(cekilenhamkumaslength>1){
                var cekilenhamkumastl=$(ths).parent().parent().parent().parent().find("tbody:eq("+(cekilenhamkumasindex-1)+") .tlekboyamaliyeti input").val();
            }
            if(cekilenhamkumasindex==0){
                var cekilenhamkumastl=cekilenhamtl2;
            }
            if(cekilenhamkumastl==''||cekilenhamkumastl==null){
                var cekilenhamkumastl=cekilenhamtl2;
            }
            var manuelkurusd=$(".mkurusd input").val();
            var manuelkureur=$(".mkureur input").val();
            manuelkurusd=manuelkurusd.replace(",",".");
            manuelkureur=manuelkureur.replace(",",".");
            var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();

            var boyabaskialtfiyat=gelensorgu.cevap.boyabaskialtfiyat;
            var boyabaskialtfiyat2=gelensorgu.cevap.boyabaskialtfiyat2;
            var boyabaskialtdoviz=gelensorgu.cevap.boyabaskialtdoviz;
            
            if(boyabaskialtfiyat!=null){
                $(ths).parent().parent().parent().find(".tlekboyamaliyeti input").val(boyabaskialtfiyat);
                $(ths).parent().parent().parent().find(".tlekhizmetbirim td").html(boyabaskialtfiyat2);
                $(ths).parent().parent().parent().find(".tlekhizmetdoviz td").html(boyabaskialtdoviz);

                var fiyathesaplaeur = (boyabaskialtfiyat)  / manuelkureur;
                var ornekinput2=fiyathesaplaeur.toFixed(2);
                $(ths).parent().parent().parent().find(".eurekboyamaliyeti td").html(ornekinput2);

                var fiyathesaplausd = (boyabaskialtfiyat) / manuelkurusd;
                var ornekinput3=fiyathesaplausd.toFixed(2);
                $(ths).parent().parent().parent().find(".usdekboyamaliyeti td").html(ornekinput3);


            } else{
                alert('Boya Baskı hizmetleri bulunamadı veya okumada bir sorun oluştu.');
            }
        }
    });
}




function boyamaliyetihizmetyansit(ths){
    var select_ID = $(ths).val();
    var cekilenhamtl=$('.tpfiyattl').html();
    var cekilenhamtl2=sy(cekilenhamtl);
    var fasonorgumaliyet=cekilenhamtl;
    var cekilenhamkumastl='';
    var cekilenhamkumasindex=$(ths).parent().parent().parent().index();
    var cekilenhamkumaslength=$(ths).parent().parent().parent().parent().find("tbody").length;
    if(cekilenhamkumaslength>1){
        var cekilenhamkumastl=$(ths).parent().parent().parent().parent().find("tbody:eq("+(cekilenhamkumasindex-1)+") .tlekboyamaliyeti input").val();
    }
    if(cekilenhamkumasindex==0){
        var cekilenhamkumastl=cekilenhamtl2;
    }
    if(cekilenhamkumastl==''||cekilenhamkumastl==null){
        var cekilenhamkumastl=cekilenhamtl2;
    }
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();

    $.ajax({
        type:"POST",
        url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&boyabaskialt="+select_ID+"&fasonorgumaliyet="+fasonorgumaliyet+"&cekilenhamkumastl="+cekilenhamkumastl+"&mkurusd="+manuelkurusd+"&mkureur="+manuelkureur,
        success:function(gelensorgu){
            var boyabaskialtfiyat=gelensorgu.cevap.boyabaskialtfiyat;
            var boyabaskialtfiyat2=gelensorgu.cevap.boyabaskialtfiyat2;
            var boyabaskialtdoviz=gelensorgu.cevap.boyabaskialtdoviz;
            
            if(boyabaskialtfiyat!=null){
                $(ths).parent().parent().parent().find(".tlekboyamaliyeti input").val(boyabaskialtfiyat);
                $(ths).parent().parent().parent().find(".tlekhizmetbirim td").html(boyabaskialtfiyat2);
                $(ths).parent().parent().parent().find(".tlekhizmetdoviz td").html(boyabaskialtdoviz);

                var fiyathesaplaeur = (boyabaskialtfiyat)  / manuelkureur;
                var ornekinput2=fiyathesaplaeur.toFixed(2);
                $(ths).parent().parent().parent().find(".eurekboyamaliyeti td").html(ornekinput2);

                var fiyathesaplausd = (boyabaskialtfiyat) / manuelkurusd;
                var ornekinput3=fiyathesaplausd.toFixed(2);
                $(ths).parent().parent().parent().find(".usdekboyamaliyeti td").html(ornekinput3);


                var i;
                for (i = cekilenhamkumasindex+1; i < cekilenhamkumaslength+1; i++) {
                    $('.ekhizmetler').find("tbody:eq("+(cekilenhamkumasindex+1)+")").remove();
                }

            } else{
                alert('Boya Baskı hizmetleri bulunamadı veya okumada bir sorun oluştu.');
            }
        }
    });
}

window.selectboyatdanahtar3=0;
function boyamaliyetihizmetyansityeni(ths){
    var select_ID = $(ths).val();
    if(select_ID=='0'){
        select_ID='10';
    }
    var cekilenhamtl=$('.tpfiyattl').html();
    var fasonorgumaliyet=cekilenhamtl;
    var dovizdegistirmetipi=$('.dovizdegistirme option:selected').val();
    var dovizfiyatgoster=0;
    var y_altfiyathesaplatl=0;
    var y_altfiyathesaplaeur=0;
    var y_altfiyathesaplausd=0;
    var cekilenhamkumastl='';
    var sayihamkumas=$('.ekhizmetler tbody').length;

    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var mkureurtousd=(manuelkurusd)/manuelkureur;
    var mkurusdtoeur=(manuelkureur)/manuelkurusd;

    
    if(dovizdegistirmetipi=='75'){
        var cekilenhamtl=(cekilenhamtl)*manuelkurusd;
    }
    if(dovizdegistirmetipi=='76'){
        var cekilenhamtl=(cekilenhamtl)*manuelkureur;
    }
    
    var cekilenhamtl2=sy(cekilenhamtl);

    
    var cekilenhamkumasindex=$(ths).parent().parent().parent().index();
    var cekilenhamkumaslength=$(ths).parent().parent().parent().parent().find("tbody").length;
    if(cekilenhamkumaslength>1){
        var cekilenhamkumastl=$(ths).parent().parent().parent().parent().find("tbody:eq("+(cekilenhamkumasindex-1)+") .tlekboyamaliyeti input").val();
    }
    if(cekilenhamkumasindex==0){
        var cekilenhamkumastl=cekilenhamtl2;
    }
    if(cekilenhamkumastl==''||cekilenhamkumastl==null){
        var cekilenhamkumastl=cekilenhamtl2;
    }

        boyamaliyetihizmetyansityenieach2();

    
    
    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();

    var y_altboyabaski=window.boyabaskiall[select_ID];
    var y_altboyabaskifire="";
    if(y_altboyabaski["fire"]!==null&&y_altboyabaski["fire"]!==undefined){
        y_altboyabaskifire=y_altboyabaski["fire"];
    }
    
    var y_altboyabaskifire2=sy(y_altboyabaskifire)+100;
    var y_altboyabaskifire2=sy(y_altboyabaskifire2)/100;
    var y_altboyabaskifiyat=y_altboyabaski["fiyat"];
    var y_altboyabaskinesnedoviz=y_altboyabaski["nesne_IDdoviz"];
    var y_altfiyathesaplatl=y_altboyabaskifiyat;
    
    var dovizadi='TRY';
    var dovizsimge='₺';
    if(y_altboyabaskinesnedoviz=='75'){
        var y_altfiyathesaplatl=(y_altboyabaskifiyat)*manuelkurusd;
        var y_altfiyathesaplaeur=(y_altboyabaskifiyat)*mkurusdtoeur;
        var y_altfiyathesaplausd=y_altboyabaskifiyat;
        var dovizadi='USD';
        var dovizsimge='$';
    }
    if(y_altboyabaskinesnedoviz=='76'){
        var y_altfiyathesaplatl=(y_altboyabaskifiyat)*manuelkureur;
        var y_altfiyathesaplaeur=y_altboyabaskifiyat;
        var y_altfiyathesaplausd=(y_altboyabaskifiyat)/mkureurtousd;
        var dovizadi='EUR';
        var dovizsimge='€';
    }


    var usttengelenfiyat=0;
    usttengelenfiyat=cekilenhamkumastl;
    
    usttengelenfiyat=sy(usttengelenfiyat);
    y_altfiyathesaplatl=sy(y_altfiyathesaplatl);
    dovizfiyatgoster=sy(y_altboyabaskifiyat);
    var y_altbaskitoplam=sy(usttengelenfiyat+y_altfiyathesaplatl);
    var y_altbaskitoplam2=sy(y_altbaskitoplam)*y_altboyabaskifire2;
    var y_altbaskitoplambirim=sy(y_altbaskitoplam2)-usttengelenfiyat;
    var y_altbaskitoplambirim=sy(y_altbaskitoplam2)-usttengelenfiyat;
    var y_altbaskitoplambirim=y_altbaskitoplambirim.toFixed(4);
    //var y_altboyabaskifire = y_altboyabaskifire.toFixed(0);
    y_altboyabaskifire = sy(y_altboyabaskifire,0);

    if(window.selectboyatdanahtar3==0){
        siradakisayac3++;
        window.selectboyatdanahtar3=1;
    }

    y_altboyabaskifiyat = sy(y_altboyabaskifiyat,1);
    var boyabaskialtfiyat=y_altbaskitoplam2;
    var boyabaskialtfiyat2=y_altbaskitoplambirim;
    var boyabaskialtdoviz=dovizadi;
    var dovizlifiyat=y_altboyabaskifiyat+dovizsimge;
    
    if(boyabaskialtfiyat!=null){
        $(ths).parent().parent().parent().find(".hamterbiyebirimfiyat input").val(dovizlifiyat);
        $(ths).parent().parent().parent().find(".hamterbiyefiyat input").val(y_altfiyathesaplatl);
        $(ths).parent().parent().parent().find(".hamterbiyefire input").val(y_altboyabaskifire);
        $(ths).parent().parent().parent().find(".tlekboyamaliyeti input").val(boyabaskialtfiyat);
        $(ths).parent().parent().parent().find(".tlekhizmetbirim td").html(boyabaskialtfiyat2);
        $(ths).parent().parent().parent().find(".tlekhizmetdoviz td").html(boyabaskialtdoviz);

        var fiyathesaplaeur = (boyabaskialtfiyat)  / manuelkureur;
        var ornekinput2=fiyathesaplaeur.toFixed(2);
        $(ths).parent().parent().parent().find(".eurekboyamaliyeti td").html(ornekinput2);

        var fiyathesaplausd = (boyabaskialtfiyat) / manuelkurusd;
        var ornekinput3=fiyathesaplausd.toFixed(2);
        $(ths).parent().parent().parent().find(".usdekboyamaliyeti td").html(ornekinput3);

    } 
}

function boyamaliyetihizmetyansityeni2(ths){
    var select_ID = $(ths).val();
    if(select_ID=='0'){
        select_ID='10';
    }
    var cekilenhamtl=$('.tpfiyattl').html();
    var dovizdegistirmetipi=$('.dovizdegistirme option:selected').val();
    var dovizfiyatgoster=0;
    var fasonorgumaliyet=cekilenhamtl;
    var cekilenhamkumastl='';
    var sayihamkumas=$('.selectboyatd select').length;

    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var mkureurtousd=(manuelkurusd)/manuelkureur;
    var mkurusdtoeur=(manuelkureur)/manuelkurusd;


    if(dovizdegistirmetipi=='75'){
        var cekilenhamtl=(cekilenhamtl)*manuelkurusd;
    }
    if(dovizdegistirmetipi=='76'){
        var cekilenhamtl=(cekilenhamtl)*manuelkureur;
    }
  
    var cekilenhamtl2=sy(cekilenhamtl);
    
    var cekilenhamkumasindex=$(ths).parent().parent().parent().index();
    var cekilenhamkumaslength=$(ths).parent().parent().parent().parent().find("tbody").length;
    if(cekilenhamkumaslength>1){
        var cekilenhamkumastl=$(ths).parent().parent().parent().parent().find("tbody:eq("+(cekilenhamkumasindex-1)+") .tlekboyamaliyeti input").val();
    }
    if(cekilenhamkumasindex==0){
        var cekilenhamkumastl=cekilenhamtl2;
    }
    if(cekilenhamkumastl==''||cekilenhamkumastl==null){
        var cekilenhamkumastl=cekilenhamtl2;
    }

    var cekilensonhamkumastl=$('.ekhizmetler').find("tbody:last-child .tlekboyamaliyeti input").val();

    var y_altboyabaski=window.boyabaskiall[select_ID];
    var y_altboyabaskifire="";
    if(y_altboyabaski["fire"]!==null&&y_altboyabaski["fire"]!==undefined){
        y_altboyabaskifire=y_altboyabaski["fire"];
    }
    var y_altboyabaskifire2=sy(y_altboyabaskifire)+100;
    var y_altboyabaskifire2=sy(y_altboyabaskifire2)/100;
    var y_altboyabaskifiyat=y_altboyabaski["fiyat"];
    var y_altboyabaskinesnedoviz=y_altboyabaski["nesne_IDdoviz"];
    var y_altfiyathesaplatl=y_altboyabaskifiyat;
    var y_altfiyathesaplaeur=(y_altboyabaskifiyat)*manuelkureur;
    var y_altfiyathesaplausd=(y_altboyabaskifiyat)*manuelkurusd;

    var dovizadi='TRY';
    var dovizsimge='₺';
    if(y_altboyabaskinesnedoviz=='75'){
        var y_altfiyathesaplatl=(y_altboyabaskifiyat)*manuelkurusd;
        var y_altfiyathesaplaeur=(y_altboyabaskifiyat)*mkurusdtoeur;
        var y_altfiyathesaplausd=y_altboyabaskifiyat;
        var dovizadi='USD';
        var dovizsimge='$';
    }
    if(y_altboyabaskinesnedoviz=='76'){
        var y_altfiyathesaplatl=(y_altboyabaskifiyat)*manuelkureur;
        var y_altfiyathesaplaeur=y_altboyabaskifiyat;
        var y_altfiyathesaplausd=(y_altboyabaskifiyat)/mkureurtousd;
        var dovizadi='EUR';
        var dovizsimge='€';
    }


    var usttengelenfiyat=0;
    usttengelenfiyat=cekilenhamkumastl;
    if(y_altbaskitoplam==''||y_altbaskitoplam==0||y_altbaskitoplam==undefined||y_altbaskitoplam==null){
        y_altbaskitoplam=cekilenhamkumastl;
        $(ths).parent().parent().parent().find(".tlekboyamaliyeti input").val(cekilenhamkumastl);
    }
    usttengelenfiyat=sy(usttengelenfiyat);
    y_altfiyathesaplatl=sy(y_altfiyathesaplatl);
    dovizfiyatgoster=sy(y_altboyabaskifiyat);
    var y_altbaskitoplam=sy(usttengelenfiyat+y_altfiyathesaplatl);
    var y_altbaskitoplam2=sy(y_altbaskitoplam)*y_altboyabaskifire2;
    var y_altbaskitoplambirim=sy(y_altbaskitoplam2)-usttengelenfiyat;
    var y_altbaskitoplambirim=sy(y_altbaskitoplam2)-usttengelenfiyat;
    var y_altbaskitoplambirim=y_altbaskitoplambirim.toFixed(4);
    //var y_altboyabaskifire = y_altboyabaskifire.toFixed(0);
    y_altboyabaskifire = sy(y_altboyabaskifire,0);

    if(window.selectboyatdanahtar3==0){
        siradakisayac3++;
        window.selectboyatdanahtar3=1;
    }

    y_altboyabaskifiyat = sy(y_altboyabaskifiyat,1);
    var dovizlifiyat=y_altboyabaskifiyat+dovizsimge;

    
    var boyabaskialtfiyat=y_altbaskitoplam2;
    var boyabaskialtfiyat2=y_altbaskitoplambirim;
    var boyabaskialtdoviz=dovizadi;
    
    if(boyabaskialtfiyat!=null){
        $(ths).parent().parent().parent().find(".hamterbiyebirimfiyat input").val(dovizlifiyat);
        $(ths).parent().parent().parent().find(".hamterbiyefiyat input").val(y_altfiyathesaplatl);
        $(ths).parent().parent().parent().find(".hamterbiyefire input").val(y_altboyabaskifire);
        $(ths).parent().parent().parent().find(".tlekboyamaliyeti input").val(boyabaskialtfiyat);
        $(ths).parent().parent().parent().find(".tlekhizmetbirim td").html(boyabaskialtfiyat2);
        $(ths).parent().parent().parent().find(".tlekhizmetdoviz td").html(boyabaskialtdoviz);

        var fiyathesaplaeur = (boyabaskialtfiyat)  / manuelkureur;
        var ornekinput2=fiyathesaplaeur.toFixed(2);
        $(ths).parent().parent().parent().find(".eurekboyamaliyeti td").html(ornekinput2);

        var fiyathesaplausd = (boyabaskialtfiyat) / manuelkurusd;
        var ornekinput3=fiyathesaplausd.toFixed(2);
        $(ths).parent().parent().parent().find(".usdekboyamaliyeti td").html(ornekinput3);

    } 
}


function boyamaliyetihizmetyansityenieach(){
    var indexsayi3=0;
    var ekhizmetlerlength=$('.ekhizmetler tbody').length;
    $('.ekhizmetler tbody').each(function(i2, objeach){
        var alttabloindex=$(objeach).index();
        if(indexsayi3==alttabloindex){
            var obj_ID=$(".ekhizmetler tbody:eq("+alttabloindex+")").find("select");
            window.obj_ID=obj_ID;
            boyamaliyetihizmetyansityeni(obj_ID)
        }
        indexsayi3++;
    });
}

function boyamaliyetihizmetyansityenieach2(){
    var indexsayi3=0;
    var ekhizmetlerlength=$('.ekhizmetler tbody').length;
    $('.ekhizmetler tbody').each(function(i2, objeach){
        var alttabloindex=$(objeach).index();
        if(indexsayi3==alttabloindex){
            var obj_ID=$(".ekhizmetler tbody:eq("+alttabloindex+")").find("select");
            window.obj_ID=obj_ID;
            boyamaliyetihizmetyansityeni2(obj_ID)
        }
        indexsayi3++;
    });
    siraylacalistir2();

}

var siradakisayac3=2;
var islemdekisayac3=-1;
var siraylacalistirsayac3=0;
function siraylacalistir3(){
    console.log("SIRAYLA ÇALIŞTIR 3");
    var ekhizmetlerlength=$('.ekhizmetler tbody').length;
    $.ajax({
        type:"POST",
        url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu",
        success:function(gelensorgu){

            boyamaliyetihizmetyansityenieach();
            
            if(siraylacalistirsayac3<ekhizmetlerlength){
                siraylacalistirsayac3++;
                siraylacalistir3();
            } else {
                siraylacalistirsayac3=0;
                var siradakisayac3=2;
                var islemdekisayac3=-1;
            }

        }
    });
    var selectboyatdselectlength=$(".selectboyatd select").length;
    if(selectboyatdselectlength){
        var hesaplamaselect;
        hesaplamaselect=(100)/selectboyatdselectlength;
        hesaplamaselect=(hesaplamaselect)-2;
        hesaplamaselect=hesaplamaselect+"%";
        $(".boyamaliyetiinput1 input").css("width",hesaplamaselect);
        $(".karinputlari input").css("width",hesaplamaselect);
    }
}

function altboyahamhizmet(ths){
    /*
    var option='';
    var input='';
    var ustboyabaski='';
    var hamhizmet=0;

    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var degertd=1;

    $('.boyamaliyetlerimiz').each(function(i2, obj2){
    var boyabaski_ID = $(obj2).find("select option:selected").val();
    var boyatext = $(obj2).find("select option:selected").text();
    var cekilenhamfasonorgumaliyeti=$('.fasorgumaliyet').val();
    cekilenhamfasonorgumaliyeti=cekilenhamfasonorgumaliyeti.replace(",",".");
    var cekilenhamtl=$('.tpfiyattl').html();
    var fasonorgumaliyet=cekilenhamtl;
    var selectboyatdlength=$('.selectboyatd select').length;
    
    var hamhizmet=0;
    window.hamhizmet=0;
    $('.selectboyatd select').each(function(i, obj){
        var iplik_ID = $(obj).find("option:selected").val();
        var input='';
        $.ajax({
            type:"POST",
            url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&ustboyabaski="+iplik_ID+"&altboyabaski="+boyabaski_ID+"&fasonorgumaliyet="+fasonorgumaliyet+"&cekilenfasonorgu"+cekilenhamfasonorgumaliyeti,
            success:function(gelensorgu){
                var hamhizmet=gelensorgu.cevap.hamhizmet;
                window.hamhizmet=window.hamhizmet+hamhizmet;
                var sanalveri='<input type="text" value="'+window.hamhizmet.toFixed(2)+'" autocomplete="off" name="ekhizmet" disabled="disabled">';
                //$('.tlekboyamaliyeti td').html(sanalveri);
            
                var fiyathesaplaeur = (window.hamhizmet)  / manuelkureur;
                var ornekinput2='<input type="text" value="'+fiyathesaplaeur.toFixed(2)+'" autocomplete="off" name="ekhizmet" disabled="disabled">';
                //$('.eurekboyamaliyeti td').html(ornekinput2);

                var fiyathesaplausd = (window.hamhizmet) / manuelkurusd;
                var ornekinput3='<input type="text" value="'+fiyathesaplausd.toFixed(2)+'" autocomplete="off" name="ekhizmet" disabled="disabled">';
                //$('.usdekboyamaliyeti td').html(ornekinput3);

                window.altsayac2++;
                //bitti2(selectboyatdlength,hamhizmet);
            }
        });
    });
    
    });
    */
}



function altboyadegistir2(ths){
    var option='';
    var input='';
    var ustboyabaski='';
    $('.altboyabaskilar').remove();

    $('.boyamaliyetlerimiz').each(function(i2, obj5){
    window.altsayac=0;
    var boyabaski_ID = $(obj5).find("select option:selected").val();
    var boyatext = $(obj5).find("select option:selected").text();
    var cekilenhamfasonorgumaliyeti=$('.fasorgumaliyet').val();
    if(cekilenhamfasonorgumaliyeti){
        cekilenhamfasonorgumaliyeti=cekilenhamfasonorgumaliyeti.replace(",",".");
    }
    var cekilenhamtl=$('.tpfiyattl').html();
    var fasonorgumaliyet=cekilenhamtl;
    window.altbaskitext='';
    $('.boyamaliyetihepsi select').prop("disabled", true);

    var selectboyatdlength=$('.selectboyatd select').length;
    
    $('.selectboyatd select').each(function(i, obj6){
        var iplik_ID = $(obj6).find("option:selected").val();
        var input='';
        $.ajax({
            type:"POST",
            url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&ustboyabaski="+iplik_ID+"&altboyabaski="+boyabaski_ID+"&fasonorgumaliyet="+fasonorgumaliyet+"&cekilenfasonorgu"+cekilenhamfasonorgumaliyeti,
            success:function(gelensorgu){
                var altbaskitoplam=gelensorgu.cevap.altbaskitoplam;
                var altbaskitoplam = altbaskitoplam.toFixed(2);
                /*
                if(altbaskitoplam!=null){
                    window.altbaskitex='<div style="text:align:left;>'+altbaskitoplam+'</div>';
                }*/
                window.altsayac++;
                //bitti(selectboyatdlength,boyabaski_ID,boyatext);
                $('.altboyabaski'+boyabaski_ID).remove();
                //var sanalalt='<tr class="altboyabaskilar altboyabaski'+boyabaski_ID+'"><th colspan="2">'+boyatext+'</th><td class="altboyabaskitext">'+window.altbaskitext+'</td></tr>';
                var sanalalt='<tr class="altboyabaskilar altboyabaski'+boyabaski_ID+'"><th colspan="2">'+boyatext+'</th><td class="altboyabaskitext">'+altbaskitoplam+'</td></tr>';
                $(".mamulboyamaliyeti").before(sanalalt);
            }
        });
    });



    
   

    $('.boyamaliyetihepsi select').prop("disabled", false);
    setTimeout(function(){ bolhesapla(); }, 1000);
    
    
    });
}



<?php if(z(8,'a')=='duzenle'||!empty($farkli)){ ?>
    $(document).ready(function(){
        //setTimeout(function(){ siraylacalistir3(); }, 1500);
        //setTimeout(function(){ siraylacalistir3(); }, 2000);
        //setTimeout(function(){ bolhesapla(); }, 1000);
        //setTimeout(function(){ altboyahamhizmet(); }, 6000);
        //setTimeout(function(){ siraylacalistir(); }, 4500);
        //setTimeout(function(){ boyamaliyetihizmetyansityenieach();  }, 2000);
        //setTimeout(function(){ boyamaliyetiyansiteach(); }, 2000);
    });
<?php } ?>


function boyadegisimi(ths){
    var boya_ID = $(ths).val();
    var namehazirla="kumaskarti[boyamaliyet]["+boya_ID+"][]";
    var selectclass = $(ths).parent().attr("class");
    var trclass = $(ths).parent().parent().attr("class");
    var degisenselect=selectclass.replace("select", "input");
    var degisentr=trclass.replace("select", "input");
    $('.'+degisentr+' .'+degisenselect+' input').attr("name",namehazirla);
}


function bolhesapla(ths){
    /*/
    $('.tlboyamaliyeti td').html('&nbsp;');
    $('.eurboyamaliyeti td').html('&nbsp;');
    $('.usdboyamaliyeti td').html('&nbsp;');
    var manuelkurusd=$(".mkurusd input").val();
    var manuelkureur=$(".mkureur input").val();
    manuelkurusd=manuelkurusd.replace(",",".");
    manuelkureur=manuelkureur.replace(",",".");
    var degertd=1;


        var i;
        for (i = 0; i < 14; i++) {
            var iplikfiyat=0;
            $('.boyainput'+i).each(function(i, obj){
                var iplikfiyatcek=sy($(obj).val());
                iplikfiyat=sy(iplikfiyat+iplikfiyatcek);
            });
            if(iplikfiyat!=0){
                var ornekinput='<input type="text" value="'+iplikfiyat.toFixed(2)+'" autocomplete="off" name="kumasci" disabled="disabled">';
                $('.tlboyamaliyeti td').append(ornekinput);
            
                var fiyathesaplaeur = (iplikfiyat)  / manuelkureur;
                var ornekinput2='<input type="text" value="'+fiyathesaplaeur.toFixed(2)+'" autocomplete="off" name="kumasci" disabled="disabled">';
                $('.eurboyamaliyeti td').append(ornekinput2);

                var fiyathesaplausd = (iplikfiyat) / manuelkurusd;
                var ornekinput3='<input type="text" value="'+fiyathesaplausd.toFixed(2)+'" autocomplete="off" name="kumasci" disabled="disabled">';
                $('.usdboyamaliyeti td').append(ornekinput3);
            }
        }

        /*/

}

function iplikdegisimsonrasi(ths){
    boyamaliyetihizmetyansityenieach();
}



</script>

<?php 
$farkli=z(8,'farkli');
if(!empty($farkli)){
    $_X=z(1,$farkli,'',$tbl);
}
?>
<tr><th>Kumaş Kodu</th><td><input type="text" name="<?php echo $tbl?>[kodu]" value="<?php echo !empty($_X['kodu'])?$_X['kodu']:''?>" autocomplete="off" class="1kumaskodu form-control"></td></tr>
<tr><th>Kumaş İsmi</th><td><input type="text" name="<?php echo $tbl?>[ismi]" value="<?php echo !empty($_X['ismi'])?$_X['ismi']:''?>" autocomplete="off" class="1kumasismi form-control"></td></tr>
<input type="hidden" name="<?php echo $tbl?>[nesne_IDkumasTipi]" value="175">
<tr>
    <th>Article</th><td>
    <input type="text" class="form-control" name="<?php echo $tbl?>[article]" value="<?php echo (!empty($_X['article'])?$_X['article']:''); ?>">
</tr>
<?php
$metinhazirla='';
$iplikkartlarimetin="";
$iplikkartlarimetin2="";
$kompozisyonarray=array();
if(!empty($_X['iplikkartlari'])){
    $_Nesne=z(37,z(1,"WHERE ad='' OR ad='iplikkartTipi' OR ad='elyafTipi' OR ad='doviz' OR ad='uretimTipi' OR ad='boyaKontrol' OR ad='dovizfason' ",'ID,ad,metin1,metin2','nesne'));
	$iplikkartlaricek=$_X['iplikkartlari'];
	$iplikkartlariarray=(!empty($_X['iplikkartlari'])?json_decode($_X['iplikkartlari'],1):'');
	if(!empty($iplikkartlariarray)){
		$iplikkartlariarray=str_replace('puan','',$iplikkartlariarray);
    }
	if(!empty($iplikkartlariarray)){
		foreach($iplikkartlariarray as $i => $elyf){
			$iplikokuma=z(1,$i,'','iplik');
			$iplikkarti=(!empty($_Nesne[$iplikokuma['nesne_IDiplikkartTipi']]['metin1'])?$_Nesne[$iplikokuma['nesne_IDiplikkartTipi']]['metin1']:'');
			$uretimTipi=(!empty($_Nesne[$iplikokuma['nesne_IDuretimTipi']]['metin1'])?$_Nesne[$iplikokuma['nesne_IDuretimTipi']]['metin1']:'&nbsp;');
			$boyaKontrol=(!empty($_Nesne[$iplikokuma['nesne_IDboyaKontrol']]['metin1'])?$_Nesne[$iplikokuma['nesne_IDboyaKontrol']]['metin1']:'&nbsp;');
			$elyafTipi=(!empty($_Nesne[$i]['metin1'])?$_Nesne[$i]['metin1']:'&nbsp;');
			$iplikkartlarimetin=(!empty($elyf)?'%'.$elyf:''); 
			$elyafmetin="";
			if(!empty($iplikokuma['elyaf'])){
				$elyafarray=(!empty($iplikokuma['elyaf'])?json_decode($iplikokuma['elyaf'],1):'');
				if(!empty($elyafarray)){
					$elyafarray=str_replace('puan','',$elyafarray);
				}
				if(!empty($elyafarray)){ foreach($elyafarray as $el => $elyfb){
					$elyafnesne=(!empty($_Nesne[$el]['metin1'])?$_Nesne[$el]['metin1']:'&nbsp;');
					$elyfbhesapla=($elyfb/100)*$elyf;
					$elyfbhesapla=number_format($elyfbhesapla);
					$elyafmetin.='%'.$elyfbhesapla.' '.$elyafnesne.' ';
					if(!empty($kompozisyonarray[$elyafnesne])){
						$eskihesaplama=$kompozisyonarray[$elyafnesne];
						$yenihesaplama=($eskihesaplama+$elyfbhesapla);
						$kompozisyonarray[$elyafnesne]=$yenihesaplama;
					} else {
						$kompozisyonarray[$elyafnesne]=$elyfbhesapla;
					}
				} }
			}
			
			$elyafmetinekle=(!empty($boyaKontrol)&&!empty($elyafmetin)?' || ':' ').$elyafmetin;
			$iplikkart=$iplikkarti.(!empty($iplikkarti)&&!empty($uretimTipi)?' || ':' ').$uretimTipi.(!empty($uretimTipi)&&!empty($boyaKontrol)?' || ':' ').$boyaKontrol.$elyafmetinekle;
			//$iplikkartlarimetin2.=$iplikkart.' <br> ';
			$iplikkartlarimetin2.=$elyafmetin.' <br> ';
		} 
	}  
}
$kompmetin='';
if(!empty($kompozisyonarray)){
	foreach ($kompozisyonarray as $karray => $kompozisyon2) {
		$kompmetin.='%'.$kompozisyon2.' '.$karray.' ';
	}
}
?>
<tr class="kompozisyon">
<th>Anlık Kompozisyon</th>
<td class="kompozisyontd"><input value="<?php echo $kompmetin; ?>" disabled="disabled" class="form-control" style="color:black;"></td>
</tr>
<tr>
    <th>Makina Türü</th>
    <td>
    <?php echo select(Array('name'=>$tbl.'[makinacesitleri_ID]','detay'=>' class="select2 select-search" id="makinacesidi" onchange="iplikdegisimkur()" ','t'=>'makinacesitleri','alan'=>'ID,ad','ayrac'=>' /// ','sd'=>"",'icerik'=>'<option value="">Seçiniz</option>','sec'=>!empty($_X['makinacesitleri_ID'])?$_X['makinacesitleri_ID']:0)); ?>
    </td>
</tr>
<tr>
    <th>Kumaş Türü</th>
    <td>
    <?php
    $sorgukumas="WHERE arsiv='0'";
    if(!empty($_X['makinacesitleri_ID'])){
        $sorgukumas="WHERE arsiv='0' AND makinacesitleri_ID='".$_X['makinacesitleri_ID']."'";
    }
    $kumasturlerinicek=z(1,$sorgukumas,'ID,ad,pusvefayn,makinacesitleri_ID','kumasturu');
    ?>
    <select name="<?php echo $tbl; ?>[kumasturu_ID]" id="kumasturu" class="select2 select-search" onchange="iplikdegisimkur()">
    <option value="0">Seçiniz</option>
    <?php if(!empty($kumasturlerinicek)){ foreach($kumasturlerinicek as $kturcek){ ?>
        <?php $kumasveritopla=(!empty($kturcek['ad'])?$kturcek['ad']:' '); ?>
        <?php
        if(!empty($kturcek['makinacesitleri_ID'])){
            $kumasadi=(!empty($kturcek['ad'])?$kturcek['ad']:' ');
            $kumaspusvefayn=(!empty($kturcek['pusvefayn'])?$kturcek['pusvefayn']:' ');
            $makinecesitlerinioku=z(1,$kturcek['makinacesitleri_ID'],'ID,pus,fayn','makinacesitleri');
            $makinepus=(!empty($makinecesitlerinioku['pus'])?json_decode($makinecesitlerinioku['pus'],1):0);
            $makinefayn=(!empty($makinecesitlerinioku['fayn'])?json_decode($makinecesitlerinioku['fayn'],1):0);
            $makinesayi=count($makinepus);
            $pusmakine='';
            if(!empty($kumaspusvefayn)){
                $pusmakine=$makinepus[$kumaspusvefayn][0];
            }
            $faynmakine='';
            if(!empty($kumaspusvefayn)){
                $faynmakine=$makinefayn[$kumaspusvefayn][0];
            }
            //$kumasveritopla = $kumasadi.' '.$pusmakine.' / '.$faynmakine;
            $kumasveritopla = $kumasadi;
        }
        ?>
        <option value="<?php echo $kturcek['ID']; ?>" <?php if(!empty($_X['kumasturu_ID'])&&$_X['kumasturu_ID']==$kturcek['ID']){ echo 'selected'; } ?>><?php echo (!empty($kumasveritopla)?$kumasveritopla:''); ?></option>
    <?php } } ?>
    </select> 
    </td>
</tr>
<?php
$pusvefaynmetni='';
$pusvefaynmetni2='';
$kumaspusvefayn=0;
$kumaspusvefaynaciken=0;
$pusvefaynjson=array();
$pusvefaynacikenjson=array();
if(z(8,'a')=='duzenle'||!empty($farkli)){
    if($_X['kumasturu_ID']){
        $kumasturu2=z(1,$_X['kumasturu_ID'],'','kumasturu');
        $kumaspusvefayn=(!empty($_X['pusvefayn'])?$_X['pusvefayn']:0);
        $kumaspusvefaynaciken=(!empty($_X['pusvefaynaciken'])?$_X['pusvefaynaciken']:0);
    }
    if($_X['makinacesitleri_ID']){
        $makinecesitlerinioku=z(1,$_X['makinacesitleri_ID'],'','makinacesitleri');
        $makinepus=(!empty($makinecesitlerinioku['pus'])?json_decode($makinecesitlerinioku['pus'],1):0);
        $makinefayn=(!empty($makinecesitlerinioku['fayn'])?json_decode($makinecesitlerinioku['fayn'],1):0);
        $makinesayi=count($makinepus);
        $makinedegeriarray=(!empty($makinecesitlerinioku['makineyetenegi'])?json_decode($makinecesitlerinioku['makineyetenegi'],1):'');
        $makineislevi=(!empty($kumasturu2['nesne_IDmakineYetenegi'])?$kumasturu2['nesne_IDmakineYetenegi']:'');
        $makinedonguid='';
        
        $makinedegerleri=array();
        $makinedegerleri2=array();
        if(!empty($makinedegeriarray)){
            foreach ($makinedegeriarray as $mkd => $makinedegeri) {
                $nesneoku=z(1,$makinedegeri,'','nesne');
                $nesnemetin1=(!empty($nesneoku['metin1'])?$nesneoku['metin1']:'');
                $nesnemetinid=(!empty($nesneoku['ID'])?$nesneoku['ID']:$mkd);
                $makinedegerleri[$nesnemetinid]=$nesnemetin1;
                if(!empty($makineislevi)){
                    if($makineislevi==$nesnemetinid){
                        $makinedonguid=$mkd;
                    }
                }
            }
        }

        if(!empty($makinedonguid)){
            $makinedongupus=$makinepus[$makinedonguid];
            $makinedongufayn=$makinefayn[$makinedonguid];
        }

        $pusvefaynmetni2='';
        $pusvefaynsayi=0;
        if(!empty($kumaspusvefayn)){
            $kumaspusvefayn=(!empty($kumaspusvefayn)?json_decode($kumaspusvefayn,1):'');
        }
        
        if(!empty($kumaspusvefayn)){
            foreach($kumaspusvefayn as $pf => $pfarray){
                $pusvefaynsayi=$pfarray;
                if(!empty($makinedongupus[$pf])){
                    $pusvefaynmetni2=' Pus: '.$makinedongupus[$pf];
                }
                if(!empty($makinedongufayn[$pf])){
                    $pusvefaynmetni2.=' Fayn: '.$makinedongufayn[$pf];

                }
                $pusvefayncheck=(!empty($pfarray[0])?$pfarray[0]:'');
                $pusvefayndeger=(!empty($pfarray[1])?$pfarray[1]:$pfarray[0]);
               
                $pusvefaynjson[$pf]['pusvefayn']=$pusvefaynmetni2;
                $pusvefaynjson[$pf]['deger']=$pusvefayndeger;
                $pusvefaynjson[$pf]['check']=$pusvefayncheck;
            }
        }

        if(!empty($kumaspusvefaynaciken)){
            $kumaspusvefaynaciken=(!empty($kumaspusvefaynaciken)?json_decode($kumaspusvefaynaciken,1):'');
            foreach($kumaspusvefaynaciken as $pf2 => $pfarray2){
                $pusvefaynsayi=$pfarray2;
                if(!empty($makinedongupus[$pf2])){
                    $pusvefaynmetni2=' Pus: '.$makinedongupus[$pf2];
                }
                if(!empty($makinedongufayn[$pf2])){
                    $pusvefaynmetni2.=' Fayn: '.$makinedongufayn[$pf2];

                }
                $pusvefayncheck=(!empty($pfarray2[0])?$pfarray2[0]:'');
                $pusvefayndeger=(!empty($pfarray2[1])?$pfarray2[1]:$pfarray2[0]);

                //$pusvefaynacikenjson[$pf2]['pusvefayn']=$pusvefaynmetni2;
                $pusvefaynacikenjson[$pf2]['deger']=$pusvefayndeger;
            }
        }

    }
}
?>
<?php 
$kumasturufasonmaliyet='';
$kumasturunesnedoviz='';
if(!empty($_X['kumasturu_ID'])){
    $kumasturucekmek=z(1,$_X['kumasturu_ID'],'ID,nesne_IDdoviz,fasonmaliyet','kumasturu');
    $_Nesnedoviz=z(37,z(1,"WHERE ad='' OR ad='doviz'",'ID,ad,metin1,metin2','nesne'));
    $kumasturufasonmaliyet=(!empty($kumasturucekmek['fasonmaliyet'])?$kumasturucekmek['fasonmaliyet']:'');
    $kumasturunesnedoviz=(!empty($kumasturucekmek['nesne_IDdoviz'])?$kumasturucekmek['nesne_IDdoviz']:'');
    $kumasturunesnedoviz=(!empty($_Nesnedoviz[$kumasturunesnedoviz]['metin2'])?$_Nesnedoviz[$kumasturunesnedoviz]['metin2']:'&nbsp;');
}
?>
<tr>
    <th>Fason Örgü Maliyeti / Manuel Maliyeti</th>
    <td>
        <input type="text" class="form-control fasorgumaliyet" name="<?php echo $tbl?>[fasonmaliyet]" class="fasonorgumaliyeti" value="<?php echo !empty($kumasturufasonmaliyet)?$kumasturufasonmaliyet:''; ?>" autocomplete="off" disabled="disabled" style="display:inline-flex;float:left;width:20%;">
        <input type="hidden" name="<?php echo $tbl?>[fasonmaliyet]" value="<?php echo !empty($kumasturufasonmaliyet)?$kumasturufasonmaliyet:''?>" autocomplete="off">
        <div class="fasondoviz" style="float:left;margin:4px;font-weight:bold;"><?php echo !empty($kumasturunesnedoviz)?$kumasturunesnedoviz:''?></div>
        <div class="fasonorgumaliyetii2" style="display:inline-flex;">
            <input type="text" name="<?php echo $tbl?>[fasonmaliyet2]" class="fasonorgumaliyeti2 form-control" value="<?php echo !empty($_X['fasonmaliyet2'])?$_X['fasonmaliyet2']:''?>" onkeyup="iplikdegisimkur()" autocomplete="off">
            <?php if(!empty($_NSN4))foreach($_NSN4 as $ad=>$n){?><?php echo select(Array('name'=>$tbl.'[nesne_IDdovizfason]','detay'=>'class="nesneSlc_dovizfason fasondoviz2 form-control" onchange="iplikdegisimkur()"','t'=>'nesne','alan'=>'ID,'.$n['alan'],'sd'=>"WHERE ad='".$ad."'",'icerik'=>'<option value="">Döviz Kuru</option>','sec'=>!empty($_X['nesne_IDdovizfason'])?$_X['nesne_IDdovizfason']:substr(z('date'),0,7)))?>
        </div>
    </td>
</tr>
<tr><th>Gr/m</th><td><input type="text" name="<?php echo $tbl?>[grm]" class="form-control" value="<?php echo !empty($_X['grm'])?$_X['grm']:''?>" autocomplete="off"></td></tr>
        <?php }?>
<tr><th>Birim Seçiniz</th>
<td>
<select name="<?php echo $tbl; ?>[birimTipi]" class="birimtipi form-control">
    <option value="0">Birim Seçiniz</option>
    <option value="1" <?php echo (!empty($_X['birimTipi'])&&$_X['birimTipi']=='1'?'selected':''); ?>>kg</option>
    <option value="2" <?php echo (!empty($_X['birimTipi'])&&$_X['birimTipi']=='2'?'selected':''); ?>>m</option>
</select>
</td>
</tr>

<tr><th>Kumaş Eni Tipi Seçiniz</th>
<td>
<select name="<?php echo $tbl; ?>[enTipi]" class="enTipi form-control">
    <option value="0">En Tipi Seçiniz</option>
    <option value="1" <?php echo (!empty($_X['enTipi'])&&$_X['enTipi']=='1'?'selected':''); ?>>Tüp</option>
    <option value="2" <?php echo (!empty($_X['enTipi'])&&$_X['enTipi']=='2'?'selected':''); ?>>Açık En</option>
</select>
</td>
</tr>
<?php
$_NesneDoviz=z(37,z(1,"WHERE ad='doviz'",'ID,ad,metin1,metin2','nesne'));
?>
<tr style="display:none;">
    <th><b>Hesaplamada kullanılmak istenen döviz cinsi:</b></th>
    <td class="mkurdovizcinsi" colspan="2">
        <?php if(!empty($_NSN2))foreach($_NSN2 as $ad=>$n){?><?php echo select(Array('name'=>$tbl.'[nesne_ID'.$ad.']','detay'=>'class="nesneSlc_'.$ad.' dovizdegistir form-control" onchange="iplikdegisimkur(this)" ','t'=>'nesne','alan'=>'ID,'.$n['alan'],'sd'=>"WHERE ad='".$ad."'",'icerik'=>'<option value="">Seçiniz</option><option value="yeni">**YENİ**</option>','sec'=>!empty($_X['nesne_ID'.$ad])?$_X['nesne_ID'.$ad]:substr(z('date'),0,7)))?>
        <?php }?>
    </td>
</tr>

</tbody>
</table>
</div>
<div class="blok" style="float:left;width:100%;margin:0;border:none;background: #e0e0e0;margin-top: 20px;">
<table cellpadding="0" cellspacing="0" class="table table-hover tablopusvefayn" style="background: #eeeeee;float: left;width: 32%;margin-right: 3%;border: 1px solid #ddd;">
<tbody class="pusvefayntbody">
<tr>
    <th>Pus/Fayn</th>
    <th>Kumaş Eni</th>
</tr>
<?php if(!empty($pusvefaynjson)){ foreach ($pusvefaynjson as $pfj => $pfjson) { ?>

<tr class="pusvefayn pusvefayntr">
    <td>
        <?php
        if(!empty($_X['pusvefayn'])){
            $kumaskartipusvefayn=(!empty($_X['pusvefayn'])?json_decode($_X['pusvefayn'],1):'');
        }
        $pfjbilgisi='';
        if(!empty($pfjson['pusvefayn'])){
            $pfjbilgisi=(!empty($pfjson['pusvefayn'])?$pfjson['pusvefayn']:'');
            $pfjbilgisi=str_replace("Pus:","",$pfjbilgisi);
            $pfjbilgisi=str_replace("Fayn:","/",$pfjbilgisi);
        }    
        ?>
        <label for="fname<?php echo (!empty($pfj)?$pfj:'0'); ?>" class="labelimiz"> <?php echo (!empty($pfjbilgisi)?$pfjbilgisi:''); ?></label>
        <input type="checkbox" id="fname<?php echo (!empty($pfj)?$pfj:'0'); ?>" name="kumaskarti[pusvefayn][<?php echo (!empty($pfj)?$pfj:'0'); ?>][]" <?php echo (!empty($pfjson['check'])&&$pfjson['check']=='on'?'checked':''); ?>>
    </td>
    <td class="kumaseni">
        <span>EN: </span><input type="text" value="<?php echo (!empty($pfjson['deger'])?$pfjson['deger']:''); ?>" name="kumaskarti[pusvefayn][<?php echo (!empty($pfj)?$pfj:'0'); ?>][]" autocomplete="off" class="form-control"><span> cm</span><br>
    </td>
</tr>
<?php } } ?>

</tbody>
</table>
<table cellpadding="0" cellspacing="0" class="table table-hover resimtablo" style="background: #eeeeee;float: left;width: 65%;border: 1px solid #ddd;">
<tbody>
<tr>
    <th>Resim</th>
</tr>
<tr>
<?php if(z(8,'a')=='ekle'){ ?>
        <td style="width:auto;">
        <input type="file" class="form-control" name="<?php echo $tbl; ?>[img][]" accept="image/x-png,image/gif,image/jpeg" style="position: relative; width:100%; left: 0px; visibility:visible;" multiple="multiple">
        <?php $galericek=z(1,array('arsiv'=>0,'tablo'=>$tbl,'tablo_ID'=>$idmiz),'ID,img','galeri'); ?>
        <?php if($galericek){
        //$imgarray=(!empty($_X['img'])?json_decode($_X['img'],1):'');
        foreach ($galericek as $gl => $galeri) {
        ?>
        <div style="float:left;">
            <img data-fancybox="gallery1" href="upload/kumaskarti/<?php echo $galeri['img']; ?>" src="upload/kumaskarti/<?php echo $galeri['img']; ?>" style="width:100px; height:100px; padding:5px; cursor:pointer;">
            <span class="spanisim"><?php echo $galeri['img']; ?></span>
            <a href="#resimsil" class="resimsil" onclick="resimsil(this)">Kalıcı olarak sil</a>
            <input type="hidden" name="neonemivar" value="<?php echo $galeri['ID']; ?>">
        </div>
        <?php } } ?>
        <br>
        <b>Ek açıklama</b>
        <input type="text" class="form-control" name="<?php echo $tbl; ?>[imgtext]" value="<?php echo !empty($_X['imgtext'])?$_X['imgtext']:''?>"  autocomplete="off" style="position: relative; width:100%; left: 0px; visibility:visible;">
        </td>
<?php } ?>
<?php $idmiz=(!empty($farkli)?$farkli:$idmiz); if(z(8,'a')=='duzenle'){ ?>
  
        <td style="width:auto;" class="resimlerinyeri">
        <input type="file" class="form-control" id="resimfile" name="<?php echo $tbl; ?>[img][]" accept="image/x-png,image/gif,image/jpeg" style="position: relative; width:100%; left: 0px; visibility:visible;" multiple="multiple">
        <a href="#yuklemebaslat" class="yuklemebaslat">Yüklemeyi Başlat)</a>
        <div class="fotoyutopla">
        <?php $galericek=z(1,array('arsiv'=>0,'tablo'=>$tbl,'tablo_ID'=>$idmiz),'ID,img','galeri'); ?>
        <?php if($galericek){
        //$imgarray=(!empty($_X['img'])?json_decode($_X['img'],1):'');
        foreach ($galericek as $gl => $galeri) {
        ?>
        <div style="float:left;">
            <img data-fancybox="gallery1" href="upload/kumaskarti/<?php echo $galeri['img']; ?>" src="upload/kumaskarti/<?php echo $galeri['img']; ?>" style="width:100px; height:100px; padding:5px; cursor:pointer;">
            <span class="spanisim"><?php echo $galeri['img']; ?></span>
            <a href="#resimsil" class="resimsil" onclick="resimsil(this)">Kalıcı olarak sil</a>
            <input type="hidden" name="neonemivar" value="<?php echo $galeri['ID']; ?>">
        </div>
        <?php } } ?>
        <div class="resimekaciklama"></div> 

        </div>
        <br>
        <b style="float:left;">Ek açıklama</b>
        <input type="text" class="form-control" name="<?php echo $tbl; ?>[imgtext]" value="<?php echo !empty($_X['imgtext'])?$_X['imgtext']:''?>"  autocomplete="off" style="position: relative; width:100%; left: 0px; visibility:visible;">
        </td>

        
    <script>
    <?php if(z(8,'a')!='ekle'&&empty($farkli)){ ?>
        $('#resimfile').on("change", function(){
            var file_length = $('#resimfile').prop('files').length;   
            for (i = 0; i < file_length; i++) {
                var file_data = $('#resimfile').prop('files')[i];   
                var form_data = new FormData();                  
                form_data.append('file', file_data);
                var id=<?php echo $idmiz; ?>;
                $.ajax({
                    url: 'ajaxayar.php?s=kumaskarti&a=ajaxsorgu3&id='+id,
                    dataType: 'text',  
                    cache: false,
                    contentType: false,
                    processData: false,
                    data: form_data,                         
                    type: 'post',
                    success:function(gelensorgu){
                        var gelensorgu=JSON.parse(gelensorgu);
                        if(gelensorgu.sonuc==1){
                            var dosyaAd=gelensorgu.cevap.dosyaAd;
                            var dosyaid=gelensorgu.cevap.dosyaid;
                            var icerik='<div><img data-fancybox="gallery1" href="upload/kumaskarti/'+dosyaAd+'" src="upload/kumaskarti/'+dosyaAd+'" style="width:200px; padding:5px; cursor:pointer;"><span class="spanisim">'+dosyaAd+'</span><a href="#resimsil" class="resimsil" onclick="resimsil(this)">Kalıcı olarak sil</a><input type="hidden" name="neonemivar" value="'+dosyaid+'"></div>';
                            $(".resimekaciklama").after(icerik);
                        }
                    }
                });
            }
            alert("Resim yükleme tamamlanmıştır. Detay sayfasından görüntüleyebilirsiniz");
        });
    <?php } ?>
        
    $('.yuklemebaslat').on('click', function() {
        var file_length = $('#resimfile').prop('files').length;   
        for (i = 0; i < file_length; i++) {
            var file_data = $('#resimfile').prop('files')[i];   
            var form_data = new FormData();                  
            form_data.append('file', file_data);
            var id=<?php echo $idmiz; ?>;
            $.ajax({
                url: 'ajaxayar.php?s=kumaskarti&a=ajaxsorgu3&id='+id,
                dataType: 'text',  
                cache: false,
                contentType: false,
                processData: false,
                data: form_data,                         
                type: 'post',
                success:function(gelensorgu){
                    var gelensorgu=JSON.parse(gelensorgu);
                    if(gelensorgu.sonuc==1){
                        var dosyaAd=gelensorgu.cevap.dosyaAd;
                        var dosyaid=gelensorgu.cevap.dosyaid;
                        var icerik='<div><img data-fancybox="gallery1" href="upload/kumaskarti/'+dosyaAd+'" src="upload/kumaskarti/'+dosyaAd+'" style="width:200px; padding:5px; cursor:pointer;"><span class="spanisim">'+dosyaAd+'</span><a href="#resimsil" class="resimsil" onclick="resimsil(this)">Kalıcı olarak sil</a><input type="hidden" name="neonemivar" value="'+dosyaid+'"></div>';
                        $(".resimekaciklama").after(icerik);
                    }
                }
            });
        }
    });
</script>
<?php } ?>
</tr>
</tbody>
</table>
</div>
<div class="blok" style="float:left;">

</div>
<br>

<script type="text/javascript">
function iplikdegisim(ths){
    $(document).ready(function(){
        var iplikid=$(ths).attr('id');
        var iplik_ID = $(ths).val();
        var iplikclass="#"+$(ths).parent().parent().attr('id');
        var manuelkurusd=$(".mkurusd input").val();
        var manuelkureur=$(".mkureur input").val();
        manuelkurusd=manuelkurusd.replace(",",".");
        manuelkureur=manuelkureur.replace(",",".");
        var dovizdegistir=$(".dovizdegistir option:selected").text();
        var manuelkurcins=$(".mkurdovizcinsi select option:selected").val();
        var manuelkurcins='74';
        $(ths).parent().parent().find("input:nth-child(1)").attr('name', 'kumaskarti[iplikkartlari]['+iplik_ID+']');
        $(ths).parent().parent().find("input:nth-child(3)").attr('name', 'kumaskarti[iplikfireleri]['+iplik_ID+']');
        var consolbilgi="iplik_ID=>"+iplik_ID+"mkurusd=>"+manuelkurusd+"mkureur=>"+manuelkureur+"mkurdovizcinsi=>"+manuelkurcins;
           
            if(iplik_ID){
                console.log("consolbilgitek");
                console.log(consolbilgi);
                $.ajax({
                    type:"POST",
                    url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&iplik="+iplik_ID+"&mkurusd="+manuelkurusd+"&mkureur="+manuelkureur+"&mkurdovizcinsi="+manuelkurcins,
                    success:function(gelensorgu){
                        
                        if(gelensorgu.sonuc==1){
                            var iplikfire=gelensorgu.cevap.iplikfire;
                            var iplikfiyat=gelensorgu.cevap.iplikfiyat;
                            var kursuziplikfiyat=gelensorgu.cevap.kursuziplikfiyat;
                            var kurluiplikfire=gelensorgu.cevap.kurluiplikfire;
                            //iplikfiyat=iplikfiyat+kurluiplikfire;
                            var numaracins=gelensorgu.cevap.numaracins;
                            var boyaKontrol=gelensorgu.cevap.boyaKontrol;
                            var dovizCinsi=gelensorgu.cevap.dovizCinsi;
                            var dovizyazdir=dovizCinsi+" => "+dovizdegistir;
                            var dovizyazdir=dovizCinsi;
                            $(ths).parent().parent().find('.ipliknumaracins').html(numaracins);
                            $(ths).parent().parent().find('.iplikboyadurumu').html(boyaKontrol);
                            $(ths).parent().parent().find('.iplikbirimfiyat').html(kursuziplikfiyat);
                            $(ths).parent().parent().find('.iplikfiresi div').html(iplikfire);
                            //$(ths).parent().parent().find('.iplikfirelifiyattl').html(iplikfiyat);
                            //$($(ths).parent().parent().find()+'.iplikfiresi input').val(iplikfire);
                            $(ths).parent().parent().find('.iplikbirimdoviz div').html(dovizyazdir);
                            hesapla();
                        } else {
                            alert('İplik kartı okuması başarısız');
                        }
                    }
                });
            }
        selectkontrol();
        yenidovizdegistir();
    });
}

// Kur değişince olan iplik seçim
function iplikdegisimkur(ths){
    $(document).ready(function(){
        //window.kompozisyonarray={};
        //window.kompozisyonmetin='';
        //window.akildakimetin='';
        var iplikkartilength=$('.iplikkartihepsi tr').length;
        var ipliksayi=0;
        $('.iplikkartihepsi tr').each(function(i, obj7){
            ipliksayi++;
            var iplik_ID = $(obj7).find("select option:selected").val();
            var iplikclass="#"+$(obj7).attr('id');
            var manuelkurusd=$(".mkurusd input").val();
            var manuelkureur=$(".mkureur input").val();
            manuelkurusd=manuelkurusd.replace(",",".");
            manuelkureur=manuelkureur.replace(",",".");
            var dovizdegistir=$(".dovizdegistir option:selected").text();
            var manuelkurcins=$(".mkurdovizcinsi select option:selected").val();
            var manuelkurcins='74';
            var iplikoran=$(obj7).find(".iplikoranlari").val();
            var consolbilgi="iplik_ID=>"+iplik_ID+"mkurusd=>"+manuelkurusd+"mkureur=>"+manuelkureur+"mkurdovizcinsi=>"+manuelkurcins+"getiplikoran=>"+iplikoran;
            
            if(iplik_ID){
                console.log("consolbilgi1");
                console.log(consolbilgi);
            $.ajax({
                type:"POST",
                url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&iplik="+iplik_ID+"&mkurusd="+manuelkurusd+"&mkureur="+manuelkureur+"&mkurdovizcinsi="+manuelkurcins+"&getiplikoran="+iplikoran,
                success:function(gelensorgu){
                    
                    if(gelensorgu.sonuc==1){
                        var iplikfire=gelensorgu.cevap.iplikfire;
                        var iplikfiyat=gelensorgu.cevap.iplikfiyat;
                        var kursuziplikfiyat=gelensorgu.cevap.kursuziplikfiyat;
                        var kurluiplikfire=gelensorgu.cevap.kurluiplikfire;
                        //iplikfiyat=iplikfiyat+kurluiplikfire;
                        var kompozisyonarray=gelensorgu.cevap.kompozisyonarray;
                        var numaracins=gelensorgu.cevap.numaracins;
                        var boyaKontrol=gelensorgu.cevap.boyaKontrol;
                        var dovizCinsi=gelensorgu.cevap.dovizCinsi;
                        var dovizyazdir=dovizCinsi+" => "+dovizdegistir;
                        var dovizyazdir=dovizCinsi;
                        $(iplikclass+' .ipliknumaracins').html(numaracins);
                        $(iplikclass+' .iplikboyadurumu').html(boyaKontrol);
                        $(iplikclass+' .iplikbirimfiyat').html(kursuziplikfiyat);
                        $(iplikclass+' .iplikfiresi div').html(iplikfire);
                        //$(iplikclass+' .iplikfirelifiyattl').html(iplikfiyat);
                        //$(iplikclass+' .iplikfiresi input').val(iplikfire);
                        $(iplikclass+' .iplikbirimdoviz div').html(dovizyazdir);
                        hesapla();
                        /*
                        if(kompozisyonarray!=null){
                            window.kompozisyonsayi=0;
                            $.each(kompozisyonarray, function(k, v) {
                                window.kompozisyonsayi++;
                                var sayimizz= window.kompozisyonsayi;
                                var akildakimetineski=window.akildakimetin;
                              
                                if(window.kompozisyonarray[k]!=null){
                                    var akildangelen=sy(window.kompozisyonarray[k]);
                                    var dongudengelen=sy(v);
                                    var toplaknk=sy(akildangelen)+dongudengelen;
                                    window.kompozisyonarray[k]=toplaknk;
                                    var eskimetin=' %'+akildangelen+' '+k;
                                    var eskimetin2=' %'+toplaknk+' '+k;
                                    var ornekmetin=' %'+dongudengelen+' '+k;
                                    var birlestirmetin=akildakimetineski+ornekmetin;
                                    birlestirmetin=birlestirmetin.split(eskimetin).join(eskimetin2);
                                    birlestirmetin=birlestirmetin.split(ornekmetin).join('');
                                    window.akildakimetin=birlestirmetin;
                                } else {
                                    var dongudengelen=sy(v);
                                    window.kompozisyonarray[k]=dongudengelen;
                                    var ornekmetin=' %'+dongudengelen+' '+k;
                                    window.akildakimetin=akildakimetineski+ornekmetin;
                                }
                                $(".kompozisyontd").html(window.akildakimetin);
                            }); 
                        }
                        */
                    } else {
                        alert('İplik kartı okuması başarısız');
                    }
                }
            });
            }
        }); 
        hesapla();
    });
}

window.altsayaciplik=0;
function iplikdegisimkur2(ths){
    $(document).ready(function(){
        window.kompozisyonarray={};
        window.akildakimetin='';
        var iplikkartilength=$('.iplikkartihepsi tr').length;
        var ipliksayi=0;
        $('.iplikkartihepsi tr').each(function(i, obj8){
            ipliksayi++;
            var iplik_ID = $(obj8).find("select option:selected").val();
            var iplikclass="#"+$(obj8).attr('id');
            var manuelkurusd=$(".mkurusd input").val();
            var manuelkureur=$(".mkureur input").val();
            manuelkurusd=manuelkurusd.replace(",",".");
            manuelkureur=manuelkureur.replace(",",".");
            var dovizdegistir=$(".dovizdegistir option:selected").text();
            var manuelkurcins=$(".mkurdovizcinsi select option:selected").val();
            var manuelkurcins='74';
            var iplikoran=$(obj8).find(".iplikoranlari").val();
            var consolbilgi="iplik_ID=>"+iplik_ID+"mkurusd=>"+manuelkurusd+"mkureur=>"+manuelkureur+"mkurdovizcinsi=>"+manuelkurcins+"getiplikoran=>"+iplikoran;
            
            if(iplik_ID){
                console.log("consolbilgi2");
                console.log(consolbilgi);
            $.ajax({
                type:"POST",
                url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&iplik="+iplik_ID+"&mkurusd="+manuelkurusd+"&mkureur="+manuelkureur+"&mkurdovizcinsi="+manuelkurcins+"&getiplikoran="+iplikoran,
                success:function(gelensorgu){
                    
                    if(gelensorgu.sonuc==1){
                        var kompozisyonarray=gelensorgu.cevap.kompozisyonarray;
                        window.altsayaciplik++;
                        if(kompozisyonarray!=null){
                            $.each(kompozisyonarray, function(k, v) {
                                var akildakimetineski=window.akildakimetin;
                                if(window.kompozisyonarray[k]!=null){
                                    var akildangelen=sy(window.kompozisyonarray[k]);
                                    var dongudengelen=sy(v);
                                    var toplaknk=sy(akildangelen)+dongudengelen;
                                    window.kompozisyonarray[k]=toplaknk;
                                    var eskimetin=' %'+akildangelen+' '+k;
                                    var eskimetin2=' %'+toplaknk+' '+k;
                                    var ornekmetin=' %'+dongudengelen+' '+k;
                                    var birlestirmetin=akildakimetineski+ornekmetin;
                                    birlestirmetin=birlestirmetin.split(eskimetin).join(eskimetin2);
                                    birlestirmetin=birlestirmetin.split(ornekmetin).join('');
                                    window.akildakimetin=birlestirmetin;
                                } else {
                                    var dongudengelen=sy(v);
                                    window.kompozisyonarray[k]=dongudengelen;
                                    var ornekmetin=' %'+dongudengelen+' '+k;
                                    window.akildakimetin=akildakimetineski+ornekmetin;
                                }
                                $(".kompozisyontd input").val(window.akildakimetin);
                            }); 
                        }
                    } else {
                        alert('İplik kartı okuması başarısız');
                    }
                }
            });
            }
        }); 
    });
}

function karorandegistirdegisim(ths){
    //siraylacalistir();
    yenidenhesaplafiyat();
}

function karorandegistir(ths){
    $(document).ready(function(){
        var kar_ID = $(ths).val();
        $(ths).parent().parent().find("input:nth-child(1)").attr('name', 'kumaskarti[karoranlari]['+kar_ID+']');
        //siraylacalistir();
        yenidenhesaplafiyat();
        /*/
        $.ajax({
            type:"POST",
            url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu&iplik="+kar_ID+"&mkurusd="+manuelkurusd+"&mkureur="+manuelkureur+"&mkurdovizcinsi="+manuelkurcins,
            success:function(gelensorgu){
                
                if(gelensorgu.sonuc==1){
                    var iplikfire=gelensorgu.cevap.iplikfire;
                    var iplikfiyat=gelensorgu.cevap.iplikfiyat;
                    var numaracins=gelensorgu.cevap.numaracins;
                    var boyaKontrol=gelensorgu.cevap.boyaKontrol;
                    var dovizCinsi=gelensorgu.cevap.dovizCinsi;
                    var dovizyazdir=dovizCinsi+" => "+dovizdegistir;
                    var dovizyazdir=dovizCinsi;
                    $(iplikclass+' .ipliknumaracins').html(numaracins);
                    $(iplikclass+' .iplikboyadurumu').html(boyaKontrol);
                    $(iplikclass+' .iplikbirimfiyat').html(iplikfiyat);
                    $(iplikclass+' .iplikfiresi div').html(iplikfire);
                    //$(iplikclass+' .iplikfiresi input').val(iplikfire);
                    $(iplikclass+' .iplikbirimdoviz div').html(dovizyazdir);
                    hesapla();
                } else {
                    alert('İplik kartı okuması başarısız');
                }
            }
        });
        /*/
    });
}
</script>
<?php if(z(8,'a')=='ekle'&&empty($farkli)){ ?>
    <style>
    .duzenlemeyeri{
        display:none;
    }
    </style>
    <div class="alert bg-teal text-white alert-styled-left alert-styled-custom alert-dismissible" style="float: left;width: 100%;">
        <button type="button" class="close" data-dismiss="alert"><span>×</span></button>
        Kayıt oluşturulduktan sonra boya bilgilerini kar oranlarını vs girebilirsiniz.
    </div>
<?php } ?>
<div class="duzenlemeyeri">
<div class="hizayagetir">&nbsp;</div>
<div class="hamtablo" style="width:auto;margin-top: -20px;">
<table class="table table-hover" cellpadding="0" cellspacing="0" style="background: #fff;">
<tbody class="iplikkartihepsi row_position">
<tr><td colspan="8" style="text-align:center;"><a href="#iplikcogalt" class="iplikkartiarttir"><b style="font-size:14px;">HAM KUMAŞ MALİYETİ <span class="hamcogalt" style="display:none;">ÇOĞALT</span> </b></a></td></tr>
<tr>
    <th colspan="1">Silme</th>
    <th>İplik Kartı</th>
    <th>Kumaştaki İplik Oranı(%)</th>
    <th class="thiplikbirimfiyat">Birim Fiyatı(Döviz)</th>
    <th>İplik Firesi</th>
    <th class="thiplikfiyat">Fiyat</th>
    <th class="thiplikfire">Firenin Fiyatı</th>
    <th class="thfirelifiyat">Fireli Fiyat</th>
    <th class="thfirelifiyattl">Fireli Fiyat (₺)</th>
  </tr>
  <div class="">
  <?php if(z(8,'a')=='ekle'&&empty($farkli)){ ?>
  <tr id="iplikkartlari1" class="iplikkarti1" style="cursor: grab;">
    <td class="hamsilme"><input type="checkbox" class="silinecekhammaliyetler form-control"></td>
    <td style="min-width:270px;">
    <select onchange="iplikdegisim(this)" id="select1" class="select2 select-search selectsecim">
    <option value="0">Seçiniz</option>
    <?php
    $_NesneIplik=z(37,z(1,"WHERE ad='iplikkartTipi' OR ad='uretimTipi' OR ad='boyaKontrol'",'ID,ad,metin1,metin2','nesne'));
    $_Nesne=z(37,z(1,"WHERE ad='' OR ad='iplikkartTipi' OR ad='elyafTipi' OR ad='doviz' OR ad='uretimTipi' OR ad='boyaKontrol'",'ID,ad,metin1,metin2','nesne'));
    ?>
    <?php $_IplikKartlari=z(1,"WHERE arsiv = '0' ",'','iplik');  ?>
    <?php if(!empty($_IplikKartlari)){ foreach($_IplikKartlari as $iplk){ ?>
    <?php
    $iplikkart=(!empty($_NesneIplik[$iplk['nesne_IDiplikkartTipi']]['metin1'])?$_NesneIplik[$iplk['nesne_IDiplikkartTipi']]['metin1']:'');
    $uretimTipi=(!empty($_NesneIplik[$iplk['nesne_IDuretimTipi']]['metin1'])?$_NesneIplik[$iplk['nesne_IDuretimTipi']]['metin1']:'&nbsp;');
    $boyaKontrol=(!empty($_NesneIplik[$iplk['nesne_IDboyaKontrol']]['metin1'])?$_NesneIplik[$iplk['nesne_IDboyaKontrol']]['metin1']:'&nbsp;');
    $elyafmetin="";
    if(!empty($iplk['elyaf'])){ 
        $elyafcek=$iplk['elyaf'];
        $elyafarray=(!empty($iplk['elyaf'])?json_decode($iplk['elyaf'],1):'');
        if(!empty($elyafarray)){
            $elyafarray=str_replace('puan','',$elyafarray);
        }
        if(!empty($elyafarray)){ foreach($elyafarray as $i => $elyf){
            $elyafnesne=(!empty($_Nesne[$i]['metin1'])?$_Nesne[$i]['metin1']:'&nbsp;');
            $elyafmetin.='%'.$elyf.' '.$elyafnesne.' '; 
        } } 
    } 
    $iplikkart=$iplikkart.(!empty($iplikkart)&&!empty($uretimTipi)?' || ':' ').$uretimTipi.(!empty($uretimTipi)&&!empty($boyaKontrol)?' || ':' ').$boyaKontrol.(!empty($boyakontrol)&&!empty($elyafmetin)?' || ':' ').$elyafmetin;
    ?>
    <option value="<?php echo (!empty($iplk['ID'])?$iplk['ID']:''); ?>"><?php echo (!empty($iplikkart)?$iplikkart:''); ?></option>
    <?php } } ?> 
    </select>
    </td>
    <td class="iplikoran"><input type="text" class="iplikoranlari form-control" onkeyup="hesapla(this)" name="<?php echo $tbl; ?>[iplikkartlari][0]" autocomplete="off" value="0"></td>
    <td class="iplikbirimdoviz"><span class="iplikbirimfiyat"></span> <div>-</div> </td>
    <td class="iplikfiresi"><div style="float:left;">0</div> <span style="float:left;display:none;">&nbsp; => &nbsp;</span> <input type="text" onkeyup="hesapla(this)" name="<?php echo $tbl; ?>[iplikfireleri][0]" class="form-control"  autocomplete="off" style="width:60%;display:none;"></td>
    <td class="iplikfiyat">0</td>
    <td class="iplikfire">0</td>
    <td class="iplikfirelifiyat">0</td>
    <td class="iplikfirelifiyattl">0</td>
    
  </tr>
    <?php } ?>
  <?php $toplam=0; ?>
    <?php if(z(8,'a')=='duzenle'||!empty($farkli)){ ?>
    <?php 
        $iplikkartlaricek=$_X['iplikkartlari'];
        $iplikkartlariarray=(!empty($_X['iplikkartlari'])?json_decode($_X['iplikkartlari'],1):'');
        if(!empty($iplikkartlariarray)){
            $iplikkartlariarray=str_replace('puan','',$iplikkartlariarray);
        }
        
        $iplikfirelericek=$_X['iplikfireleri'];
        $iplikfireleriarray=(!empty($_X['iplikfireleri'])?json_decode($_X['iplikfireleri'],1):'');
        
        $sayi=0;
        if(!empty($iplikkartlariarray)){ foreach($iplikkartlariarray as $i => $iplkkrtlari){ $sayi++; $toplam=$toplam+$iplkkrtlari; ?>
    <tr id="iplikkartlari<?php echo $sayi; ?>" class="iplikkarti<?php echo $sayi; ?>" style="cursor: grab;">
    <td class="hamsilme"><input type="checkbox" class="silinecekhammaliyetler form-control"></td>
    <td style="min-width:270px;">
    <select onchange="iplikdegisim(this)" id="select<?php echo $sayi; ?>" class="select2 select-search selectsecim">
    <option value="0">Seçiniz</option>
    <?php $_NesneIplik=z(37,z(1,"WHERE ad='iplikkartTipi' OR ad='uretimTipi' OR ad='boyaKontrol' OR ad='elyafTipi'",'ID,ad,metin1,metin2','nesne'));  ?>
    <?php $_IplikKartlari=z(1,"WHERE arsiv = '0' ",'','iplik');  ?>
    <?php if(!empty($_IplikKartlari)){ foreach($_IplikKartlari as $iplk){ ?>
    <?php
    $iplikkart=(!empty($_NesneIplik[$iplk['nesne_IDiplikkartTipi']]['metin1'])?$_NesneIplik[$iplk['nesne_IDiplikkartTipi']]['metin1']:'');
    $uretimTipi=(!empty($_NesneIplik[$iplk['nesne_IDuretimTipi']]['metin1'])?$_NesneIplik[$iplk['nesne_IDuretimTipi']]['metin1']:'&nbsp;');
    $boyaKontrol=(!empty($_NesneIplik[$iplk['nesne_IDboyaKontrol']]['metin1'])?$_NesneIplik[$iplk['nesne_IDboyaKontrol']]['metin1']:'&nbsp;');
    $elyafmetin="";
    if(!empty($iplk['elyaf'])){
    $elyafarray=(!empty($iplk['elyaf'])?json_decode($iplk['elyaf'],1):'');
    if(!empty($elyafarray)){
        $elyafarray=str_replace('puan','',$elyafarray);
    }
    if(!empty($elyafarray)){ foreach($elyafarray as $el => $elyf){
        $elyafnesne=(!empty($_NesneIplik[$el]['metin1'])?$_NesneIplik[$el]['metin1']:'&nbsp;');
        $elyafmetin.='%'.$elyf.' '.$elyafnesne.' '; } }
    }
    $elyafmetinekle=(!empty($boyaKontrol)&&!empty($elyafmetin)?' || ':' ').$elyafmetin;
    $iplikkart=$iplikkart.(!empty($iplikkart)&&!empty($uretimTipi)?' || ':' ').$uretimTipi.(!empty($uretimTipi)&&!empty($boyaKontrol)?' || ':' ').$boyaKontrol.$elyafmetinekle;
    ?>
    <option value="<?php echo (!empty($iplk['ID'])?$iplk['ID']:''); ?>" <?php if($iplk['ID']==$i){ echo 'selected'; } ?>><?php echo (!empty($iplikkart)?$iplikkart:''); ?></option>
    <?php } }  ?> 
    </select>
    </td>
    <td class="iplikoran"><input type="text" class="iplikoranlari form-control" onkeyup="hesapla(this)" name="<?php echo $tbl; ?>[iplikkartlari][<?php echo $i; ?>]" autocomplete="off" value="<?php echo $iplkkrtlari; ?>"></td>
    <td class="iplikbirimdoviz"><span class="iplikbirimfiyat"></span> <div>-</div> </td>
    <td class="iplikfiresi"><div style="float:left;">0</div> <span style="float:left;display:none;">&nbsp; => &nbsp;</span> <input type="text" onkeyup="hesapla(this)" name="<?php echo $tbl; ?>[iplikfireleri][<?php echo $i; ?>]" class="form-control" autocomplete="off" value="<?php echo (!empty($iplikfireleriarray[$i])?$iplikfireleriarray[$i]:''); ?>" style="width:60%;display:none;"></td>
    <td class="iplikfiyat">0</td>
    <td class="iplikfire">0</td>
    <td class="iplikfirelifiyat">0</td>
    <td class="iplikfirelifiyattl">0</td>
    
  </tr>
        
    <?php } ?>
    <?php if($toplam>0){ ?>
            <script>
            iplikdegisimkur();
            </script>
        <?php } ?>
    <?php } else { ?>
        <tr id="iplikkartlari1" class="iplikkarti1" style="cursor: grab;">
            <td class="hamsilme"><input type="checkbox" class="silinecekhammaliyetler form-control"></td>
            <td style="min-width:270px;">
            <select onchange="iplikdegisim(this)" id="select1" class="select2 select-search selectsecim">
            <option value="0">Seçiniz</option>
            <?php $_NesneIplik=z(37,z(1,"WHERE ad='iplikkartTipi' OR ad='uretimTipi' OR ad='boyaKontrol' OR ad='elyafTipi'",'ID,ad,metin1,metin2','nesne'));  ?>
            <?php $_IplikKartlari=z(1,"WHERE arsiv = '0' ",'','iplik');  ?>
            <?php if(!empty($_IplikKartlari)){ foreach($_IplikKartlari as $iplk){ ?>
            <?php
            $iplikkart=(!empty($_NesneIplik[$iplk['nesne_IDiplikkartTipi']]['metin1'])?$_NesneIplik[$iplk['nesne_IDiplikkartTipi']]['metin1']:'');
            $uretimTipi=(!empty($_NesneIplik[$iplk['nesne_IDuretimTipi']]['metin1'])?$_NesneIplik[$iplk['nesne_IDuretimTipi']]['metin1']:'&nbsp;');
            $boyaKontrol=(!empty($_NesneIplik[$iplk['nesne_IDboyaKontrol']]['metin1'])?$_NesneIplik[$iplk['nesne_IDboyaKontrol']]['metin1']:'&nbsp;');
            $elyafmetin="";
            if(!empty($iplk['elyaf'])){
            $elyafarray=(!empty($iplk['elyaf'])?json_decode($iplk['elyaf'],1):'');
            if(!empty($elyafarray)){
                $elyafarray=str_replace('puan','',$elyafarray);
            }
            if(!empty($elyafarray)){ foreach($elyafarray as $el => $elyf){
                $elyafnesne=(!empty($_NesneIplik[$el]['metin1'])?$_NesneIplik[$el]['metin1']:'&nbsp;');
                $elyafmetin.='%'.$elyf.' '.$elyafnesne.' '; } }
            }
            $elyafmetinekle=(!empty($boyaKontrol)&&!empty($elyafmetin)?' || ':' ').$elyafmetin;
            $iplikkart=$iplikkart.(!empty($iplikkart)&&!empty($uretimTipi)?' || ':' ').$uretimTipi.(!empty($uretimTipi)&&!empty($boyaKontrol)?' || ':' ').$boyaKontrol.$elyafmetinekle;
            ?>
            <option value="<?php echo (!empty($iplk['ID'])?$iplk['ID']:''); ?>"><?php echo (!empty($iplikkart)?$iplikkart:''); ?></option>
            <?php } } ?> 
            </select>
            </td>
            <td class="iplikoran"><input type="text" class="iplikoranlari form-control" onkeyup="hesapla(this)" name="<?php echo $tbl; ?>[iplikkartlari][0]" autocomplete="off" value="0"></td>
            <td class="iplikbirimdoviz"><span class="iplikbirimfiyat"></span> <div>-</div> </td>
            <td class="iplikfiresi"><div style="float:left;">0</div> <span style="float:left;display:none;">&nbsp; => &nbsp;</span> <input type="text" onkeyup="hesapla(this)" name="<?php echo $tbl; ?>[iplikfireleri][0]" class="form-control"  autocomplete="off" style="width:60%;display:none;"></td>
            <td class="iplikfiyat">0</td>
            <td class="iplikfire">0</td>
            <td class="iplikfirelifiyat">0</td>
            <td class="iplikfirelifiyattl">0</td>
            
        </tr>
    <?php } ?>
    <?php } ?>
  </div>
</tbody>
<tbody>
<tr id="iplikkartitoplam1" class="iplikkartitoplamc1">
   <td colspan="2">
    <a href="#secililerisil" class="secilidurum btn btn-danger"><i class="icon-minus3 mr-1 icon-1x"></i></a>&nbsp;
    <a href="#iplikkartiarttir" class="iplikkartiarttir btn btn-success"><i class="icon-plus3 mr-1 icon-1x"></i></a>
   </td>
   <td colspan="4" style="text-align:right;"><b> Toplam İplik Maliyeti:</b></td>
   <td colspan="1" class="toplamfirefiyaticek1" style="display:none;">0</td>
   <td colspan="1" class="toplamfirelifiyaticek1" style="display:none;">0</td>
   <td colspan="1" class="toplamfirelifiyaticektl1">0</td>
   <td colspan="1"></td>
</tr>
<tr id="iplikkartitoplam2" class="iplikkartitoplamc2">
   <td colspan="6" style="text-align:right;"><b> Fason Maliyeti:</b></td>
   <td colspan="1" class="toplamfirefiyaticek2" style="display:none;">0</td>
   <td colspan="1" class="toplamfirelifiyaticek2" style="display:none;">0</td>
   <td colspan="1" class="toplamfirelifiyaticektl2">0</td>
   <td colspan="1"></td>
</tr>
<tr id="iplikkartitoplam" class="iplikkartitoplamc">
   <td colspan="6" style="text-align:right;"><b> Ham Kumaş Maliyeti:</b></td>
   <td colspan="1" class="toplamfiyatcek">0</td>
   <td colspan="1" class="toplamfirefiyaticek" style="display:none;">0</td>
   <td colspan="1" class="toplamfirelifiyaticek" style="display:none;">0</td>
   <td colspan="1" class="toplamfirelifiyaticektl tpfiyattl">0</td>
   <td colspan="1" class="yenidoviz"><?php if(!empty($_NSN2))foreach($_NSN2 as $ad=>$n){?><?php echo select(Array('name'=>$tbl.'[nesne_ID'.$ad.']','detay'=>'class="nesneSlc_'.$ad.' dovizdegistirme form-control" onchange="yenidovizdegistir(this)" ','t'=>'nesne','alan'=>'ID,'.$n['alan'],'sd'=>"WHERE ad='".$ad."'",'icerik'=>'<option value="">Seçiniz</option><option value="yeni">**YENİ**</option>','sec'=>!empty($_X['nesne_ID'.$ad])?$_X['nesne_ID'.$ad]:substr(z('date'),0,7)))?>
    <?php }?></td>
  </tr>
</tbody>
</table>
</div>
<br>
<div class="yetkikontrol tabloyetki" style="display:none;">
<table class="table table-hover" cellpadding="0" cellspacing="0" style="background: #eeeeee;">
<tbody>
<?php
$usd=kur(1,'USD','TRY');
$eur=kur(1,'EUR','TRY');
$eurusd=$eur/$usd;
?>
<tr><th colspan="4">HAM KUMAŞ MALİYETİ</th></tr>    
<tr>
    <th>&nbsp;</th>
    <th>Fiyat</th>
    <th>Doviz Seç</th>
</tr>
<tr>
    <th>Fiyat</th>  
    <td><b class="tpfiyattl2">-</b></td>
    <td class="yenidoviz2">
    <?php if(!empty($_NSN2))foreach($_NSN2 as $ad=>$n){?><?php echo select(Array('name'=>$tbl.'[nesne_ID'.$ad.']','detay'=>'class="nesneSlc_'.$ad.' dovizdegistirme form-control" onchange="yenidovizdegistir(this)" ','t'=>'nesne','alan'=>'ID,'.$n['alan'],'sd'=>"WHERE ad='".$ad."'",'icerik'=>'<option value="">Seçiniz</option><option value="yeni">**YENİ**</option>','sec'=>!empty($_X['nesne_ID'.$ad])?$_X['nesne_ID'.$ad]:substr(z('date'),0,7)))?>
    <?php }?>
    </td>
</tr>
</tbody>
</table>
<input type="hidden" name="<?php echo $tbl; ?>[maliyetham]" class="maliyetham form-control" value="0">
</div>
<br>
<?php
$boyabaskiall=z(1,"WHERE arsiv='0' AND kategori='2'",'','boyabaski');
$_NesneBoya=z(37,z(1,"WHERE ad='boyaBaskiHizmetleri'",'ID,ad,metin1,metin2','nesne'));
$_NesneDoviz=z(37,z(1,"WHERE ad='doviz'",'ID,ad,metin1,metin2','nesne'));
?>
<div class="kumasterbiyeblok">
<h2 style="text-align: center; font-size: 18px; background: white; font-weight: bold; margin:0px;"><b>KUMAŞ TERBİYE İŞLEMLERİ</b></h2>
<div class="kumasterbiyealtblok">
<div class="tabloboyaterbiye">
<table cellpadding="0" cellspacing="0" style="background: #eeeeee;" class="ekhizmetler table table-hover">

<?php  if(z(8,'a')=='ekle'&&empty($farkli)){ ?>
    <tbody class="ekhizmetkumas">
    <tr>
    <th colspan="1" class="ekth">Silme</th>
    <th colspan="2" class="ekth"><span style="font-weight:bold;">HAM TERBİYE</span> <br><a href="#secililerisil" class="seciliboya btn btn-danger"><i class="icon-minus3 icon-1x"></i></a>&nbsp;<a href="#ekhizmetcogalt" class="ekhizmetartir btn btn-success"><b style="font-size:14px; color:white;"> <i class="icon-plus3 icon-1x"></i> </b></a></th>
    <th colspan="1" class="ekth" style="font-size:16px;">BİRİM FİYAT</th>
    <th colspan="1" class="ekth" style="font-size:16px;">BİRİM FİYAT ₺</th>
    <th colspan="1" class="ekth" style="font-size:16px;">FİRE</th>
    <th colspan="1" class="ekth" style="font-size:16px;">SATIR TOPLAMI ₺</th>
    </tr>    
    <tr>
    <th colspan="1"><input type="checkbox" class="silinecekhamterbiye form-control"></th>
    <th colspan="2" class="selectboyabaskisi">
    <select class="selectboyabaski " id="boyabaski" onchange="boyamaliyetihizmetyansityeni(this)" name="<?php echo $tbl; ?>[ekhizmet][]">
        <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
        <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
        <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
        <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
        <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
        <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
        <option value="<?php echo $bybskall['ID']; ?>"><?php echo $boyaTipitext.' '; ?></option>
        <?php } } ?>
    </select>
    <a href="#ekhizmetsil" class="ekhizmetsil" onclick="ekhizmetsilme(this)">Sil</a>
    </th>
    <td class="hamterbiyebirimfiyat"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="hamterbiyefiyat"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="hamterbiyefire"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="tlekboyamaliyeti yetkikontrol"><input type="text" value="0" class="form-control" disabled="disabled"></td>
    </tr>
    <!--
        <tr class="tlekhizmetdoviz">
        <th colspan="2">Doviz Kodu</th> 
        <td>-</td>
    </tr>
    <tr class="tlekhizmetbirim">
        <th colspan="2">Birim Fiyatı[TL]</th> 
        <td>-</td>
    </tr>
    <tr class="tlekboyamaliyeti">
        <th colspan="2">TL</th> 
        <td>-</td>
    </tr>
    <tr class="usdekboyamaliyeti">
        <th colspan="2">USD</th>  
        <td>-</td>
    </tr>
    <tr class="eurekboyamaliyeti">
        <th colspan="2">EUR</th>  
        <td>-</td>
    </tr>
    -->
    
    
    </tbody>
<?php } ?>
<?php 
$ekhizmetarray='';
$maliyetham=(!empty($_X['maliyetham'])?$_X['maliyetham']:0);
if(!empty($_X['ekhizmet'])){
    $ekhizmetarray=(!empty($_X['ekhizmet'])?json_decode($_X['ekhizmet'],1):'');
}
?>
<?php if(z(8,'a')=='duzenle'||!empty($farkli)){ ?>
<?php $sayimiz=0; $boyabaskitlfiyat=0; $usdkurlufiyat=0; $eurkurlufiyat=0; $tlkurlufiyat=0; ?>
<?php if(!empty($ekhizmetarray)){ foreach($ekhizmetarray as $ek => $ekhizmet ){ $sayimiz++; ?>
<?php
$boyabaskiyioku=z(1,$ekhizmet,'','boyabaski');
$doviznesne=(!empty($_NesneDoviz[$boyabaskiyioku['nesne_IDdoviz']]['metin1'])?$_NesneDoviz[$boyabaskiyioku['nesne_IDdoviz']]['metin1']:'&nbsp;');
$altboyabaski=(!empty($boyabaskiyioku['fiyat'])?$boyabaskiyioku['fiyat']:0);
$altboyabaskifire=(!empty($boyabaskiyioku['fire'])?$boyabaskiyioku['fire']:0);

$usdvt=(!empty($_X['mkurusd'])?$_X['mkurusd']:0);
$eurvt=(!empty($_X['mkureur'])?$_X['mkureur']:0);
$TRY=1;

if(!empty($doviznesne)&&$doviznesne=='USD'){
    $bnu=$usdvt;
}
if(!empty($doviznesne)&&$doviznesne=='EUR'){
    $bnu=$eurvt;
}
if(!empty($doviznesne)&&$doviznesne=='TRY'){
    $bnu=$TRY;
}

$fiyattoplama=(!empty($fiyattoplama)?$fiyattoplama:$maliyetham);
$dovizcinsi='TRY';
//$tlkurlufiyat=kur($altboyabaski,$doviznesne,'TRY');
$tlkurlufiyat=($altboyabaski*$bnu);
$hamhizmet=($fiyattoplama+$tlkurlufiyat)*(100+$altboyabaskifire)/100;
//$usdkurlufiyat=kur($hamhizmet,'TRY','USD');
$usdkurlufiyat=($hamhizmet/$usdvt);
//$eurkurlufiyat=kur($hamhizmet,'TRY','EUR');
$eurkurlufiyat=($hamhizmet/$eurvt);

$boyabaskitlfiyat=$hamhizmet;
$boyabaskitlfiyat2=($hamhizmet-$fiyattoplama);
$fiyattoplama=$boyabaskitlfiyat;
?>
    <tbody class="ekhizmetkumas">
<tr>
<th colspan="1" class="ekth">Silme</th>
<th colspan="2" class="ekth" style="font-weight:bold;">HAM TERBİYE <?php if($sayimiz==1){ ?><br><a href="#secililerisil" class="seciliboya btn btn-danger"><i class="icon-minus3 icon-1x"></i></a>&nbsp;<a href="#ekhizmetcogalt" class="ekhizmetartir btn btn-success"><b style="font-size:14px; color:white;"> <i class="icon-plus3 icon-1x"></i> </b></a><?php } ?></th>
<th colspan="1" class="ekth" style="font-size:16px;">BİRİM FİYAT</th>
<th colspan="1" class="ekth" style="font-size:16px;">BİRİM FİYAT ₺</th>
<th colspan="1" class="ekth" style="font-size:16px;">FİRE</th>
<th colspan="1" class="ekth" style="font-size:16px;">SATIR TOPLAMI ₺</th>
</tr>    
    <tr>
    <th colspan="1"><input type="checkbox" class="silinecekhamterbiye form-control"></th>
    <th colspan="2" class="selectboyabaskisi">
    <select class="selectboyabaski " id="boyabaski" onchange="boyamaliyetihizmetyansityeni(this)" name="<?php echo $tbl; ?>[ekhizmet][]">
        <option value="0">Seçiniz</option>
        <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
        <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
        <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
        <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
        <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
        <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
        <option value="<?php echo $bybskall['ID']; ?>" <?php if($bybskall['ID']==$ekhizmet){ echo 'selected'; } ?> ><?php echo $boyaTipitext.' '; ?></option>
        <?php } } ?>
    </select>
    <a href="#ekhizmetsil" class="ekhizmetsil" onclick="ekhizmetsilme(this)">Sil</a>
    </th>
    <td class="hamterbiyebirimfiyat"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="hamterbiyefiyat"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="hamterbiyefire"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="tlekboyamaliyeti yetkikontrol">
    <input type="text" value="<?php echo $boyabaskitlfiyat; ?>" class="form-control" disabled="disabled">
    
    </td>
    </tr>
    </tbody>
<?php } } else { ?>
    <tbody class="ekhizmetkumas">
    <tr>
    <th colspan="1" class="ekth">Silme</th>
    <th colspan="2" class="ekth" style="font-weight:bold;">HAM TERBİYE <br><a href="#secililerisil" class="seciliboya btn btn-danger"><i class="icon-minus3 icon-1x"></i></a>&nbsp;<a href="#ekhizmetcogalt" class="ekhizmetartir btn btn-success"><b style="font-size:14px; color:white;"> <i class="icon-plus3 icon-1x"></i> </b></a></th>
    <th colspan="1" class="ekth" style="font-size:16px;">BİRİM FİYAT</th>
    <th colspan="1" class="ekth" style="font-size:16px;">BİRİM FİYAT ₺</th>
    <th colspan="1" class="ekth" style="font-size:16px;">FİRE</th>
    <th colspan="1" class="ekth" style="font-size:16px;">SATIR TOPLAMI ₺</th>
    </tr>    
    <tr>
    <th colspan="1"><input type="checkbox" class="silinecekhamterbiye form-control"></th>
    <th colspan="2" class="selectboyabaskisi">
    <select class="selectboyabaski " id="boyabaski" onchange="boyamaliyetihizmetyansityeni(this)" name="<?php echo $tbl; ?>[ekhizmet][]">
        <option value="0">Seçiniz</option>
        <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
        <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
        <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
        <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
        <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
        <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
        <option value="<?php echo $bybskall['ID']; ?>"><?php echo $boyaTipitext.' '; ?></option>
        <?php } } ?>
    </select>
    <a href="#ekhizmetsil" class="ekhizmetsil" onclick="ekhizmetsilme(this)">Sil</a>
    </th>
    <td class="hamterbiyebirimfiyat"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="hamterbiyefiyat"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="hamterbiyefire"><input type="text" value="0" class="form-control" disabled="disabled"></td>  
    <td class="tlekboyamaliyeti yetkikontrol"><input type="text" value="0" class="form-control" disabled="disabled"></td>
    </tr>
    </tbody>
<?php } ?>

<?php } ?>
</table>
</div>

<?php
$boyabaskiall=z(1,"WHERE arsiv='0' AND kategori='1'",'','boyabaski');
$_NesneBoya=z(37,z(1,"WHERE ad='boyaBaskiHizmetleri'",'ID,ad,metin1,metin2','nesne'));
$_NesneDoviz=z(37,z(1,"WHERE ad='doviz'",'ID,ad,metin1,metin2','nesne'));
?>
<div class="tabloterbiyebaskiarasi">&nbsp;</div>
<div class="tabloboyabaski">
<table cellpadding="0" cellspacing="0" class="tablealt tableboyatable table table-hover">
<tbody class="boyamaliyetihepsi">
<tr><th colspan="12" style="font-weight:bold;">BOYA BASKI İŞLEMLER <br><a href="#secililerisil" class="seciliboyabaski btn btn-danger"><i class="icon-minus3 icon-1x"></i></a><a href="#altboyamaliyeticogalt" class="ustboyamaliyetiartir btn btn-success"><b style="font-size:14px; color:white;"> <i class="icon-plus3 icon-1x"></i> </b></a></th></tr>    
<tr style="border-bottom: 4px solid #94989e;" class="boyabaskitr">
    <th colspan="2">
    <div class="bilgikutucugu">Boya Bilgisi</div>
    <div class="bilgikutucugu">Birim Fiyatı</div>
    <div class="bilgikutucugu">Firesi</div>
    <div class="bilgikutucugu">Toplam</div>
    <div class="bilgikutucugu">Silme</div>
    </th>
    <td colspan="12" class="selectboyatd">
    <?php if(z(8,'a')=='ekle'&&empty($farkli)){ ?>
    <div class="boyabaskimaliyet boyabaskimaliyet1" style="float:left;">
    <select class="selectboyabaski form-control" id="boyabaski" onchange="boyamaliyetiyansityeni(this)">
    <option value="0">Seçiniz</option>
    <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
    <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
    <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
    <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
    <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
    <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>

    <option value="<?php echo $bybskall['ID']; ?>"><?php echo $boyaTipitext; ?></option>
     <?php } } ?>
    </select>
    <span style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;">&nbsp;</span>
    <p style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;margin:0;">&nbsp;</p>
    <div style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;margin-bottom:2px;" class="yetkikontrolfiyat">&nbsp;</div>
    <a href="#maliyetsil"><input type="checkbox" class="silinecekboyaterbiye form-control"></a>
    </div>
    <?php } ?>
    <?php $maliyettoplam=0; ?>
    <?php if(z(8,'a')=='duzenle'||!empty($farkli)){ ?>

    <?php 
    $fiyattoplama=(!empty($fiyattoplama)?$fiyattoplama:$maliyetham);
    $boyamaliyetcek=$_X['boyamaliyet'];
    $boyamaliyetarray=(!empty($_X['boyamaliyet'])?json_decode($_X['boyamaliyet'],1):'');
    if(!empty($boyamaliyetarray)){
        $boyamaliyetarray=str_replace('puan','',$boyamaliyetarray);
    }
    $sayi=0;
    if(!empty($boyamaliyetarray)){ foreach($boyamaliyetarray as $bymlyt => $bymlytler){ $sayi++; 
        $ustboyabaskicek=z(1,$bymlyt,'','boyabaski');
        $doviznesne=(!empty($_NesneDoviz[$ustboyabaskicek['nesne_IDdoviz']]['metin1'])?$_NesneDoviz[$ustboyabaskicek['nesne_IDdoviz']]['metin1']:'&nbsp;');
        $ustboyabaski=(!empty($ustboyabaskicek['fiyat'])?$ustboyabaskicek['fiyat']:0);
        $ustboyabaskifire=(!empty($ustboyabaskicek['fire'])?$ustboyabaskicek['fire']:0);
        $ustboyabaskifire=z('36',$ustboyabaskifire,2,1);
        $ustboyabaskifire2=(!empty($ustboyabaskifire)?(($ustboyabaskifire+100)/100):0);

        $mkurtry=1;
        $mkurusd=(!empty($_X['mkurusd'])?$_X['mkurusd']:'');
        $mkureur=(!empty($_X['mkureur'])?$_X['mkureur']:'');
        if(!empty($doviznesne)&&$doviznesne=='USD'){
            $bnu=$mkurusd;
        }
        if(!empty($doviznesne)&&$doviznesne=='EUR'){
            $bnu=$mkureur;
        }
        if(!empty($doviznesne)&&$doviznesne=='TRY'){
            $bnu=$mkurtry;
        }

        $dovizcinsi='TRY';
        
        $kurlufiyat=($ustboyabaski*$bnu);
        $ustboyabaski=$kurlufiyat;
        $ustboyabaskibirimfiyat=(!empty($ustboyabaskicek['fiyat'])?$ustboyabaskicek['fiyat']:'');
        $ustboyabaskibirimfiyat=z('36',$ustboyabaskibirimfiyat,2,1);
        $ustbaskitoplam=($fiyattoplama+$ustboyabaski)*$ustboyabaskifire2;
        $ustbaskitoplam=z(36,$ustbaskitoplam,2);
    ?>
    <div class="boyabaskimaliyet boyabaskimaliyet<?php echo $sayi; ?>" style="float:left;">
    <select class="selectboyabaski form-control" id="boyabaski" onchange="boyamaliyetiyansityeni(this)">
    <option value="0">Seçiniz</option>
    <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
    <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
    <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
    <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
    <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
    <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
    <option value="<?php echo $bybskall['ID']; ?>" <?php if($bybskall['ID']==$bymlyt){ echo 'selected'; } ?>><?php echo $boyaTipitext; ?></option>
     <?php } } ?>
    </select>
    <span style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;" class="yetkikontrol"><?php echo $ustboyabaskibirimfiyat; ?></span>
    <p style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;margin:0;" class="yetkikontrol"><?php echo $ustboyabaskifire; ?></p>
    <div style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;margin-bottom:2px;" class="yetkikontrol yetkikontrolfiyat"><?php echo $ustbaskitoplam; ?></div>
    <a href="#maliyetsil"><input type="checkbox" class="silinecekboyaterbiye form-control"></a>
    </div>
    <?php } } else {  ?>
        <div class="boyabaskimaliyet boyabaskimaliyet1" style="float:left;">
        <select class="selectboyabaski form-control" id="boyabaski" onchange="boyamaliyetiyansityeni(this)">
        <option value="0">Seçiniz</option>
        <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
        <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
        <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
        <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
        <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
        <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
        <option value="<?php echo $bybskall['ID']; ?>"><?php echo $boyaTipitext; ?></option>
        <?php } } ?>
        </select>
        <span style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;" class="yetkikontrol">&nbsp;</span>
        <p style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;margin:0;" class="yetkikontrol">&nbsp;</p>
        <div style="display:block;border: 1px solid #ddd;background: white;padding: 10px 20px;margin-bottom:2px;" class="yetkikontrol yetkikontrolfiyat">&nbsp;</div>
        <a href="#maliyetsil"><input type="checkbox" class="silinecekboyaterbiye form-control"></a>
        </div>
        <?php } ?>
    <?php } ?>
    <a href="#boyamaliyeticogalt" class="ustboyamaliyetiartir"><b style="font-size:14px; color:white; display:none;"> <i class="icon-plus3 mr-1 icon-1x"></i> </b></a>

    </td>
</tr>
<?php $boyabaskiall=z(1,"WHERE arsiv='0' AND kategori='2'",'','boyabaski'); ?>
<tr class="kumasarabosluk">&nbsp;</tr>
<tr class="mamulboyamaliyeti">
    <th colspan="1" class="ekth">Silme</th>
    <th colspan="2" class="ekth" style="font-weight:bold;">SON TERBİYE İŞLEMLER <br><a href="#secililerisil" class="secilisonterbiye btn btn-danger"><i class="icon-minus3 icon-1x"></i></a>&nbsp;<a href="#altboyamaliyeticogalt" class="altboyamaliyetiartir btn btn-success"><b style="font-size:14px; color:white;"> <i class="icon-plus3 icon-1x"></i> </b></a></th>
    <th colspan="1" class="ekth" style="font-size:16px;">BİRİM FİYAT</th>
    <th colspan="1" class="ekth" style="font-size:16px;">BİRİM FİYAT ₺</th>
    <th colspan="1" class="ekth" style="font-size:16px;">FİRE</th>
    <th colspan="1" class="ekth" style="font-size:16px;">SATIR TOPLAMI ₺</th>
    </tr>    
<?php if(z(8,'a')=='ekle'&&empty($farkli)){ ?>
<tr class="boyamaliyetlerimiz boyamaliyetiinputt1">
<th colspan="1"><input type="checkbox" class="silineceksonterbiye form-control"></th>
<th colspan="2" class="bunukopyala1 selectmaliyet">
<select onchange="altboyadegistiryeni(this)" class="1">
<option value="0">Seçiniz</option>
<?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
        <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
        <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
        <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
        <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
        <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
        <option value="<?php echo $bybskall['ID']; ?>"><?php echo $boyaTipitext; ?></option>
        <?php } } ?>
</select>
<a href="#altmaliyetsil" class="sonterbiyesil" onclick="altmaliyetsilme(this)">Sil</a>
</th>
<td><input type="text" disabled="disabled" class="form-control yetkikontrol2" value="0"></td>
<td><input type="text" disabled="disabled" class="form-control yetkifiyattl" value="0"></td>
<td><input type="text" disabled="disabled" class="form-control yetkikontrolfire" value="0"></td>
<td class="boyamaliyetiinput1"></td>
</tr>
<?php } ?>

<?php $toplamb=0; if(z(8,'a')=='duzenle'||!empty($farkli)){ ?>
<?php if(!empty($bymlytler)){ ?>
    <?php 
    $boyamaliyetarray=$bymlytler;
    if(!empty($boyamaliyetarray)){
        $boyamaliyetarray=str_replace('puan','',$boyamaliyetarray);
    }
    $sayi=0;
    $sayi2=0;
    
    if(!empty($boyamaliyetarray)){ foreach($boyamaliyetarray as $bymlyt => $bymlytler){ $sayi++;  $sayi2++; 
    $altboyabaskicek=z(1,$bymlyt,'','boyabaski');
	$doviznesne=(!empty($_NesneDoviz[$altboyabaskicek['nesne_IDdoviz']]['metin1'])?$_NesneDoviz[$altboyabaskicek['nesne_IDdoviz']]['metin1']:'<input type="checkbox" class="silineceksonterbiye form-control">');
	$altboyabaski=(!empty($altboyabaskicek['fiyat'])?$altboyabaskicek['fiyat']:0);
	$altboyabaskisade=(!empty($altboyabaskicek['fiyat'])?$altboyabaskicek['fiyat']:0);
	$altboyabaskifire=(!empty($altboyabaskicek['fire'])?$altboyabaskicek['fire']:0);
	$altboyabaskifiresade=(!empty($altboyabaskicek['fire'])?$altboyabaskicek['fire']:0);
    $altboyabaskifire2=(!empty($altboyabaskifire)?(($altboyabaskifire+100)/100):0);
    
    $dovizcinsi='TRY';
    $dovizsimge='₺';
    $mkurtry=1;
    $mkurusd=(!empty($_X['mkurusd'])?$_X['mkurusd']:'');
    $mkureur=(!empty($_X['mkureur'])?$_X['mkureur']:'');
    if(!empty($doviznesne)&&$doviznesne=='USD'){
        $bnu=$mkurusd;
        $dovizsimge='$';
	}
	if(!empty($doviznesne)&&$doviznesne=='EUR'){
        $bnu=$mkureur;
        $dovizsimge='€';
	}
	if(!empty($doviznesne)&&$doviznesne=='TRY'){
        $bnu=$mkurtry;
        $dovizsimge='₺';
	}
	
	$dovizcinsi='TRY';
	//$kurlufiyat=kur($ustboyabaski,$doviznesne,$dovizcinsi);
	$kurlufiyat=($altboyabaski*$bnu);
	//$kurlufiyat=kur($altboyabaski,$doviznesne,$dovizcinsi);
	$altboyabaski=$kurlufiyat;
	$altbaskitoplam=($altboyabaski*$altboyabaskifire2);
	$altbaskitoplam=z(36,$altbaskitoplam,2);
    ?>
   <tr class="boyamaliyetlerimiz boyamaliyetiinputt<?php echo $sayi2; ?>">
   <th colspan="1"><input type="checkbox" class="silineceksonterbiye form-control"></th>
   <th colspan="2" class="selectmaliyet">
   <select onchange="altboyadegistiryeni(this)" class="<?php echo $sayi2; ?>">
   <option value="0">Seçiniz</option>
   <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
    <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
    <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
    <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2):''); ?>
    <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
    <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
    <option value="<?php echo $bybskall['ID']; ?>" <?php if($bybskall['ID']==$bymlyt){ echo 'selected'; } ?>><?php echo $boyaTipitext; ?></option>
     <?php } } ?>
   </select>
    <a href="#altmaliyetsil" class="sonterbiyesil" onclick="altmaliyetsilme(this)">Sil</a>
   </th>
   <td><input type="text" disabled="disabled" class="form-control yetkikontrol2" value="<?php echo $altboyabaskisade.$dovizsimge; ?>"></td>
    <td><input type="text" disabled="disabled" class="form-control yetkifiyattl" value="<?php echo $altboyabaski; ?>"></td>
    <td><input type="text" disabled="disabled" class="form-control yetkikontrolfire" value="<?php echo $altboyabaskifiresade; ?>"></td>
   <td class="boyamaliyetiinput1">
   <?php 
    $boyamaliyetcek=$_X['boyamaliyet'];
    $boyamaliyetarray=(!empty($_X['boyamaliyet'])?json_decode($_X['boyamaliyet'],1):'');
    if(!empty($boyamaliyetarray)){
        $boyamaliyetarray=str_replace('puan','',$boyamaliyetarray);
    }
    $sayi=0;
    $boyamaliyetsayi=0;
    $boyamaliyetstyle="18%";
    if(!empty($boyamaliyetarray)){
        $boyamaliyetsayi=count($boyamaliyetarray);
        $boyamaliyetstyle=(100)/$boyamaliyetsayi;
        $boyamaliyetstyle=($boyamaliyetstyle)-2;
        $boyamaliyetstyle=$boyamaliyetstyle.'%';
    }
    if(!empty($boyamaliyetarray)){ foreach($boyamaliyetarray as $bymlyt2 => $bymlytler2){ $sayi++; 
        if(!empty($bymlytler2)){
            $bymlytler2=str_replace('puan','',$bymlytler2);
        }
    ?>
   <input type="text" name="kumaskarti[boyamaliyet]<?php echo $bymlyt2; ?>][<?php echo $bymlyt; ?>]" value="<?php echo $bymlytler2[$bymlyt]; ?>" autocomplete="off" class="boyamaliyethesapla boyainput<?php echo $sayi; ?> form-control" style="width:<?php echo $boyamaliyetstyle; ?>;" disabled="">
   <input type="hidden" name="kumaskarti[boyamaliyet][<?php echo $bymlyt2; ?>][<?php echo $bymlyt; ?>]" value="<?php echo $bymlytler2[$bymlyt]; ?>" autocomplete="off" class="boyamaliyethesapla form-control">
   <?php } } ?>
   </td>
   </tr>
    <?php } } else { ?>
        <tr class="boyamaliyetlerimiz boyamaliyetiinputt1">
        <th colspan="1"><input type="checkbox" class="silineceksonterbiye form-control"></th>
        <th colspan="2" class="bunukopyala1 selectmaliyet">
        <select onchange="altboyadegistiryeni(this)" class="1">
        <option value="0">Seçiniz</option>
        <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
                <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
                <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
                <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
                <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
                <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
                <option value="<?php echo $bybskall['ID']; ?>"><?php echo $boyaTipitext; ?></option>
                <?php } } ?>
        </select>
        <a href="#altmaliyetsil" class="sonterbiyesil" onclick="altmaliyetsilme(this)">Sil</a>
        </th>
        <td><input type="text" disabled="disabled" class="form-control yetkikontrol2" value="0"></td>
        <td><input type="text" disabled="disabled" class="form-control yetkifiyattl" value="0"></td>
        <td><input type="text" disabled="disabled" class="form-control yetkikontrolfire" value="0"></td>
        <td class="boyamaliyetiinput1"></td>
        </tr>
    <?php } ?>
        
   <?php  } else { ?>
        <tr class="boyamaliyetlerimiz boyamaliyetiinputt1">
        <th colspan="1">&nbsp;</th>
        <th colspan="2" class="bunukopyala1 selectmaliyet">
        <select onchange="altboyadegistiryeni(this)" class="1">
        <option value="0">Seçiniz</option>
        <?php if(!empty($boyabaskiall)){  foreach($boyabaskiall as $bybskall){ ?>
                <?php $boyaTipi=(!empty($_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1'])?$_NesneBoya[$bybskall['nesne_IDboyaBaskiHizmetleri']]['metin1']:''); ?>
                <?php $boyaTipitext=(!empty($bybskall['tipi'])?$bybskall['tipi']:''); ?>
                <?php $boyaTipifiyat=(!empty($bybskall['fiyat'])&&!empty($ytkFyt)||$admn?z(36,$bybskall['fiyat'],2,1):''); ?>
                <?php $boyaTipidoviz=(!empty($_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2'])&&!empty($ytkFyt)||$admn?$_NesneDoviz[$bybskall['nesne_IDdoviz']]['metin2']:''); ?>
                <?php $boyaTipifire=(!empty($bybskall['fire'])?'%'.z(36,$bybskall['fire']):''); ?>
                <option value="<?php echo $bybskall['ID']; ?>"><?php echo $boyaTipitext; ?></option>
                <?php } } ?>
        </select>
        <a href="#altmaliyetsil" class="sonterbiyesil" onclick="altmaliyetsilme(this)">Sil</a>
        </th>
        <td><input type="text" disabled="disabled" class="form-control yetkikontrol2" value="0"></td>
        <td><input type="text" disabled="disabled" class="form-control yetkifiyattl" value="0"></td>
        <td><input type="text" disabled="disabled" class="form-control yetkikontrolfire" value="0"></td>
        <td class="boyamaliyetiinput1"></td>
        </tr>
    <?php }  ?>

<?php } ?>

</tbody>
</table>
</div>
</div>
</div>
<br>
<?php
$_Nesnekar=z(37,z(1,"WHERE ad='' OR ad='karBirimleri'",'ID,ad,metin1,metin2','nesne'));
?>
<div class="tabloilavegider">
<table cellpadding="0" cellspacing="0" class="tablekar table table-hover">
<tbody class="boyamaliyetkarlari">
<tr><th colspan="1">Silme</th><th colspan="12" style="width:100%;">İlave Giderler <br><a href="#secililerisil" class="seciliilavegider btn btn-danger"><i class="icon-minus3 icon-1x"></i></a>&nbsp;<a href="#altboyamaliyeticogalt" class="karoranartir btn btn-success"><b style="font-size:14px; color:white;"> <i class="icon-plus3 icon-1x"></i> </b></a></th></tr>
<?php if(z(8,'a')=='ekle'&&empty($farkli)){ ?>  
<tr class="boyamaliyetkarlarimiz boyamaliyetkarlari1">
   <th colspan="1"><input type="checkbox" class="silinecekilavegider form-control"></th>
   <th colspan="2">
    <select onchange="karorandegistir(this)" class="form-control">
        <option value="0">Seçiniz</option>
        <?php if(!empty($_Nesnekar)){ foreach($_Nesnekar as $kar){ ?>
            <option value="<?php echo $kar['ID']; ?>"><?php echo (!empty($kar['metin1'])?$kar['metin1']:0); ?></option>
        <?php } } ?>
    </select>
   </th>
   <td>
    <input type="text" class="karoranlari form-control" onkeyup="karorandegistirdegisim()" name="<?php echo $tbl; ?>[karoranlari][0]">
    <a href="#karoransil" class="karoransil" onclick="karoransilme(this)">X</a>
   </td>
</tr>
<?php } ?>
<?php if(z(8,'a')=='duzenle'||!empty($farkli)){ ?>
<?php
$karoranlaricek=$_X['karoranlari'];
$karoranlariarray=(!empty($_X['karoranlari'])?json_decode($_X['karoranlari'],1):'');
$karsayi=0;
if(!empty($karoranlariarray)){ foreach($karoranlariarray as $ikar => $karoranlari){ $karsayi++; 
?>
<tr class="boyamaliyetkarlarimiz boyamaliyetkarlari<?php echo $karsayi; ?>">
   <th colspan="1"><input type="checkbox" class="silinecekilavegider form-control"></th>
   <th colspan="2">
    <select onchange="karorandegistir(this)" class="form-control">
        <option value="0">Seçiniz</option>
        <?php if(!empty($_Nesnekar)){ foreach($_Nesnekar as $kar){ ?>
            <option value="<?php echo $kar['ID']; ?>" <?php if($kar['ID']==$ikar){ echo 'selected'; } ?> ><?php echo (!empty($kar['metin1'])?$kar['metin1']:0); ?></option>
        <?php } } ?>
    </select>
   </th>
   <td>
    <input type="text" class="karoranlari form-control" onkeyup="karorandegistirdegisim()" name="<?php echo $tbl; ?>[karoranlari][<?php echo $ikar; ?>]" value="<?php echo $karoranlari; ?>">
    <a href="#karoransil" class="karoransil" onclick="karoransilme(this)">Sil</a>
   </td>
</tr>
<?php } } else { ?>
<tr class="boyamaliyetkarlarimiz boyamaliyetkarlari1">
<th colspan="1"><input type="checkbox" class="silinecekilavegider form-control"></th>
<th colspan="2">
    <select onchange="karorandegistir(this)" class="form-control">
        <option value="0">Seçiniz</option>
        <?php if(!empty($_Nesnekar)){ foreach($_Nesnekar as $kar){ ?>
            <option value="<?php echo $kar['ID']; ?>"><?php echo (!empty($kar['metin1'])?$kar['metin1']:0); ?></option>
        <?php } } ?>
    </select>
</th>
<td>
    <input type="text" class="karoranlari form-control" onkeyup="karorandegistirdegisim()" name="<?php echo $tbl; ?>[karoranlari][0]">
    <a href="#karoransil" class="karoransil" onclick="karoransilme(this)">Sil</a>
</td>
</tr>
<?php } ?>
<?php } ?>
</tbody>
</table>
</div>
<br>

<div class="yetkikontrol tablekar2">
    <table cellpadding="0" cellspacing="0" class="tablekar table table-hover">
        <tbody class="boyamaliyetfiyati">
            <tr class="tlboyamaliyetimiz">
                <th colspan="2" style="width:50%;">TL</th>
                <td class="karinputlari"></td>
            </tr>
            <tr class="usdboyamaliyetimiz">
                <th colspan="2" style="width:50%;">USD</th>
                <td class="karinputlari"></td>
            </tr>
            <tr class="eurboyamaliyetimiz">
                <th colspan="2" style="width:50%;">EUR</th>
                <td class="karinputlari"></td>
            </tr>
        </tbody>
    </table>
</div>

<?php
$idcek=z(8,'id');
$srg="WHERE arsiv='0' AND modul='".$tbl."' AND modul_ID='".$idcek."' ORDER BY ID DESC";
$rapor=z(1,$srg,'','rapor');
$sayirapor=0;
if(!empty($rapor)){
    $sayirapor=count($rapor);
}
?>
</div>
<br>
<div class="">
<table cellpadding="0" cellspacing="0" class="table table-hover tablokayit">
<tbody>
<tr><th>Kayit Tarihi</th><td>
   <div class="input-group col-lg-12">
        <span class="input-group-prepend">
            <span class="input-group-text"><i class="icon-calendar22"></i></span>
        </span>
        <input class="yenitarih form-control" type="text" placeholder="Tarihi seç.." name="<?php echo $tbl?>[tarihKayit]" value="<?php echo (!empty($_X['tarihKayit'])?z('date',$_X['tarihKayit']):z('datetime')); ?>" style="width: auto !important;">
    </div>
    </td></tr>
<tr style="text-align: right;"><th colspan="2">
<?php if(z(8,"a")=="duzenle"){ echo ' <a href="./?s='.$tbl.'&a=ekle&farkli='.z(8,'id').'" class="btn btn-info" style="padding-top: 0px; margin-top: 4px;" target="_blank">BU VERİYİ FARKLI DÜZENLE VE KAYDET</a> '; } ?>&nbsp; 
        <?php if(z(8,"a")=="duzenle"){ ?>
            <?php if($sayirapor=='1'||$sayirapor>1){ ?>
                <a href="?s=<?php echo z(8,'s'); ?>&a=rapor&id=<?php echo $rapor[0]['ID']; ?>" class="btn btn-danger" style="padding-top: 0px;margin-top: 4px;">Raporu Düzenle</a>
            <?php } else { ?>
                <a href="?s=<?php echo z(8,'s'); ?>&a=rapor&id=<?php echo z(8,'id'); ?>&ekle=1" class="btn btn-primary" style="padding-top: 0px;margin-top: 4px;">Rapor Oluştur</a>
            <?php } ?>
        <?php } ?>
<a href="#" class="yenikaydet btn btn-success" onClick='submitDetailsForm()'>Kaydet</a>
</th></tr>
<?php $idmiz=z(8,'id'); ?>

<script language="javascript" type="text/javascript">
    function submitDetailsForm() {

        var kumasismi=$(".1kumasismi").val();
        var kumaskodu=$(".1kumaskodu").val();
        var idmiz=<?php echo (!empty($idmiz)?$idmiz:'-1'); ?>;
        //alert(kumaskodu+"kumaskodu"+idmiz+"idmiz");

        

        
    
        var degeroran=0;

        $('.iplikoran').each(function(ip, objoran){
            var iplikoran=$(objoran).find("input").val();
            var iplikoran = sy(iplikoran);
            degeroran=parseFloat(degeroran+iplikoran);
        }); 
        if(degeroran!=0){
            if(degeroran>100){
                alert("Toplam iplik oranı değeri 100'den fazla olamaz");
            }
            else if(degeroran<100){
                alert("Toplam iplik oranı değeri 100'den az olamaz");
            } else if(kumasismi==''){
                alert("Kumaş ismi boş geçilemez");
            } else if(kumaskodu==''){
                alert("Kumaş kodu boş geçilemez");
            } else {

                $.ajax({
                    type:"POST",
                    url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu5&kumaskodu="+kumaskodu+"&idmiz="+idmiz,
                    success:function(gelensorgu){
                        var kumaskodu=gelensorgu.cevap.kumaskodu;
                        if(kumaskodu==0){
                            $("#formId").submit();
                        } else {
                            alert("Kumaş kodu eşsiz olmalı bu kod daha önce kullanılmış");
                        }
                    }
                });

            }
        } else if(kumasismi==''){
            alert("Kumaş ismi boş geçilemez");
        } else if(kumaskodu==''){
            alert("Kumaş kodu boş geçilemez");
        } else {

            $.ajax({
                type:"POST",
                url:"ajaxayar.php?s=kumaskarti&a=ajaxsorgu5&kumaskodu="+kumaskodu+"&idmiz="+idmiz,
                success:function(gelensorgu){
                    var kumaskodu=gelensorgu.cevap.kumaskodu;
                    if(kumaskodu==0){
                        $("#formId").submit();
                    } else {
                        alert("Kumaş kodu eşsiz olmalı bu kod daha önce kullanılmış");
                    }
                }
            });
            
        }
    }
</script>